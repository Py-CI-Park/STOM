# 조건식(Condition) - 분봉(Minute) 기반 추세 전략

- STOM 주식 자동거래에 사용하기 위한 분봉 조건식 문서
- [[Back_Testing_Guideline_Min]] 을(를) 기반으로 작성
- [[Condition_Document_Template_Guideline]] 을(를) 바탕으로 템플릿 구조를 적용한 문서

## 목차
- [조건식(Condition) - 분봉(Minute) 기반 추세 전략](#조건식condition---분봉minute-기반-추세-전략)
  - [목차](#목차)
  - [개요](#개요)
  - [가이드라인](#가이드라인)
    - [변수·이름 규칙](#변수이름-규칙)
- [Condition - Min 0930\_1000 Trend](#condition---min-0930_1000-trend)
  - [조건식](#조건식)
    - [매수 조건식 - C\_M\_0930\_1000\_T\_B](#매수-조건식---c_m_0930_1000_t_b)
    - [매도 조건식 - C\_M\_0930\_1000\_T\_S](#매도-조건식---c_m_0930_1000_t_s)
  - [최적화 조건식](#최적화-조건식)
    - [매수 최적화 조건식 - C\_M\_0930\_1000\_T\_BO](#매수-최적화-조건식---c_m_0930_1000_t_bo)
    - [매수 최적화 범위 - C\_M\_0930\_1000\_T\_BOR](#매수-최적화-범위---c_m_0930_1000_t_bor)
    - [매도 최적화 조건식 - C\_M\_0930\_1000\_T\_SO](#매도-최적화-조건식---c_m_0930_1000_t_so)
    - [매도 최적화 범위 - C\_M\_0930\_1000\_T\_SOR](#매도-최적화-범위---c_m_0930_1000_t_sor)
    - [매수·매도 통합 최적화 범위 - C\_M\_0930\_1000\_T\_OR](#매수매도-통합-최적화-범위---c_m_0930_1000_t_or)
    - [예상 시간 계산](#예상-시간-계산)
    - [GA 최적화 범위 - C\_M\_0930\_1000\_T\_GAR](#ga-최적화-범위---c_m_0930_1000_t_gar)
  - [조건식 개선 방향 연구](#조건식-개선-방향-연구)
  - [태그](#태그)

## 개요

본 문서는 STOM 주식 자동거래 시스템에서 **09:30:00 ~ 10:00:00 (1분봉 데이터, 30분 구간)** 에 사용하는 **이동평균 + RSI/MACD + 거래대금 추세 전략** 조건식을 정의합니다.

- **대상 구간**: 09:30:00 ~ 10:00:00 (장초 안정화 이후 30분)
- **사용 봉**: 1분봉 (Minute)
- **대상 종목**: 시가총액 1,000억 ~ 1조 원, 분당거래대금 상위 종목
- **전략 타입**: 이동평균선 정배열 + RSI/MACD 복합 지표 + 분당거래대금 추세 추종
- **핵심 변수**: 이동평균(20/60), RSI, MACD, 분당거래대금, 분봉고가/저가, 체결강도

**전략의 핵심 아이디어**:
1. **이동평균선 정배열**: 단기(20분봉) > 중기(60분봉) → 상승 추세 확인
2. **RSI 필터**: 30 < RSI < 70 → 과매수/과매도 구간 제외
3. **MACD 골든크로스**: MACD > MACDS 전환 확인 → 모멘텀 전환 신호
4. **분당거래대금 가속**: 분당거래대금 > 평균 × 1.5 → 거래 증가 확인
5. **볼린저밴드 위치**: BBL < 현재가 < BBU → 적정 변동성 범위 내 진입
6. **분봉 위치 확인**: 현재가 > 분봉시가, 분봉고가 갱신 → 상승 분봉 확인

**기존 Tick 전략 대비 차별점**:
- **Tick 전략**: 초단위 변화, 빠른 진입/청산 (보유시간 1~3분)
- **본 Min 전략**: 분봉 기반 안정적 추세 추종 (보유시간 10~30분)
- TA-Lib 보조지표 풍부하게 활용 (RSI, MACD, BBand, Stochastic 등)
- 노이즈 필터링 효과로 승률 향상 기대

## 가이드라인

- 모든 조건식은 Python으로 작성되어 있으며, 분봉(1분봉) 데이터를 기반으로 합니다.
- 각 조건식은 특정 조건을 만족할 때 매수 또는 매도를 실행합니다.
- 최적화 조건식은 변수의 범위를 설정하여 최적의 매수/매도 시점을 찾습니다.
- 최적화 범위는 `self.vars[정수] = [[시작값, 종료값, 간격], 최적값]` 형식으로 설정합니다.
- `self.vars[0]`은 고정값으로 설정되며, 조건식 변수는 `self.vars[1]`부터 공백 없이 사용됩니다.

### 변수·이름 규칙

1. **기본 규칙**:
   - `C`: Condition을 의미
   - `M`: Minute (분봉)을 의미
   - `0930_1000`: 09:30:00 ~ 10:00:00 시간대
   - `T`: Trend (추세 전략)
   - `B`: 매수 조건식
   - `S`: 매도 조건식
   - `BO`: 매수 최적화 조건식
   - `SO`: 매도 최적화 조건식
   - `BOR`: 매수 최적화 범위
   - `SOR`: 매도 최적화 범위
   - `OR`: 매수·매도 통합 최적화 범위
   - `GAR`: GA 최적화 범위

2. **예시**:
   - `C_M_0930_1000_T_B`: 0930_1000 분봉 추세 전략 매수 조건식
   - `C_M_0930_1000_T_S`: 0930_1000 분봉 추세 전략 매도 조건식
   - `C_M_0930_1000_T_BO`: 0930_1000 분봉 추세 전략 매수 최적화 조건식
   - `C_M_0930_1000_T_SO`: 0930_1000 분봉 추세 전략 매도 최적화 조건식

---

# Condition - Min 0930_1000 Trend

## 조건식

### 매수 조건식 - C_M_0930_1000_T_B

```python
# ================================
#  공통 계산 지표
# ================================
전일종가              = 현재가 / (1 + (등락율 / 100))                      # 단위: 원
시가등락율            = ((시가 - 전일종가) / 전일종가) * 100                # 단위: 퍼센트
분봉등락율            = ((현재가 - 분봉시가) / 분봉시가) * 100 if 분봉시가 > 0 else 0  # 분봉 등락율
분당순매수금액        = (분당매수수량 - 분당매도수량) * 현재가 / 1_000_000   # 단위: 백만원
분당거래대금비율      = 분당거래대금 / 분당거래대금평균(20) if 분당거래대금평균(20) > 0 else 0  # 거래대금 가속 비율


# ================================
#  매수 조건
# ================================
매수 = True

# 1. 공통 필터
if not (관심종목 == 1):
    매수 = False
elif not (93000 <= 시분초 < 100000):                # 09:30:00 ~ 10:00:00
    매수 = False
elif not (1000 <= 현재가 <= 50000):
    매수 = False
elif not (현재가 < VI아래5호가):
    매수 = False
elif 라운드피겨위5호가이내:
    매수 = False


# 2. 시가총액 필터
elif not (1000 <= 시가총액 <= 10000):               # 1,000억 ~ 1조 (10,000억)
    매수 = False


# 3. 이동평균선 정배열 확인
elif not (이동평균(20) > 이동평균(60)):              # 20분봉 > 60분봉
    매수 = False
elif not (현재가 > 이동평균(20)):                    # 현재가 > 20분봉 이평
    매수 = False
elif not (이동평균(20) > 이동평균(20, 1)):           # 20분봉 이평 상승 중
    매수 = False


# 4. RSI 필터
elif not (30 < RSI < 70):                            # 과매수/과매도 구간 제외
    매수 = False
elif not (RSI > RSI_N(1)):                           # RSI 상승 중
    매수 = False


# 5. MACD 골든크로스 확인
elif not (MACD > MACDS):                             # MACD > Signal
    매수 = False
elif not (MACD_N(1) <= MACDS_N(1)):                  # 이전 봉에서 MACD <= Signal (크로스 확인)
    매수 = False
elif not (MACD > 0):                                 # MACD 양수 (상승 추세)
    매수 = False


# 6. 볼린저밴드 위치 확인
elif not (BBL < 현재가 < BBU):                       # 볼린저밴드 범위 내
    매수 = False
elif not (현재가 > BBM):                             # 중심선 상향
    매수 = False


# 7. 분봉 위치 및 형태 확인
elif not (현재가 > 분봉시가):                        # 양봉
    매수 = False
elif not (분봉고가 >= 최고분봉고가(10, 1)):          # 10분봉 중 고가 갱신
    매수 = False
elif not (분봉등락율 >= 0.5):                        # 최소 분봉 등락율 0.5%
    매수 = False


# 8. 등락율 및 가격 위치 확인
elif not (1.0 <= 등락율 <= 10.0):                   # 일봉 등락율 1~10%
    매수 = False
elif not (시가등락율 >= 0):                          # 시가 이상 등락
    매수 = False
elif not (현재가 > 고가 - (고가 - 저가) * 0.30):    # 고가 대비 70% 이상
    매수 = False


# 9. 거래대금 및 유동성 확인
elif not (당일거래대금 > 50 * 100):                  # 50억 이상
    매수 = False
elif not (분당거래대금 > 50_000_000):                # 분당 최소 5천만원
    매수 = False
elif not (분당거래대금비율 > 1.5):                   # 평균 대비 1.5배 이상
    매수 = False
elif not (전일비 > 80):
    매수 = False
elif not (회전율 > 1.0):
    매수 = False


# 10. 체결강도 확인
elif not (80 <= 체결강도 <= 250):
    매수 = False
elif not (체결강도 > 체결강도평균(10)):              # 10분봉 평균 대비 높음
    매수 = False


# 11. 분당 매수/매도 밸런스 확인
elif not (분당매수수량 > 분당매도수량 * 1.2):       # 매수 > 매도 × 1.2
    매수 = False
elif not (10 < 분당순매수금액 < 500):                # 10백만원 ~ 500백만원
    매수 = False


# 12. 호가잔량 밸런스 분석
elif not (매도총잔량 * 현재가 / 100_000_000 > 1):   # 최소 매도잔량 1억원
    매수 = False
elif not (매도총잔량 * 현재가 / 100_000_000 < 20):  # 최대 매도잔량 20억원
    매수 = False
elif not (매수총잔량 > 매도총잔량 * 0.5):
    매수 = False
elif not (매수총잔량 < 매도총잔량 * 3.0):
    매수 = False


# 13. Stochastic 확인 (추가 모멘텀 필터)
elif not (STOCHSK > 20):                             # %K > 20 (과매도 아님)
    매수 = False
elif not (STOCHSK > STOCHSD):                        # %K > %D (상승 모멘텀)
    매수 = False
```

### 매도 조건식 - C_M_0930_1000_T_S

```python
# ================================
#  공통 계산 지표
# ================================
# (매도에서 필요한 계산 지표 없음)

# ================================
#  매도 조건
# ================================
매도 = False

# 1. 상한가 직전 익절
if 등락율 > 29.5:
    매도 = True

# 2. 손절 조건
elif 수익률 <= -3.0:                                 # -3% 손절
    매도 = True

# 3. 익절 조건
elif 수익률 >= 5.0:                                  # +5% 익절
    매도 = True

# 4. 시간 기반 청산 (보유시간 30분 초과)
elif 보유시간 > 30:                                  # 30분봉 초과
    매도 = True

# 5. 고수익률 달성 후 하락 (Trailing Stop)
elif 최고수익률 > 6.0 and 수익률 < 최고수익률 * 0.60:  # 고점 대비 40% 하락
    매도 = True

# 6. 이동평균선 이탈 (추세 훼손)
elif 현재가 < 이동평균(20) and 현재가N(1) >= 이동평균(20, 1):
    매도 = True

# 7. RSI 과매수 구간
elif RSI > 75:
    매도 = True

# 8. MACD 데드크로스
elif MACD < MACDS and MACD_N(1) >= MACDS_N(1):      # MACD < Signal 전환
    매도 = True

# 9. 볼린저밴드 상단 돌파 후 하락
elif 현재가 > BBU_N(1) and 현재가 < BBU:            # 상단 돌파 후 재진입
    매도 = True

# 10. Stochastic 과매수 구간
elif STOCHSK > 85 and STOCHSK < STOCHSD:            # %K > 85이고 %K < %D (하락 전환)
    매도 = True

# 11. 전략 종료 시점 강제 청산
elif 시분초 >= 100000:                               # 10:00:00 이후
    매도 = True
```

---

## 최적화 조건식

### 매수 최적화 조건식 - C_M_0930_1000_T_BO

```python
# ================================
#  공통 계산 지표
# ================================
전일종가              = 현재가 / (1 + (등락율 / 100))
시가등락율            = ((시가 - 전일종가) / 전일종가) * 100
분봉등락율            = ((현재가 - 분봉시가) / 분봉시가) * 100 if 분봉시가 > 0 else 0
분당순매수금액        = (분당매수수량 - 분당매도수량) * 현재가 / 1_000_000
분당거래대금비율      = 분당거래대금 / 분당거래대금평균(20) if 분당거래대금평균(20) > 0 else 0

매수 = True

if not (관심종목 == 1):
    매수 = False
elif not (93000 <= 시분초 < 100000):
    매수 = False
elif not (1000 <= 현재가 <= 50000):
    매수 = False
elif not (현재가 < VI아래5호가):
    매수 = False
elif 라운드피겨위5호가이내:
    매수 = False
elif not (1000 <= 시가총액 <= 10000):
    매수 = False

# 최적화 변수 적용
elif not (이동평균(20) > 이동평균(60)):
    매수 = False
elif not (현재가 > 이동평균(20)):
    매수 = False
elif not (self.vars[1][1] < RSI < self.vars[2][1]):
    매수 = False
elif not (RSI > RSI_N(1)):
    매수 = False
elif not (MACD > MACDS):
    매수 = False
elif not (MACD_N(1) <= MACDS_N(1)):
    매수 = False
elif not (MACD > self.vars[3][1]):
    매수 = False
elif not (BBL < 현재가 < BBU):
    매수 = False
elif not (현재가 > BBM):
    매수 = False
elif not (현재가 > 분봉시가):
    매수 = False
elif not (분봉고가 >= 최고분봉고가(10, 1)):
    매수 = False
elif not (분봉등락율 >= self.vars[4][1]):
    매수 = False
elif not (self.vars[5][1] <= 등락율 <= self.vars[6][1]):
    매수 = False
elif not (현재가 > 고가 - (고가 - 저가) * self.vars[7][1]):
    매수 = False
elif not (당일거래대금 > self.vars[8][1] * 100):
    매수 = False
elif not (분당거래대금 > self.vars[9][1] * 1_000_000):
    매수 = False
elif not (분당거래대금비율 > self.vars[10][1]):
    매수 = False
elif not (전일비 > self.vars[11][1]):
    매수 = False
elif not (회전율 > self.vars[12][1]):
    매수 = False
elif not (self.vars[13][1] <= 체결강도 <= 250):
    매수 = False
elif not (체결강도 > 체결강도평균(10)):
    매수 = False
elif not (분당매수수량 > 분당매도수량 * self.vars[14][1]):
    매수 = False
elif not (self.vars[15][1] < 분당순매수금액 < 500):
    매수 = False
elif not (STOCHSK > self.vars[16][1]):
    매수 = False
elif not (STOCHSK > STOCHSD):
    매수 = False
```

### 매수 최적화 범위 - C_M_0930_1000_T_BOR

```python
# 평균 분봉수 고정값
self.vars[0] = [[20], 20]  # 평균 분봉수 고정값: 20, 범위 갯수: 1

# 매수 최적화 범위
self.vars[1] = [[25, 35, 5], 30]                   # RSI 하한: 25~35, 5 간격, 범위 갯수: 3
self.vars[2] = [[65, 75, 5], 70]                   # RSI 상한: 65~75, 5 간격, 범위 갯수: 3
self.vars[3] = [[-5, 5, 5], 0]                     # MACD 하한: -5~5, 5 간격, 범위 갯수: 3
self.vars[4] = [[0.3, 0.7, 0.2], 0.5]              # 분봉등락율 하한: 0.3%~0.7%, 0.2% 간격, 범위 갯수: 3
self.vars[5] = [[0.5, 1.5, 0.5], 1.0]              # 등락율 하한: 0.5%~1.5%, 0.5% 간격, 범위 갯수: 3
self.vars[6] = [[9.0, 11.0, 1.0], 10.0]            # 등락율 상한: 9.0%~11.0%, 1.0% 간격, 범위 갯수: 3
self.vars[7] = [[0.25, 0.35, 0.05], 0.30]          # 고가 대비 비율: 0.25~0.35, 0.05 간격, 범위 갯수: 3
self.vars[8] = [[40, 60, 10], 50]                  # 당일거래대금 하한: 40억~60억, 10억 간격, 범위 갯수: 3
self.vars[9] = [[40, 60, 10], 50]                  # 분당거래대금 하한: 4천만~6천만원, 1천만원 간격, 범위 갯수: 3
self.vars[10] = [[1.3, 1.7, 0.2], 1.5]             # 분당거래대금비율 하한: 1.3~1.7, 0.2 간격, 범위 갯수: 3
self.vars[11] = [[70, 90, 10], 80]                 # 전일비 하한: 70%~90%, 10% 간격, 범위 갯수: 3
self.vars[12] = [[0.8, 1.2, 0.2], 1.0]             # 회전율 하한: 0.8~1.2배, 0.2배 간격, 범위 갯수: 3
self.vars[13] = [[70, 90, 10], 80]                 # 체결강도 하한: 70~90, 10 간격, 범위 갯수: 3
self.vars[14] = [[1.1, 1.3, 0.1], 1.2]             # 분당매수수량 비율: 1.1~1.3, 0.1 간격, 범위 갯수: 3
self.vars[15] = [[8, 12, 2], 10]                   # 분당순매수금액 하한: 8백만~12백만원, 2백만원 간격, 범위 갯수: 3
self.vars[16] = [[15, 25, 5], 20]                  # Stochastic %K 하한: 15~25, 5 간격, 범위 갯수: 3

# 매수 총 경우의 수: 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 = 43,046,721 (약 4천3백만)
# → GA 최적화 권장
```

### 매도 최적화 조건식 - C_M_0930_1000_T_SO

```python
매도 = False

if 등락율 > self.vars[17][1]:
    매도 = True
elif 수익률 <= self.vars[18][1]:
    매도 = True
elif 수익률 >= self.vars[19][1]:
    매도 = True
elif 보유시간 > self.vars[20][1]:
    매도 = True
elif 최고수익률 > self.vars[21][1] and 수익률 < 최고수익률 * self.vars[22][1]:
    매도 = True
elif 현재가 < 이동평균(20) and 현재가N(1) >= 이동평균(20, 1):
    매도 = True
elif RSI > self.vars[23][1]:
    매도 = True
elif MACD < MACDS and MACD_N(1) >= MACDS_N(1):
    매도 = True
elif 시분초 >= 100000:
    매도 = True
```

### 매도 최적화 범위 - C_M_0930_1000_T_SOR

```python
# 매도 최적화 범위 (매수 변수 16 다음부터 17번부터 시작)
self.vars[17] = [[28.5, 30.0, 0.5], 29.5]          # 등락율 상한가: 28.5%~30.0%, 0.5% 간격, 범위 갯수: 4
self.vars[18] = [[-4.0, -2.0, 0.5], -3.0]          # 손실 수익률: -4.0%~-2.0%, 0.5% 간격, 범위 갯수: 5
self.vars[19] = [[4.0, 6.0, 0.5], 5.0]             # 익절 수익률: 4.0%~6.0%, 0.5% 간격, 범위 갯수: 5
self.vars[20] = [[25, 35, 5], 30]                  # 최대 보유시간: 25~35분, 5분 간격, 범위 갯수: 3
self.vars[21] = [[5.0, 7.0, 1.0], 6.0]             # Trailing Stop 발동 수익률: 5.0%~7.0%, 1.0% 간격, 범위 갯수: 3
self.vars[22] = [[0.55, 0.65, 0.05], 0.60]         # Trailing Stop 비율: 55%~65%, 5% 간격, 범위 갯수: 3
self.vars[23] = [[72, 78, 3], 75]                  # RSI 과매수 기준: 72~78, 3 간격, 범위 갯수: 3

# 매도 총 경우의 수: 4 × 5 × 5 × 3 × 3 × 3 × 3 = 16,200
```

### 매수·매도 통합 최적화 범위 - C_M_0930_1000_T_OR

핵심 변수만 묶어 탐색 효율 향상:

```python
OR_INDEX = [1, 2, 5, 8, 10, 13, 17, 18, 19, 20, 21]  # 핵심 11개 변수만 선택
# 경우의 수: 3 × 3 × 3 × 3 × 3 × 3 × 4 × 5 × 5 × 3 × 3 = 6,561,000 (약 656만)
# → 여전히 많지만 전체 대비 크게 축소됨
# → GA 최적화 또는 2단계 최적화 권장
```

### 예상 시간 계산

```python
# 매수 경우의 수: 43,046,721 (약 4천3백만)
# 매도 경우의 수: 16,200
# 총 경우의 수: 43,046,721 × 16,200 = 약 697,356,880,200 (약 6,974억)

# 1경우당 1분 소요 가정:
# 예상 시간 = 6,974억 분 ≈ 11.6억 시간 ≈ 132만 년

# → 현실적으로 전체 Grid Search 불가능
# → 권장 방법:
#    1. OR_INDEX 사용 (656만 경우의 수, 약 12년)
#    2. GA 최적화 사용 (아래 GAR 섹션 참고)
#    3. 2단계 최적화: 1차(넓은 범위) → 2차(좁은 범위)
```

### GA 최적화 범위 - C_M_0930_1000_T_GAR

일반 범위를 GA 리스트 형태로 변환:

```python
# GA 최적화 범위 - 매수 핵심 변수
self.vars[1] = [[25, 30, 35], 30]                  # RSI 하한, 범위 갯수: 3
self.vars[2] = [[65, 70, 75], 70]                  # RSI 상한, 범위 갯수: 3
self.vars[5] = [[0.5, 1.0, 1.5], 1.0]              # 등락율 하한, 범위 갯수: 3
self.vars[8] = [[40, 50, 60], 50]                  # 당일거래대금 하한, 범위 갯수: 3
self.vars[10] = [[1.3, 1.5, 1.7], 1.5]             # 분당거래대금비율 하한, 범위 갯수: 3
self.vars[13] = [[70, 80, 90], 80]                 # 체결강도 하한, 범위 갯수: 3

# GA 최적화 범위 - 매도 핵심 변수
self.vars[17] = [[28.5, 29.0, 29.5, 30.0], 29.5]  # 등락율 상한가, 범위 갯수: 4
self.vars[18] = [[-4.0, -3.5, -3.0, -2.5, -2.0], -3.0]  # 손실 수익률, 범위 갯수: 5
self.vars[19] = [[4.0, 4.5, 5.0, 5.5, 6.0], 5.0]  # 익절 수익률, 범위 갯수: 5
self.vars[20] = [[25, 30, 35], 30]                 # 최대 보유시간, 범위 갯수: 3
self.vars[21] = [[5.0, 6.0, 7.0], 6.0]             # Trailing Stop 발동 수익률, 범위 갯수: 3
```

---

## 조건식 개선 방향 연구

### 1. 추가 지표 활용 연구

#### 1.1 ATR (Average True Range) 활용
- **정의**: 변동성 측정 지표
- **활용 방안**: `ATR > 이전 10분봉 평균 ATR` → 변동성 증가 확인
- **적용 예시**: 높은 변동성 구간에서 손절 범위 확대
- **최적화 범위**: ATR 배수 `[[1.2, 2.0, 0.2], 1.5]`

#### 1.2 OBV (On Balance Volume)
- **활용 방안**: `OBV > OBV_N(1)` → 거래량 증가 확인
- **매수 조건 추가**: OBV 상승 추세 확인

### 2. TA-Lib 보조지표 활용 연구

#### 2.1 MFI (Money Flow Index)
- **매수 조건 추가**: `30 < MFI < 70` (RSI와 유사하지만 거래량 반영)
- **최적화 범위**: MFI 하한 `[[25, 35, 5], 30]`, 상한 `[[65, 75, 5], 70]`

#### 2.2 CCI (Commodity Channel Index)
- **매수 조건 추가**: `-100 < CCI < 100` → 정상 범위
- **과매수/과매도 감지**

### 3. 구간 연산 변수 활용 연구

#### 3.1 이동평균 교차 전략
- **골든크로스**: `이동평균(20) > 이동평균(60) and 이동평균(20, 1) <= 이동평균(60, 1)`
- **활용 방안**: 교차 시점 포착으로 진입 타이밍 최적화

#### 3.2 분봉 고가/저가 돌파
- **매수 조건 추가**: `분봉고가 > 최고분봉고가(20, 1)` → 20분봉 중 신고가
- **최적화 범위**: 구간 분봉수 `[[10, 30, 10], 20]`

### 4. 매도 조건 고도화 연구

#### 4.1 보유시간별 차등 익절
- 10분 이하: 익절 +3%
- 10~20분: 익절 +4%
- 20분 이상: 익절 +5%

#### 4.2 볼린저밴드 기반 매도
- 상단 초과 후 재진입: `현재가 > BBU_N(1) and 현재가 < BBU`
- 하단 이탈: `현재가 < BBL`

### 5. 복합 지표 조합 연구

#### 5.1 추세 강도 지수
```python
추세강도 = (
    (이동평균(20) / 이동평균(60) - 1) * 100 * 0.3 +
    (RSI - 50) * 0.3 +
    MACD * 0.2 +
    (체결강도 / 100 - 1) * 100 * 0.2
)
```
- **활용 방안**: `추세강도 > 5` → 강한 추세
- **최적화 범위**: `[[3, 7, 1], 5]`

### 6. 시간대별 전략 세분화 연구

#### 6.1 09:30~09:45 vs 09:45~10:00 차등
- 전반부: 공격적 진입 (RSI 하한 25)
- 후반부: 보수적 진입 (RSI 하한 35)

### 7. 최적화 전략 개선 연구

#### 7.1 Random Forest 기반 변수 중요도 분석
- Scikit-learn 활용하여 변수 중요도 측정
- 상위 10개 변수만 최적화

#### 7.2 Bayesian Optimization
- GA보다 효율적인 탐색
- Optuna 라이브러리 활용

### 8. 리스크 관리 강화 연구

#### 8.1 최대 손실 한도 설정
- 일일 최대 손실 -10% 도달 시 전략 중지

#### 8.2 연속 손실 제한
- 연속 3회 손실 시 진입 조건 강화

### 9. 백테스팅 개선 방향

#### 9.1 분봉 타임스탬프 정확성 검증
- 09:30:00 정확히 포함되는지 확인
- 데이터 누락 방지

#### 9.2 슬리피지 반영
- 매수: 분봉고가 기준
- 매도: 분봉저가 기준

### 10. 구현 우선순위

**High Priority (즉시 적용)**:
1. MFI 지표 추가
2. 추세 강도 지수
3. 2단계 최적화 전략

**Medium Priority (1개월 내)**:
4. ATR 활용
5. 보유시간별 차등 익절
6. Random Forest 변수 중요도 분석

**Low Priority (장기 연구)**:
7. Bayesian Optimization
8. 시간대별 전략 세분화
9. 최대 손실 한도 설정

---

## 태그

#조건식 #분봉 #Minute #추세전략 #이동평균 #RSI #MACD #볼린저밴드 #Stochastic #0930_1000 #최적화 #GA #백테스팅

---

**Last Update: 2025-01-17**
