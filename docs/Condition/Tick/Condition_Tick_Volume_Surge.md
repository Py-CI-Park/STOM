# 조건식 (Condition)

- STOM 주식 자동거래에 사용하기 위한 조건식 문서
- [[Back_Testing_Guideline_Tick]] 을(를) 기반으로 작성한 Tick 조건식
- [[Condition_Document_Template_Guideline]] 을(를) 바탕으로 템플릿 구조를 적용한 문서

## 목차
- [조건식 (Condition)](#조건식-condition)
  - [목차](#목차)
  - [소개](#소개)
  - [가이드라인](#가이드라인)
    - [저장 이름 규칙](#저장-이름-규칙)
- [Condition - Tick Volume Surge (거래량 급증 패턴)](#condition---tick-volume-surge-거래량-급증-패턴)
  - [전략 개요](#전략-개요)
  - [조건식](#조건식)
    - [매수 조건식 - C\_T\_VS\_B](#매수-조건식---c_t_vs_b)
    - [매도 조건식 - C\_T\_VS\_S](#매도-조건식---c_t_vs_s)
  - [최적화 조건식](#최적화-조건식)
    - [매수 최적화 조건식 - C\_T\_VS\_BO](#매수-최적화-조건식---c_t_vs_bo)
    - [매수 최적화 범위 - C\_T\_VS\_BOR](#매수-최적화-범위---c_t_vs_bor)
    - [매도 최적화 조건식 - C\_T\_VS\_SO](#매도-최적화-조건식---c_t_vs_so)
    - [매도 최적화 범위 - C\_T\_VS\_SOR](#매도-최적화-범위---c_t_vs_sor)
    - [매수 매도 최적화 범위 - C\_T\_VS\_OR](#매수-매도-최적화-범위---c_t_vs_or)
    - [예상 시간 계산](#예상-시간-계산)
    - [GA 최적화 범위 - C\_T\_VS\_GAR](#ga-최적화-범위---c_t_vs_gar)
  - [태그](#태그)

## 개요

본 문서는 STOM 주식 자동거래 시스템에서 **거래량 급증 패턴 전략**을 정의한다.

- **대상 시간 구간**: 장중 전체 (시간대 제한 없음)
- **대상 종목**: 시가총액 및 가격대 필터링 적용
- **전략 타입**: 거래량 급증 및 매수세 급등 포착 (Volume Surge)
- **핵심 변수**: 초당거래대금, 체결강도, 누적초당매수수량, 당일거래대금각도, 등락율각도
- **업데이트 이력**:
  - 초기 문서 작성

## 소개

이 문서는 STOM 주식 자동거래 시스템에서 사용되는 **거래량 급증 패턴** 조건식을 설명합니다.

**전략의 핵심 개념**:
- **패턴**: 거래량이 급격히 증가하면서 가격이 상승하는 패턴 포착
- **원리**: 대량 매수세 유입 시 단기 급등 가능성이 높음
- **특징**:
  - 초당거래대금이 평균 대비 3배 이상 급증
  - 체결강도가 120 이상으로 매수 우위
  - 누적초당매수수량이 매도수량 대비 1.5배 이상
  - 당일거래대금각도가 급격히 상승 (15도 이상)
  - 등락율 상승 추세 확인

## 가이드라인

- 모든 조건식은 Python으로 작성되어 있으며, 주식 거래의 자동화를 목표로 합니다.
- 각 조건식은 특정 조건을 만족할 때 매수 또는 매도를 실행합니다.
- 최적화 조건식은 변수의 범위를 설정하여 최적의 매수/매도 시점을 찾습니다.
- 최적화 범위는 `self.vars[정수] = [[시작값, 종료값, 간격], 최적값]` 형식으로 설정합니다.
- `self.vars[0]`은 고정값으로 설정되며, 조건식 변수는 `self.vars[1]`부터 공백 없이 사용됩니다.
- GA(유전 알고리즘) 최적화 범위 생성 방법:
  - 유전 알고리즘을 사용하여 최적의 매수/매도 시점을 찾기 위해, 각 변수의 범위를 설정합니다.
  - 각 변수는 `self.vars[정수] = [범위리스트, 최적값]` 형식으로 정의됩니다.
  - 범위리스트는 시작값부터 종료값까지 간격에 따라 생성된 값들의 집합입니다.
  - 고정값은 2단계, 3단계에서 이전 탐색에서 검출되지 않아도 돌연변이로 추가됩니다. 이는 사용자가 이미 알고 있는 최적값을 강제로 탐색하기 위함입니다. 4단계부터는 돌연변이로 추가되지 않습니다.
  - 너무 많은 변수를 입력할 경우 시간이 오래 걸리므로, 각각의 변수 범위를 10개 이하로 설정하십시오. 변수 범위의 최대값은 20개입니다.
  - 최적값 중에 최적값을 찾는 방법은 일반 최적화에서 구한 최적값을 GA에 돌연변이값으로 넣고 GA를 돌린 다음, 다시 GA에서 구한 최적값으로 일반 최적화를 돌리면 됩니다.

### 저장 이름 규칙

조건식과 관련된 다양한 테스트 및 최적화 조건을 저장할 때, 일관된 작명 규칙을 사용하여 관리의 용이성을 높일 수 있습니다. 아래는 현재 사용 중인 규칙과 함께, 향후 확장성을 고려한 제안입니다.

1. **기본 규칙**:
   - `C`: Condition을 의미합니다.
   - `T`: Tick을 의미합니다.
   - `VS`: Volume Surge (거래량 급증 패턴)를 의미합니다.
   - `B`: 매수 조건식을 의미합니다.
   - `S`: 매도 조건식을 의미합니다.
   - `BO`: 매수 최적화 조건식을 의미합니다.
   - `SO`: 매도 최적화 조건식을 의미합니다.
   - `BOR`: 매수 최적화 범위를 의미합니다.
   - `SOR`: 매도 최적화 범위를 의미합니다.
   - `OR`: 매수 매도 통합 최적화 범위를 의미합니다.
   - `GAR`: GA 최적화 범위를 의미합니다.

2. **예시**:
   - `C_T_VS_B`: 거래량 급증 패턴의 매수 조건식
   - `C_T_VS_S`: 거래량 급증 패턴의 매도 조건식
   - `C_T_VS_BO`: 거래량 급증 패턴의 매수 최적화 조건식
   - `C_T_VS_SO`: 거래량 급증 패턴의 매도 최적화 조건식

---

# Condition - Tick Volume Surge (거래량 급증 패턴)

## 전략 개요

### 패턴 인식 로직

**거래량 급증 (Volume Surge) 정의**:
- 초당거래대금이 평균 대비 3배 이상 급증
- 체결강도가 120 이상으로 매수세 우위
- 누적초당매수수량이 누적초당매도수량 대비 1.5배 이상
- 당일거래대금각도가 15도 이상으로 급격히 상승

**거래량 급증 확인**:
- 최근 60틱(1분) 평균 대비 현재 거래대금이 3배 이상
- 최고초당매수수량(30틱)이 최고초당매도수량(30틱) 대비 2배 이상
- 등락율각도(30틱)가 양수로 상승 추세
- 현재가가 이동평균(60틱) 이상

**가격 상승 동반 확인**:
- 현재가가 고가 대비 5% 이내
- 등락율이 양수이면서 과열 구간 진입 전 (29% 이하)
- VI 발동 위험 없음 (현재가 < VI아래5호가)
- 라운드피겨 저항 구간 회피

### 시장 상황별 전략

**소형주 (시가총액 < 2000억)**:
- 높은 변동성으로 인해 더 강한 거래량 조건 요구
- 초당순매수금액 최소 50백만원 이상
- 체결강도 최소 140 이상
- 회전율 최소 3% 이상

**중형주 (2000억 <= 시가총액 < 5000억)**:
- 중간 수준의 거래량 조건
- 초당순매수금액 최소 100백만원 이상
- 체결강도 최소 120 이상
- 회전율 최소 2% 이상

**대형주 (시가총액 >= 5000억)**:
- 완화된 거래량 조건
- 초당순매수금액 최소 200백만원 이상
- 체결강도 최소 100 이상
- 회전율 최소 1% 이상

## 조건식

### 매수 조건식 - C_T_VS_B

```python
# ================================
#  공통 계산 지표
# ================================
전일종가          = 현재가 / (1 + (등락율 / 100))                      # 단위: 원
시가등락율        = ((시가 - 전일종가) / 전일종가) * 100                # 단위: 퍼센트
초당순매수금액    = (초당매수수량 - 초당매도수량) * 현재가 / 1_000_000   # 단위: 백만원
거래대금증가배수  = (초당거래대금 / 초당거래대금평균(60)) if 초당거래대금평균(60) != 0 else 0  # 배수
체결강도상승여부  = (체결강도 > 체결강도평균(30) and 체결강도평균(30) > 체결강도평균(30, 30))
가격상승추세      = (등락율각도(30) > 0 and 현재가 > 이동평균(60))



# ================================
#  매수 조건 (거래량 급증)
# ================================
매수 = True


if not (관심종목 == 1):                         # 공통 필터 – 관심종목
    매수 = False


# ---------- 시간대 제한 (09:05:00 ~ 15:00:00) ----------
elif not (90500 <= 시분초 < 150000):
    매수 = False


# ---------- 기본 가격 필터 ----------
elif not (1000 < 현재가 <= 100000):
    매수 = False
elif not (0.5 < 등락율 <= 29.0):
    매수 = False
elif not (현재가 < VI아래5호가):
    매수 = False
elif 라운드피겨위5호가이내:
    매수 = False


# ---------- 거래량 급증 확인 ----------
elif not (거래대금증가배수 >= 3.0):              # 평균 대비 3배 이상
    매수 = False
elif not (초당거래대금 > 초당거래대금N(1) * 1.2):
    매수 = False
elif not (당일거래대금각도(30) > 15):
    매수 = False


# ---------- 매수세 우위 확인 ----------
elif not (체결강도 >= 120):
    매수 = False
elif not 체결강도상승여부:
    매수 = False
elif not (누적초당매수수량(30) > 누적초당매도수량(30) * 1.5):
    매수 = False
elif not (최고초당매수수량(30) > 최고초당매도수량(30) * 2.0):
    매수 = False


# ---------- 가격 상승 확인 ----------
elif not 가격상승추세:
    매수 = False
elif not (현재가 > 고가 * 0.95):                # 고가 대비 5% 이내
    매수 = False


# ---------- 시가총액별 세부 조건 ----------
else:
    if 시가총액 < 2000:                           # 소형주
        if not (-2.0 <= 시가등락율 < 5.0):
            매수 = False
        elif not (50 < 초당순매수금액 < 5000):
            매수 = False
        elif not (전일비 > 50 and 전일동시간비 > 50):
            매수 = False
        elif not (회전율 > 3.0):
            매수 = False
        elif not (당일거래대금 > 500 * 100):
            매수 = False
        elif not (초당매수수량 > 매도총잔량 * 0.60):
            매수 = False
        elif not (체결강도 >= 140 and 체결강도 <= 350):
            매수 = False
        elif not (등락율각도(30) > 5):
            매수 = False

    elif 시가총액 < 5000:                         # 중형주
        if not (-1.0 <= 시가등락율 < 7.0):
            매수 = False
        elif not (100 < 초당순매수금액 < 8000):
            매수 = False
        elif not (전일비 > 30 and 전일동시간비 > 30):
            매수 = False
        elif not (회전율 > 2.0):
            매수 = False
        elif not (당일거래대금 > 1000 * 100):
            매수 = False
        elif not (초당매수수량 > 매도총잔량 * 0.50):
            매수 = False
        elif not (체결강도 >= 120 and 체결강도 <= 350):
            매수 = False
        elif not (등락율각도(30) > 3):
            매수 = False

    else:                                         # 대형주
        if not (0.0 <= 시가등락율 < 10.0):
            매수 = False
        elif not (200 < 초당순매수금액 < 15000):
            매수 = False
        elif not (전일비 > 20 and 전일동시간비 > 20):
            매수 = False
        elif not (회전율 > 1.0):
            매수 = False
        elif not (당일거래대금 > 2000 * 100):
            매수 = False
        elif not (초당매수수량 > 매도총잔량 * 0.40):
            매수 = False
        elif not (체결강도 >= 100 and 체결강도 <= 350):
            매수 = False
        elif not (등락율각도(30) > 2):
            매수 = False


# ================================
#  매수 호출
# ================================
if 매수:
    self.Buy(종목코드, 종목명, 매수수량, 현재가, 매도호가1, 매수호가1, 데이터길이)
```

### 매도 조건식 - C_T_VS_S

```python
# ================================
#  공통 계산 지표
# ================================
거래대금감소여부  = (초당거래대금 < 초당거래대금평균(30) * 0.6)
체결강도약화여부  = (체결강도 < 100 and 체결강도 < 체결강도N(1))
상승동력소진      = (등락율각도(30) < 2 and 등락율각도(60) < 등락율각도(30))



# ================================
#  매도 조건 (거래량 급증)
# ================================
매도 = False


# 등락율 상한가 직전
if 등락율 > 28.0:
    매도 = True

# 목표 수익률 달성
elif 수익률 >= 6.0:
    매도 = True

# 손절
elif 수익률 <= -3.5:
    매도 = True

# 최고수익률 대비 하락
elif 최고수익률 > 8.0 and 최고수익률 * 0.65 >= 수익률:
    매도 = True

# 보유시간 초과
elif 보유시간 > 240:                            # 4분 초과
    매도 = True

# 거래량 감소 및 체결강도 약화
elif 거래대금감소여부 and 체결강도약화여부 and 수익률 > 2.0:
    매도 = True

# 상승 동력 소진
elif 상승동력소진 and 최고수익률 > 4.0:
    매도 = True

# 시가총액별 매도 조건
elif 시가총액 < 10000:
    # 등락율 각도별 매도 압력 확인
    if 등락율각도(30) >= 15 and (초당매도수량 - 초당매수수량) >= 매수총잔량 * 0.4 and (현재가 / 현재가N(1) - 1) * 100 < -0.4:
        매도 = True
    elif 10 <= 등락율각도(30) < 15 and (초당매도수량 - 초당매수수량) >= 매수총잔량 * 0.5 and (현재가 / 현재가N(1) - 1) * 100 < -0.5:
        매도 = True
    elif 5 <= 등락율각도(30) < 10 and (초당매도수량 - 초당매수수량) >= 매수총잔량 * 0.6 and (현재가 / 현재가N(1) - 1) * 100 < -0.4:
        매도 = True
    elif 0 <= 등락율각도(30) < 5 and (초당매도수량 - 초당매수수량) >= 매수총잔량 * 0.7 and (현재가 / 현재가N(1) - 1) * 100 < -0.3:
        매도 = True
    elif 등락율각도(30) < 0 and (초당매도수량 - 초당매수수량) >= 매수총잔량 * 0.8 and (현재가 / 현재가N(1) - 1) * 100 < -0.4:
        매도 = True


# ================================
#  매도 호출
# ================================
if 매도:
    self.Sell(종목코드, 종목명, 매도수량, 현재가, 매도호가1, 매수호가1, 강제청산)
```

## 최적화 조건식

### 매수 최적화 조건식 - C_T_VS_BO

```python
# ================================
#  공통 계산 지표
# ================================
전일종가          = 현재가 / (1 + (등락율 / 100))
시가등락율        = ((시가 - 전일종가) / 전일종가) * 100
초당순매수금액    = (초당매수수량 - 초당매도수량) * 현재가 / 1_000_000
거래대금증가배수  = (초당거래대금 / 초당거래대금평균(60)) if 초당거래대금평균(60) != 0 else 0
체결강도상승여부  = (체결강도 > 체결강도평균(30) and 체결강도평균(30) > 체결강도평균(30, 30))
가격상승추세      = (등락율각도(30) > 0 and 현재가 > 이동평균(60))

매수 = True

if not (관심종목 == 1):
    매수 = False
elif not (90500 <= 시분초 < 150000):
    매수 = False
elif not (1000 < 현재가 <= 100000):
    매수 = False
elif not (0.5 < 등락율 <= self.vars[1]):
    매수 = False
elif not (현재가 < VI아래5호가):
    매수 = False
elif 라운드피겨위5호가이내:
    매수 = False
elif not (거래대금증가배수 >= self.vars[2]):
    매수 = False
elif not (초당거래대금 > 초당거래대금N(1) * self.vars[3]):
    매수 = False
elif not (당일거래대금각도(30) > self.vars[4]):
    매수 = False
elif not (체결강도 >= self.vars[5]):
    매수 = False
elif not 체결강도상승여부:
    매수 = False
elif not (누적초당매수수량(30) > 누적초당매도수량(30) * self.vars[6]):
    매수 = False
elif not (최고초당매수수량(30) > 최고초당매도수량(30) * self.vars[7]):
    매수 = False
elif not 가격상승추세:
    매수 = False
elif not (현재가 > 고가 * self.vars[8]):
    매수 = False
else:
    if 시가총액 < 2000:
        if not (self.vars[9] <= 시가등락율 < self.vars[10]):
            매수 = False
        elif not (self.vars[11] < 초당순매수금액 < 5000):
            매수 = False
        elif not (전일비 > self.vars[12] and 전일동시간비 > self.vars[13]):
            매수 = False
        elif not (회전율 > self.vars[14]):
            매수 = False
        elif not (당일거래대금 > self.vars[15] * 100):
            매수 = False
        elif not (초당매수수량 > 매도총잔량 * self.vars[16]):
            매수 = False
        elif not (체결강도 >= self.vars[17] and 체결강도 <= 350):
            매수 = False
        elif not (등락율각도(30) > self.vars[18]):
            매수 = False
    elif 시가총액 < 5000:
        if not (self.vars[19] <= 시가등락율 < self.vars[20]):
            매수 = False
        elif not (self.vars[21] < 초당순매수금액 < 8000):
            매수 = False
        elif not (전일비 > self.vars[22] and 전일동시간비 > self.vars[23]):
            매수 = False
        elif not (회전율 > self.vars[24]):
            매수 = False
        elif not (당일거래대금 > self.vars[25] * 100):
            매수 = False
        elif not (초당매수수량 > 매도총잔량 * self.vars[26]):
            매수 = False
        elif not (체결강도 >= self.vars[27] and 체결강도 <= 350):
            매수 = False
        elif not (등락율각도(30) > self.vars[28]):
            매수 = False
    else:
        if not (self.vars[29] <= 시가등락율 < self.vars[30]):
            매수 = False
        elif not (self.vars[31] < 초당순매수금액 < 15000):
            매수 = False
        elif not (전일비 > self.vars[32] and 전일동시간비 > self.vars[33]):
            매수 = False
        elif not (회전율 > self.vars[34]):
            매수 = False
        elif not (당일거래대금 > self.vars[35] * 100):
            매수 = False
        elif not (초당매수수량 > 매도총잔량 * self.vars[36]):
            매수 = False
        elif not (체결강도 >= self.vars[37] and 체결강도 <= 350):
            매수 = False
        elif not (등락율각도(30) > self.vars[38]):
            매수 = False

if 매수:
    self.Buy(종목코드, 종목명, 매수수량, 현재가, 매도호가1, 매수호가1, 데이터길이)
```

### 매수 최적화 범위 - C_T_VS_BOR

```python
# 거래량 급증 패턴 최적화 범위
self.vars[1] = [[25.0, 30.0, 2.5], 29.0]         # 등락율 상한: 25.0%에서 30.0%까지 2.5% 간격, 범위 갯수: 3
self.vars[2] = [[2.5, 3.5, 0.5], 3.0]            # 거래대금증가배수: 2.5배에서 3.5배까지 0.5배 간격, 범위 갯수: 3
self.vars[3] = [[1.1, 1.3, 0.1], 1.2]            # 초당거래대금증가율: 1.1배에서 1.3배까지 0.1배 간격, 범위 갯수: 3
self.vars[4] = [[12, 18, 3], 15]                 # 당일거래대금각도: 12에서 18까지 3 간격, 범위 갯수: 3
self.vars[5] = [[110, 130, 10], 120]             # 체결강도 하한: 110에서 130까지 10 간격, 범위 갯수: 3
self.vars[6] = [[1.3, 1.7, 0.2], 1.5]            # 누적매수우세비율: 1.3배에서 1.7배까지 0.2배 간격, 범위 갯수: 3
self.vars[7] = [[1.5, 2.5, 0.5], 2.0]            # 최고매수우세비율: 1.5배에서 2.5배까지 0.5배 간격, 범위 갯수: 3
self.vars[8] = [[0.93, 0.97, 0.02], 0.95]        # 고가대비비율: 0.93배에서 0.97배까지 0.02배 간격, 범위 갯수: 3

# 소형주 (시가총액 < 2000) 최적화 범위
self.vars[9] = [[-3.0, -1.0, 1.0], -2.0]         # 시가등락율 하한: -3.0%에서 -1.0%까지 1.0% 간격, 범위 갯수: 3
self.vars[10] = [[4.0, 6.0, 1.0], 5.0]           # 시가등락율 상한: 4.0%에서 6.0%까지 1.0% 간격, 범위 갯수: 3
self.vars[11] = [[40, 60, 10], 50]               # 초당순매수금액 하한: 40에서 60까지 10 간격, 범위 갯수: 3
self.vars[12] = [[40, 60, 10], 50]               # 전일비: 40에서 60까지 10 간격, 범위 갯수: 3
self.vars[13] = [[40, 60, 10], 50]               # 전일동시간비: 40에서 60까지 10 간격, 범위 갯수: 3
self.vars[14] = [[2.5, 3.5, 0.5], 3.0]           # 회전율: 2.5배에서 3.5배까지 0.5배 간격, 범위 갯수: 3
self.vars[15] = [[400, 600, 100], 500]           # 당일거래대금: 400에서 600까지 100 간격, 범위 갯수: 3
self.vars[16] = [[0.55, 0.65, 0.05], 0.60]       # 초당매수수량비율: 0.55에서 0.65까지 0.05 간격, 범위 갯수: 3
self.vars[17] = [[130, 150, 10], 140]            # 체결강도 하한: 130에서 150까지 10 간격, 범위 갯수: 3
self.vars[18] = [[4, 6, 1], 5]                   # 등락율각도: 4에서 6까지 1 간격, 범위 갯수: 3

# 중형주 (2000 <= 시가총액 < 5000) 최적화 범위
self.vars[19] = [[-2.0, 0.0, 1.0], -1.0]         # 시가등락율 하한: -2.0%에서 0.0%까지 1.0% 간격, 범위 갯수: 3
self.vars[20] = [[6.0, 8.0, 1.0], 7.0]           # 시가등락율 상한: 6.0%에서 8.0%까지 1.0% 간격, 범위 갯수: 3
self.vars[21] = [[80, 120, 20], 100]             # 초당순매수금액 하한: 80에서 120까지 20 간격, 범위 갯수: 3
self.vars[22] = [[25, 35, 5], 30]                # 전일비: 25에서 35까지 5 간격, 범위 갯수: 3
self.vars[23] = [[25, 35, 5], 30]                # 전일동시간비: 25에서 35까지 5 간격, 범위 갯수: 3
self.vars[24] = [[1.5, 2.5, 0.5], 2.0]           # 회전율: 1.5배에서 2.5배까지 0.5배 간격, 범위 갯수: 3
self.vars[25] = [[800, 1200, 200], 1000]         # 당일거래대금: 800에서 1200까지 200 간격, 범위 갯수: 3
self.vars[26] = [[0.45, 0.55, 0.05], 0.50]       # 초당매수수량비율: 0.45에서 0.55까지 0.05 간격, 범위 갯수: 3
self.vars[27] = [[110, 130, 10], 120]            # 체결강도 하한: 110에서 130까지 10 간격, 범위 갯수: 3
self.vars[28] = [[2, 4, 1], 3]                   # 등락율각도: 2에서 4까지 1 간격, 범위 갯수: 3

# 대형주 (시가총액 >= 5000) 최적화 범위
self.vars[29] = [[-0.5, 0.5, 0.5], 0.0]          # 시가등락율 하한: -0.5%에서 0.5%까지 0.5% 간격, 범위 갯수: 3
self.vars[30] = [[9.0, 11.0, 1.0], 10.0]         # 시가등락율 상한: 9.0%에서 11.0%까지 1.0% 간격, 범위 갯수: 3
self.vars[31] = [[150, 250, 50], 200]            # 초당순매수금액 하한: 150에서 250까지 50 간격, 범위 갯수: 3
self.vars[32] = [[15, 25, 5], 20]                # 전일비: 15에서 25까지 5 간격, 범위 갯수: 3
self.vars[33] = [[15, 25, 5], 20]                # 전일동시간비: 15에서 25까지 5 간격, 범위 갯수: 3
self.vars[34] = [[0.5, 1.5, 0.5], 1.0]           # 회전율: 0.5배에서 1.5배까지 0.5배 간격, 범위 갯수: 3
self.vars[35] = [[1500, 2500, 500], 2000]        # 당일거래대금: 1500에서 2500까지 500 간격, 범위 갯수: 3
self.vars[36] = [[0.35, 0.45, 0.05], 0.40]       # 초당매수수량비율: 0.35에서 0.45까지 0.05 간격, 범위 갯수: 3
self.vars[37] = [[90, 110, 10], 100]             # 체결강도 하한: 90에서 110까지 10 간격, 범위 갯수: 3
self.vars[38] = [[1, 3, 1], 2]                   # 등락율각도: 1에서 3까지 1 간격, 범위 갯수: 3

# 매수 총 경우의 수: 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 = 205,891,132,094,649
```

### 매도 최적화 조건식 - C_T_VS_SO

```python
# ================================
#  공통 계산 지표
# ================================
거래대금감소여부  = (초당거래대금 < 초당거래대금평균(30) * self.vars[45])
체결강도약화여부  = (체결강도 < self.vars[46] and 체결강도 < 체결강도N(1))
상승동력소진      = (등락율각도(30) < self.vars[47] and 등락율각도(60) < 등락율각도(30))

매도 = False

if 등락율 > self.vars[39]:
    매도 = True
elif 수익률 >= self.vars[40]:
    매도 = True
elif 수익률 <= self.vars[41]:
    매도 = True
elif 최고수익률 > self.vars[42] and 최고수익률 * self.vars[43] >= 수익률:
    매도 = True
elif 보유시간 > self.vars[44]:
    매도 = True
elif 거래대금감소여부 and 체결강도약화여부 and 수익률 > self.vars[48]:
    매도 = True
elif 상승동력소진 and 최고수익률 > self.vars[49]:
    매도 = True
elif 시가총액 < 10000:
    if 등락율각도(30) >= 15 and (초당매도수량 - 초당매수수량) >= 매수총잔량 * self.vars[50] and (현재가 / 현재가N(1) - 1) * 100 < self.vars[51]:
        매도 = True
    elif 10 <= 등락율각도(30) < 15 and (초당매도수량 - 초당매수수량) >= 매수총잔량 * self.vars[52] and (현재가 / 현재가N(1) - 1) * 100 < self.vars[53]:
        매도 = True
    elif 5 <= 등락율각도(30) < 10 and (초당매도수량 - 초당매수수량) >= 매수총잔량 * self.vars[54] and (현재가 / 현재가N(1) - 1) * 100 < self.vars[55]:
        매도 = True
    elif 0 <= 등락율각도(30) < 5 and (초당매도수량 - 초당매수수량) >= 매수총잔량 * self.vars[56] and (현재가 / 현재가N(1) - 1) * 100 < self.vars[57]:
        매도 = True
    elif 등락율각도(30) < 0 and (초당매도수량 - 초당매수수량) >= 매수총잔량 * self.vars[58] and (현재가 / 현재가N(1) - 1) * 100 < self.vars[59]:
        매도 = True

if 매도:
    self.Sell(종목코드, 종목명, 매도수량, 현재가, 매도호가1, 매수호가1, 강제청산)
```

### 매도 최적화 범위 - C_T_VS_SOR

```python
# 매도 최적화 범위 (매수 변수 38 다음부터 39번부터 시작)
self.vars[39] = [[27.0, 29.0, 1.0], 28.0]        # 등락율 상한가: 27.0%에서 29.0%까지 1.0% 간격, 범위 갯수: 3
self.vars[40] = [[5.0, 7.0, 1.0], 6.0]           # 수익률 상한: 5.0%에서 7.0%까지 1.0% 간격, 범위 갯수: 3
self.vars[41] = [[-4.5, -2.5, 1.0], -3.5]        # 수익률 하한: -4.5%에서 -2.5%까지 1.0% 간격, 범위 갯수: 3
self.vars[42] = [[7.0, 9.0, 1.0], 8.0]           # 최고수익률 기준값: 7.0%에서 9.0%까지 1.0% 간격, 범위 갯수: 3
self.vars[43] = [[0.60, 0.70, 0.05], 0.65]       # 최고수익률 대비 현재 수익률 비율: 0.60에서 0.70까지 0.05 간격, 범위 갯수: 3
self.vars[44] = [[210, 270, 30], 240]            # 보유시간 초과: 210초에서 270초까지 30초 간격, 범위 갯수: 3
self.vars[45] = [[0.5, 0.7, 0.1], 0.6]           # 거래대금감소비율: 0.5배에서 0.7배까지 0.1배 간격, 범위 갯수: 3
self.vars[46] = [[90, 110, 10], 100]             # 체결강도약화기준: 90에서 110까지 10 간격, 범위 갯수: 3
self.vars[47] = [[1, 3, 1], 2]                   # 등락율각도소진기준: 1에서 3까지 1 간격, 범위 갯수: 3
self.vars[48] = [[1.5, 2.5, 0.5], 2.0]           # 거래대금감소시수익률: 1.5%에서 2.5%까지 0.5% 간격, 범위 갯수: 3
self.vars[49] = [[3.5, 4.5, 0.5], 4.0]           # 동력소진시최고수익률: 3.5%에서 4.5%까지 0.5% 간격, 범위 갯수: 3
self.vars[50] = [[0.35, 0.45, 0.05], 0.40]       # 등락율각도15이상매도비율: 0.35에서 0.45까지 0.05 간격, 범위 갯수: 3
self.vars[51] = [[-0.5, -0.3, 0.1], -0.4]        # 등락율각도15이상하락률: -0.5에서 -0.3까지 0.1 간격, 범위 갯수: 3
self.vars[52] = [[0.45, 0.55, 0.05], 0.50]       # 등락율각도10-15매도비율: 0.45에서 0.55까지 0.05 간격, 범위 갯수: 3
self.vars[53] = [[-0.6, -0.4, 0.1], -0.5]        # 등락율각도10-15하락률: -0.6에서 -0.4까지 0.1 간격, 범위 갯수: 3
self.vars[54] = [[0.55, 0.65, 0.05], 0.60]       # 등락율각도5-10매도비율: 0.55에서 0.65까지 0.05 간격, 범위 갯수: 3
self.vars[55] = [[-0.5, -0.3, 0.1], -0.4]        # 등락율각도5-10하락률: -0.5에서 -0.3까지 0.1 간격, 범위 갯수: 3
self.vars[56] = [[0.65, 0.75, 0.05], 0.70]       # 등락율각도0-5매도비율: 0.65에서 0.75까지 0.05 간격, 범위 갯수: 3
self.vars[57] = [[-0.4, -0.2, 0.1], -0.3]        # 등락율각도0-5하락률: -0.4에서 -0.2까지 0.1 간격, 범위 갯수: 3
self.vars[58] = [[0.75, 0.85, 0.05], 0.80]       # 등락율각도음수매도비율: 0.75에서 0.85까지 0.05 간격, 범위 갯수: 3
self.vars[59] = [[-0.5, -0.3, 0.1], -0.4]        # 등락율각도음수하락률: -0.5에서 -0.3까지 0.1 간격, 범위 갯수: 3

# 매도 총 경우의 수: 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 × 3 = 10,460,353,203
```

### 매수 매도 최적화 범위 - C_T_VS_OR

```python
# 평균 틱수 고정값
self.vars[0] = [[60, 60, 0], 60]                 # 평균 틱수 고정값: 60 (1분), 범위 갯수: 1

# [매수 최적화 범위 - 위의 BOR과 동일하게 self.vars[1] ~ self.vars[38]]
# [매도 최적화 범위 - 위의 SOR과 동일하게 self.vars[39] ~ self.vars[59]]

# 매수 매도 총 경우의 수: 205,891,132,094,649 × 10,460,353,203 ≈ 2.15 × 10^24
```

### 예상 시간 계산

각 변수의 범위 갯수를 곱하여 모든 경우의 수를 계산합니다.

- **매수 조건 변수 범위**:
  - 205,891,132,094,649
- **매도 조건 변수 범위**:
  - 10,460,353,203
- **총 경우의 수**:
  - 약 2.15 × 10^24

각 경우에 1분이 걸린다고 가정하면:
- **분**: 2.15 × 10^24 분
- **시간**: 3.58 × 10^22 시간
- **일**: 1.49 × 10^21 일
- **년**: 4.09 × 10^18 년

**가정**: 각 경우의 수를 처리하는 데 1분이 소요된다고 가정하였습니다. 이는 비현실적인 시간이므로, **GA 최적화 방식을 강력히 권장합니다.**

### GA 최적화 범위 - C_T_VS_GAR

```python
# 평균 틱수 고정값
self.vars[0] = [[60], 60]                                                      # 평균 틱수 고정값, 범위 갯수: 1

# GA 최적화 범위 - 거래량 급증 패턴
self.vars[1] = [[25.0, 27.0, 29.0], 29.0]                                      # 등락율 상한, 범위 갯수: 3
self.vars[2] = [[2.5, 3.0, 3.5], 3.0]                                          # 거래대금증가배수, 범위 갯수: 3
self.vars[3] = [[1.1, 1.2, 1.3], 1.2]                                          # 초당거래대금증가율, 범위 갯수: 3
self.vars[4] = [[12, 15, 18], 15]                                              # 당일거래대금각도, 범위 갯수: 3
self.vars[5] = [[110, 120, 130], 120]                                          # 체결강도 하한, 범위 갯수: 3
self.vars[6] = [[1.3, 1.5, 1.7], 1.5]                                          # 누적매수우세비율, 범위 갯수: 3
self.vars[7] = [[1.5, 2.0, 2.5], 2.0]                                          # 최고매수우세비율, 범위 갯수: 3
self.vars[8] = [[0.93, 0.95, 0.97], 0.95]                                      # 고가대비비율, 범위 갯수: 3

# GA 최적화 범위 - 소형주
self.vars[9] = [[-3.0, -2.0, -1.0], -2.0]                                      # 시가등락율 하한, 범위 갯수: 3
self.vars[10] = [[4.0, 5.0, 6.0], 5.0]                                         # 시가등락율 상한, 범위 갯수: 3
self.vars[11] = [[40, 50, 60], 50]                                             # 초당순매수금액 하한, 범위 갯수: 3
self.vars[12] = [[40, 50, 60], 50]                                             # 전일비, 범위 갯수: 3
self.vars[13] = [[40, 50, 60], 50]                                             # 전일동시간비, 범위 갯수: 3
self.vars[14] = [[2.5, 3.0, 3.5], 3.0]                                         # 회전율, 범위 갯수: 3
self.vars[15] = [[400, 500, 600], 500]                                         # 당일거래대금, 범위 갯수: 3
self.vars[16] = [[0.55, 0.60, 0.65], 0.60]                                     # 초당매수수량비율, 범위 갯수: 3
self.vars[17] = [[130, 140, 150], 140]                                         # 체결강도 하한, 범위 갯수: 3
self.vars[18] = [[4, 5, 6], 5]                                                 # 등락율각도, 범위 갯수: 3

# GA 최적화 범위 - 중형주
self.vars[19] = [[-2.0, -1.0, 0.0], -1.0]                                      # 시가등락율 하한, 범위 갯수: 3
self.vars[20] = [[6.0, 7.0, 8.0], 7.0]                                         # 시가등락율 상한, 범위 갯수: 3
self.vars[21] = [[80, 100, 120], 100]                                          # 초당순매수금액 하한, 범위 갯수: 3
self.vars[22] = [[25, 30, 35], 30]                                             # 전일비, 범위 갯수: 3
self.vars[23] = [[25, 30, 35], 30]                                             # 전일동시간비, 범위 갯수: 3
self.vars[24] = [[1.5, 2.0, 2.5], 2.0]                                         # 회전율, 범위 갯수: 3
self.vars[25] = [[800, 1000, 1200], 1000]                                      # 당일거래대금, 범위 갯수: 3
self.vars[26] = [[0.45, 0.50, 0.55], 0.50]                                     # 초당매수수량비율, 범위 갯수: 3
self.vars[27] = [[110, 120, 130], 120]                                         # 체결강도 하한, 범위 갯수: 3
self.vars[28] = [[2, 3, 4], 3]                                                 # 등락율각도, 범위 갯수: 3

# GA 최적화 범위 - 대형주
self.vars[29] = [[-0.5, 0.0, 0.5], 0.0]                                        # 시가등락율 하한, 범위 갯수: 3
self.vars[30] = [[9.0, 10.0, 11.0], 10.0]                                      # 시가등락율 상한, 범위 갯수: 3
self.vars[31] = [[150, 200, 250], 200]                                         # 초당순매수금액 하한, 범위 갯수: 3
self.vars[32] = [[15, 20, 25], 20]                                             # 전일비, 범위 갯수: 3
self.vars[33] = [[15, 20, 25], 20]                                             # 전일동시간비, 범위 갯수: 3
self.vars[34] = [[0.5, 1.0, 1.5], 1.0]                                         # 회전율, 범위 갯수: 3
self.vars[35] = [[1500, 2000, 2500], 2000]                                     # 당일거래대금, 범위 갯수: 3
self.vars[36] = [[0.35, 0.40, 0.45], 0.40]                                     # 초당매수수량비율, 범위 갯수: 3
self.vars[37] = [[90, 100, 110], 100]                                          # 체결강도 하한, 범위 갯수: 3
self.vars[38] = [[1, 2, 3], 2]                                                 # 등락율각도, 범위 갯수: 3

# GA 최적화 범위 - 매도
self.vars[39] = [[27.0, 28.0, 29.0], 28.0]                                     # 등락율 상한가, 범위 갯수: 3
self.vars[40] = [[5.0, 6.0, 7.0], 6.0]                                         # 수익률 상한, 범위 갯수: 3
self.vars[41] = [[-4.5, -3.5, -2.5], -3.5]                                     # 수익률 하한, 범위 갯수: 3
self.vars[42] = [[7.0, 8.0, 9.0], 8.0]                                         # 최고수익률 기준값, 범위 갯수: 3
self.vars[43] = [[0.60, 0.65, 0.70], 0.65]                                     # 최고수익률 대비 현재 수익률 비율, 범위 갯수: 3
self.vars[44] = [[210, 240, 270], 240]                                         # 보유시간 초과, 범위 갯수: 3
self.vars[45] = [[0.5, 0.6, 0.7], 0.6]                                         # 거래대금감소비율, 범위 갯수: 3
self.vars[46] = [[90, 100, 110], 100]                                          # 체결강도약화기준, 범위 갯수: 3
self.vars[47] = [[1, 2, 3], 2]                                                 # 등락율각도소진기준, 범위 갯수: 3
self.vars[48] = [[1.5, 2.0, 2.5], 2.0]                                         # 거래대금감소시수익률, 범위 갯수: 3
self.vars[49] = [[3.5, 4.0, 4.5], 4.0]                                         # 동력소진시최고수익률, 범위 갯수: 3
self.vars[50] = [[0.35, 0.40, 0.45], 0.40]                                     # 등락율각도15이상매도비율, 범위 갯수: 3
self.vars[51] = [[-0.5, -0.4, -0.3], -0.4]                                     # 등락율각도15이상하락률, 범위 갯수: 3
self.vars[52] = [[0.45, 0.50, 0.55], 0.50]                                     # 등락율각도10-15매도비율, 범위 갯수: 3
self.vars[53] = [[-0.6, -0.5, -0.4], -0.5]                                     # 등락율각도10-15하락률, 범위 갯수: 3
self.vars[54] = [[0.55, 0.60, 0.65], 0.60]                                     # 등락율각도5-10매도비율, 범위 갯수: 3
self.vars[55] = [[-0.5, -0.4, -0.3], -0.4]                                     # 등락율각도5-10하락률, 범위 갯수: 3
self.vars[56] = [[0.65, 0.70, 0.75], 0.70]                                     # 등락율각도0-5매도비율, 범위 갯수: 3
self.vars[57] = [[-0.4, -0.3, -0.2], -0.3]                                     # 등락율각도0-5하락률, 범위 갯수: 3
self.vars[58] = [[0.75, 0.80, 0.85], 0.80]                                     # 등락율각도음수매도비율, 범위 갯수: 3
self.vars[59] = [[-0.5, -0.4, -0.3], -0.4]                                     # 등락율각도음수하락률, 범위 갯수: 3
```

## 태그
- #주식트레이딩
- #틱트레이딩
- #거래량급증패턴
- #VolumeSurge
- #대량매수세
- #매수조건
- #매도조건
- #최적화
- #유전알고리즘
- #파이썬
- #트레이딩로직
- #단기급등
- #체결강도
- #거래대금
