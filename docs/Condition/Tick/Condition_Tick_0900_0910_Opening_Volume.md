# 조건식 (Condition)

- STOM 주식 자동거래에 사용하기 위한 조건식 문서
- [[Back_Testing_Guideline_Tick]] 을(를) 기반으로 작성한 Tick 조건식
- [[Condition_Document_Template_Guideline]] 을(를) 바탕으로 템플릿 구조를 적용한 문서

## 목차
- [조건식 (Condition)](#조건식-condition)
  - [목차](#목차)
  - [소개](#소개)
  - [개요](#개요)
- [Condition - Tick 0900\_0910 Opening Volume](#condition---tick-0900_0910-opening-volume)
  - [전략 개요](#전략-개요)
  - [조건식](#조건식)
    - [매수 조건식](#매수-조건식)
    - [매도 조건식](#매도-조건식)
  - [최적화 조건식](#최적화-조건식)
    - [매수 최적화 범위](#매수-최적화-범위)
    - [매도 최적화 범위](#매도-최적화-범위)
    - [GA 최적화 범위](#ga-최적화-범위)
  - [조건식 개선 방향 연구](#조건식-개선-방향-연구)
  - [태그](#태그)

## 소개

이 문서는 STOM 주식 자동거래 시스템에서 **09:00~09:10 개장 직후 대량 거래 진입 전략**을 정의한 Tick 기반 조건식입니다. 시가 결정 후 폭발적인 거래량 증가와 강한 매수세를 보이는 종목을 포착하여 진입합니다.

## 개요

본 문서는 STOM 주식 자동거래 시스템에서 **개장 직후 10분(09:00 ~ 09:10)** 대량 거래 진입 전략을 정의한다.

- **대상 시간 구간**: 09:00:00 ~ 09:10:00 (개장 직후 10분)
- **대상 종목**: 시가총액 3,000억 미만, 가격대 1,500원~20,000원
- **전략 타입**: 개장 갭상승 + 대량거래 모멘텀 포착
- **핵심 변수**: 초당거래대금, 체결강도, 시가등락율, 시가대비등락율, 초당순매수금액, 회전율
- **업데이트 이력**:
  - 초기 문서 작성

---

# Condition - Tick 0900_0910 Opening Volume

## 전략 개요

**타겟 시간대**: 09:00 ~ 09:10 (개장 직후 10분)

**핵심 아이디어**:
1. 시가 대비 강한 상승세
2. 폭발적인 초당거래대금 증가
3. 매수잔량 우위 호가창
4. 초반 급등 후 빠른 청산

## 조건식

### 매수 조건식

```python
초당순매수금액 = (초당매수수량 - 초당매도수량) * 현재가 / 1_000_000
전일종가 = 현재가 / (1 + (등락율 / 100))
시가등락율 = ((시가 - 전일종가) / 전일종가) * 100
시가대비등락율 = ((현재가 - 시가) / 시가) * 100

if not (90000 <= 시분초 < 91000):
    매수 = False
elif not (1500 < 현재가 <= 20000):
    매수 = False
elif not (2.0 < 등락율 <= 29.0):
    매수 = False
elif not (현재가 < VI아래5호가):
    매수 = False
elif not (1.0 <= 시가등락율 <= 15.0):
    매수 = False
elif not (0.5 <= 시가대비등락율 <= 10.0):
    매수 = False
elif not (데이터길이 > 5):
    매수 = False
elif not (초당거래대금 > 초당거래대금평균(10) * 4.0):
    매수 = False
elif not (체결강도 > 200):
    매수 = False
elif not (초당매수수량 > 매도총잔량 * 60 / 100):
    매수 = False
elif not (매수총잔량 > 매도총잔량 * 1.5):
    매수 = False
elif not (초당순매수금액 > 30):
    매수 = False
elif 시가총액 < 1500:
    if not (전일동시간비 > 200):
        매수 = False
    elif not (회전율 > 2.5):
        매수 = False
elif 시가총액 < 3000:
    if not (전일동시간비 > 150):
        매수 = False
    elif not (회전율 > 2.0):
        매수 = False
else:
    if not (전일동시간비 > 100):
        매수 = False
    elif not (회전율 > 1.5):
        매수 = False
```

### 매도 조건식

```python
if 등락율 > 29.5:
    매도 = True
elif 수익률 >= 4.0:
    매도 = True
elif 수익률 <= -3.0:
    매도 = True
elif 최고수익률 - 수익률 >= 2.5:
    매도 = True
elif 시분초 >= 91500:
    매도 = True
elif 보유시간 > 300:
    매도 = True
elif 체결강도 < 80 and 수익률 > 1.0:
    매도 = True
elif (초당매도수량 - 초당매수수량) >= 매수총잔량 * 0.9 and 수익률 > 0.5:
    매도 = True
elif 등락율각도(10) < -10 and 수익률 > 1.5:
    매도 = True
```

## 최적화 조건식

### 매수 최적화 범위

```python
self.vars[0] = [[1000, 2000, 250], 1500]      # 현재가 하한
self.vars[1] = [[15000, 25000, 2500], 20000]  # 현재가 상한
self.vars[2] = [[1.5, 2.5, 0.25], 2.0]        # 등락율 하한
self.vars[3] = [[27.0, 29.5, 0.5], 29.0]      # 등락율 상한
self.vars[4] = [[0.5, 1.5, 0.25], 1.0]        # 시가등락율 하한
self.vars[5] = [[0.3, 0.7, 0.1], 0.5]         # 시가대비등락율 하한
self.vars[6] = [[3.0, 5.0, 0.5], 4.0]         # 초당거래대금 배수
self.vars[7] = [[180, 220, 10], 200]          # 체결강도
self.vars[8] = [[50, 70, 5], 60]              # 초당매수수량/매도총잔량
self.vars[9] = [[25, 35, 2.5], 30]            # 초당순매수금액
```

### 매도 최적화 범위

```python
self.vars[20] = [[3.0, 5.0, 0.5], 4.0]        # 목표 수익률
self.vars[21] = [[-4.0, -2.0, 0.5], -3.0]     # 손절 수익률
self.vars[22] = [[2.0, 3.0, 0.25], 2.5]       # 고점 대비 하락폭
self.vars[23] = [[240, 360, 30], 300]         # 보유시간 제한
```

### GA 최적화 범위

```python
self.vars[0] = [[1000, 1250, 1500, 1750, 2000], 1500]
self.vars[1] = [[15000, 17500, 20000, 22500, 25000], 20000]
self.vars[2] = [[1.5, 1.75, 2.0, 2.25, 2.5], 2.0]
self.vars[3] = [[27.0, 27.5, 28.0, 28.5, 29.0, 29.5], 29.0]
self.vars[4] = [[0.5, 0.75, 1.0, 1.25, 1.5], 1.0]
self.vars[5] = [[0.3, 0.4, 0.5, 0.6, 0.7], 0.5]
self.vars[6] = [[3.0, 3.5, 4.0, 4.5, 5.0], 4.0]
self.vars[7] = [[180, 190, 200, 210, 220], 200]
self.vars[8] = [[50, 55, 60, 65, 70], 60]
self.vars[9] = [[25, 27.5, 30, 32.5, 35], 30]
self.vars[20] = [[3.0, 3.5, 4.0, 4.5, 5.0], 4.0]
self.vars[21] = [[-4.0, -3.5, -3.0, -2.5, -2.0], -3.0]
self.vars[22] = [[2.0, 2.25, 2.5, 2.75, 3.0], 2.5]
self.vars[23] = [[240, 270, 300, 330, 360], 300]
```

---

## 조건식 개선 방향 연구

### 1. 추가 지표 활용 연구

**우선순위: 높음**
- **초당거래대금 가속도 지표**
  - 초당거래대금의 1차/2차 미분을 통한 가속도 측정
  - 급격한 거래량 증가 신호 포착
  - 구현 난이도: 중

**우선순위: 중간**
- **매수/매도 수량 비율 변화**
  - 초당매수수량 대비 초당매도수량 비율의 시간적 변화 추적
  - 매수세 지속성 확인
  - 구현 난이도: 낮음

### 2. TA-Lib 보조지표 활용 연구

**우선순위: 높음**
- **RSI 활용**
  - 초단기 RSI(14틱) 활용하여 과매수/과매도 구간 회피
  - 개장 직후 급등 시 RSI 과열 확인
  - 구현 난이도: 낮음

**우선순위: 중간**
- **ATR (Average True Range) 활용**
  - 변동성 측정을 통한 진입/청산 조건 조정
  - 고변동성 구간 회피 또는 공격적 진입
  - 구현 난이도: 중

### 3. 시간대별 전략 세분화 연구

**우선순위: 높음**
- **09:00~09:05 vs 09:05~09:10 세분화**
  - 초반 5분과 후반 5분의 시장 특성 차이 반영
  - 각 구간별 다른 체결강도/거래량 임계값 적용
  - 구현 난이도: 중

### 4. 매도 조건 고도화 연구

**우선순위: 높음**
- **시간 기반 트레일링 스톱**
  - 보유 시간에 따른 동적 손절/익절 조정
  - 개장 직후 급등 후 빠른 청산 전략
  - 구현 난이도: 중

**우선순위: 중간**
- **거래량 급감 신호**
  - 초당거래대금이 평균 대비 급감 시 조기 청산
  - 모멘텀 소멸 조기 감지
  - 구현 난이도: 낮음

### 5. 리스크 관리 강화 연구

**우선순위: 높음**
- **동시 진입 종목 수 제한**
  - 개장 직후 여러 종목 동시 급등 시 분산 투자
  - 최대 3~5종목 동시 보유 제한
  - 구현 난이도: 중

**우선순위: 높음**
- **VI 발동 사전 예측**
  - VI 발동 가능성 높은 구간 사전 회피
  - VI 근접 시 조기 청산
  - 구현 난이도: 낮음

### 구현 우선순위

1. **1단계 (즉시 구현)**:
   - 초당거래대금 가속도 지표
   - RSI 활용
   - VI 발동 사전 예측

2. **2단계 (1개월 내)**:
   - 시간대별 세분화 (09:00~09:05 / 09:05~09:10)
   - 시간 기반 트레일링 스톱
   - 동시 진입 종목 수 제한

3. **3단계 (3개월 내)**:
   - ATR 활용
   - 매수/매도 수량 비율 변화 추적
   - 거래량 급감 신호

---

## 태그

- #주식트레이딩
- #틱트레이딩
- #매수조건
- #매도조건
- #최적화
- #유전알고리즘
- #파이썬
- #트레이딩로직
- #개장전략
- #대량거래
- #체결강도
- #초당거래대금
- #리스크관리
