# 조건식 - 오후 초반 체결강도 급등 전략 (13:00~14:00)

- STOM 주식 자동거래에 사용하기 위한 틱 데이터 조건식 문서
- Back_Testing_Guideline_Tick.md 에 있는 조건식을 사용하여 만든 조건식

## 목차
- [조건식 - 오후 초반 체결강도 급등 전략 (13:00~14:00)](#조건식---오후-초반-체결강도-급등-전략-13001400)
  - [목차](#목차)
  - [소개](#소개)
  - [전략 개요](#전략-개요)
  - [조건식](#조건식)
    - [매수 조건식 - C\_T\_1300\_1400\_SS\_B](#매수-조건식---c_t_1300_1400_ss_b)
    - [매도 조건식 - C\_T\_1300\_1400\_SS\_S](#매도-조건식---c_t_1300_1400_ss_s)
  - [최적화 조건식](#최적화-조건식)
    - [매수 최적화 조건식 - C\_T\_1300\_1400\_SS\_BO](#매수-최적화-조건식---c_t_1300_1400_ss_bo)
    - [매수 최적화 범위 - C\_T\_1300\_1400\_SS\_BOR](#매수-최적화-범위---c_t_1300_1400_ss_bor)
    - [매도 최적화 조건식 - C\_T\_1300\_1400\_SS\_SO](#매도-최적화-조건식---c_t_1300_1400_ss_so)
    - [매도 최적화 범위 - C\_T\_1300\_1400\_SS\_SOR](#매도-최적화-범위---c_t_1300_1400_ss_sor)
    - [매수 매도 통합 최적화 범위 - C\_T\_1300\_1400\_SS\_OR](#매수-매도-통합-최적화-범위---c_t_1300_1400_ss_or)
    - [GA 최적화 범위 - C\_T\_1300\_1400\_SS\_GAR](#ga-최적화-범위---c_t_1300_1400_ss_gar)

## 소개

이 문서는 13:00~14:00 오후 초반 시간대의 체결강도 급등을 감지하여 매매하는 틱 기반 전략입니다.
점심시간 이후 오후 장이 시작되면서 새로운 매수세가 유입되는 종목을 선별합니다.
체결강도의 급격한 상승과 누적 매수량 증가를 통해 강한 매수세를 확인합니다.

## 전략 개요

**타겟 시간대**: 13:00 ~ 14:00 (오후 초반 시간대)

**핵심 아이디어**:
1. 점심시간 이후 체결강도가 급격하게 상승하는 종목 포착
2. 누적 초당매수수량이 매도수량을 크게 상회하는 종목 선별
3. 최고체결강도 대비 현재 체결강도가 높은 수준 유지
4. 호가창에서 매수 우위 지속 확인

**적용 대상**:
- 시가총액 2000억~5000억 중형주
- 등락율 5~20% 범위 종목

## 조건식

### 매수 조건식 - C_T_1300_1400_SS_B

```python
초당순매수금액 = (초당매수수량 - 초당매도수량) * 현재가 / 1_000_000

# 시간대 제한: 13:00 ~ 14:00
if not (130000 <= 시분초 < 140000):
    매수 = False

# 가격 및 등락율 범위
elif not (3000 < 현재가 <= 25000):
    매수 = False
elif not (5.0 < 등락율 <= 20.0):
    매수 = False

# VI 조건
elif not (현재가 < VI아래5호가):
    매수 = False

# 라운드 피겨 회피
elif 라운드피겨위5호가이내:
    매수 = False

# 체결강도 급등 감지
elif not (체결강도 > 150):
    매수 = False
elif not (체결강도 > 체결강도평균(30) * 1.5):
    매수 = False
elif not (체결강도 > 체결강도N(1) + 30):
    매수 = False

# 체결강도 최고치 대비 높은 수준 유지
elif not (체결강도 > 최고체결강도(60) * 0.7):
    매수 = False

# 누적 매수 우위
elif not (누적초당매수수량(30) > 누적초당매도수량(30) * 1.8):
    매수 = False

# 초당거래대금 증가
elif not (초당거래대금 > 초당거래대금평균(60) * 2.0):
    매수 = False

# 호가창 조건
elif not (초당매수수량 > 매도총잔량 * 50 / 100):
    매수 = False
elif not (매수총잔량 > 매도총잔량):
    매수 = False

# 시가총액별 조건 분기
elif 시가총액 < 2000:
    if not (전일비 > 80):
        매수 = False
    elif not (회전율 > 3):
        매수 = False
    elif not (등락율각도(30) > 10):
        매수 = False
    elif not (당일거래대금 > 300):
        매수 = False
    elif not (초당순매수금액 > 40):
        매수 = False

elif 시가총액 < 5000:
    if not (전일비 > 60):
        매수 = False
    elif not (회전율 > 2):
        매수 = False
    elif not (등락율각도(30) > 8):
        매수 = False
    elif not (당일거래대금 > 500):
        매수 = False
    elif not (초당순매수금액 > 60):
        매수 = False

else:
    if not (전일비 > 40):
        매수 = False
    elif not (회전율 > 1.5):
        매수 = False
    elif not (등락율각도(30) > 6):
        매수 = False
    elif not (당일거래대금 > 800):
        매수 = False
    elif not (초당순매수금액 > 100):
        매수 = False
```

### 매도 조건식 - C_T_1300_1400_SS_S

```python
# 상한가 근접
if 등락율 > 29.5:
    매도 = True

# 이익실현
elif 수익률 >= 3.0:
    매도 = True

# 손절
elif 수익률 <= -2.5:
    매도 = True

# 고점 대비 하락
elif 최고수익률 - 수익률 >= 2.0:
    매도 = True

# 체결강도 급락
elif 체결강도 < 최저체결강도(30) + 10 and 수익률 > 0.5:
    매도 = True

# 체결강도 평균 이하로 하락
elif 체결강도 < 체결강도평균(60) * 0.6 and 수익률 > 0:
    매도 = True

# 시가총액별 매도 조건
elif 시가총액 < 5000:
    # 매도세 전환
    if (초당매도수량 - 초당매수수량) >= 매수총잔량 * 0.7 and 수익률 > 0.3:
        매도 = True
    # 등락율 각도 하락
    elif 등락율각도(30) < 3 and 수익률 > 1.5:
        매도 = True
    # 호가창 반전
    elif 매도총잔량 > 매수총잔량 * 1.5 and 수익률 > 0.5:
        매도 = True

else:
    # 매도세 전환
    if (초당매도수량 - 초당매수수량) >= 매수총잔량 * 0.5 and 수익률 > 0.3:
        매도 = True
    # 등락율 각도 하락
    elif 등락율각도(30) < 5 and 수익률 > 1.5:
        매도 = True
    # 호가창 반전
    elif 매도총잔량 > 매수총잔량 and 수익률 > 0.5:
        매도 = True
```

## 최적화 조건식

### 매수 최적화 조건식 - C_T_1300_1400_SS_BO

```python
초당순매수금액 = (초당매수수량 - 초당매도수량) * 현재가 / 1_000_000

if not (130000 <= 시분초 < 140000):
    매수 = False
elif not (self.vars[0] < 현재가 <= self.vars[1]):
    매수 = False
elif not (self.vars[2] < 등락율 <= self.vars[3]):
    매수 = False
elif not (현재가 < VI아래5호가):
    매수 = False
elif 라운드피겨위5호가이내:
    매수 = False
elif not (체결강도 > self.vars[4]):
    매수 = False
elif not (체결강도 > 체결강도평균(30) * self.vars[5]):
    매수 = False
elif not (체결강도 > 체결강도N(1) + self.vars[6]):
    매수 = False
elif not (체결강도 > 최고체결강도(60) * self.vars[7]):
    매수 = False
elif not (누적초당매수수량(30) > 누적초당매도수량(30) * self.vars[8]):
    매수 = False
elif not (초당거래대금 > 초당거래대금평균(60) * self.vars[9]):
    매수 = False
elif not (초당매수수량 > 매도총잔량 * self.vars[10] / 100):
    매수 = False
elif not (매수총잔량 > 매도총잔량):
    매수 = False
elif 시가총액 < self.vars[11]:
    if not (전일비 > self.vars[12]):
        매수 = False
    elif not (회전율 > self.vars[13]):
        매수 = False
    elif not (등락율각도(30) > self.vars[14]):
        매수 = False
    elif not (초당순매수금액 > self.vars[15]):
        매수 = False
```

### 매수 최적화 범위 - C_T_1300_1400_SS_BOR

```python
self.vars[0] = [[2000, 4000, 500], 3000]      # 현재가 하한
self.vars[1] = [[20000, 30000, 2500], 25000]  # 현재가 상한
self.vars[2] = [[4.0, 6.0, 0.5], 5.0]         # 등락율 하한
self.vars[3] = [[18.0, 22.0, 1.0], 20.0]      # 등락율 상한
self.vars[4] = [[130, 170, 10], 150]          # 체결강도 최소값
self.vars[5] = [[1.3, 1.7, 0.1], 1.5]         # 체결강도/평균 비율
self.vars[6] = [[20, 40, 5], 30]              # 체결강도 증가폭
self.vars[7] = [[0.6, 0.8, 0.05], 0.7]        # 체결강도/최고치 비율
self.vars[8] = [[1.5, 2.1, 0.15], 1.8]        # 누적매수/매도 비율
self.vars[9] = [[1.5, 2.5, 0.25], 2.0]        # 초당거래대금 배수
self.vars[10] = [[40, 60, 5], 50]             # 초당매수수량/매도총잔량
self.vars[11] = [[1500, 2500, 250], 2000]     # 시가총액 기준
self.vars[12] = [[60, 100, 10], 80]           # 전일비
self.vars[13] = [[2.0, 4.0, 0.5], 3.0]        # 회전율
self.vars[14] = [[8, 12, 1], 10]              # 등락율각도
self.vars[15] = [[30, 50, 5], 40]             # 초당순매수금액
```

### 매도 최적화 조건식 - C_T_1300_1400_SS_SO

```python
if 등락율 > 29.5:
    매도 = True
elif 수익률 >= self.vars[20]:
    매도 = True
elif 수익률 <= self.vars[21]:
    매도 = True
elif 최고수익률 - 수익률 >= self.vars[22]:
    매도 = True
elif 체결강도 < 최저체결강도(30) + self.vars[23] and 수익률 > 0.5:
    매도 = True
elif 체결강도 < 체결강도평균(60) * self.vars[24] and 수익률 > 0:
    매도 = True
elif 시가총액 < 5000:
    if (초당매도수량 - 초당매수수량) >= 매수총잔량 * self.vars[25] and 수익률 > 0.3:
        매도 = True
```

### 매도 최적화 범위 - C_T_1300_1400_SS_SOR

```python
self.vars[20] = [[2.5, 3.5, 0.25], 3.0]       # 목표 수익률
self.vars[21] = [[-3.5, -2.0, 0.25], -2.5]    # 손절 수익률
self.vars[22] = [[1.5, 2.5, 0.25], 2.0]       # 고점 대비 하락폭
self.vars[23] = [[5, 15, 2.5], 10]            # 체결강도 하락폭
self.vars[24] = [[0.5, 0.7, 0.05], 0.6]       # 체결강도/평균 비율
self.vars[25] = [[0.5, 0.8, 0.1], 0.7]        # 매도세 우위 비율
```

### 매수 매도 통합 최적화 범위 - C_T_1300_1400_SS_OR

```python
# 매수 변수
self.vars[0] = [[2000, 4000, 500], 3000]
self.vars[1] = [[20000, 30000, 2500], 25000]
self.vars[2] = [[4.0, 6.0, 0.5], 5.0]
self.vars[3] = [[18.0, 22.0, 1.0], 20.0]
self.vars[4] = [[130, 170, 10], 150]
self.vars[5] = [[1.3, 1.7, 0.1], 1.5]
self.vars[6] = [[20, 40, 5], 30]
self.vars[7] = [[0.6, 0.8, 0.05], 0.7]
self.vars[8] = [[1.5, 2.1, 0.15], 1.8]
self.vars[9] = [[1.5, 2.5, 0.25], 2.0]
self.vars[10] = [[40, 60, 5], 50]
self.vars[11] = [[1500, 2500, 250], 2000]
self.vars[12] = [[60, 100, 10], 80]
self.vars[13] = [[2.0, 4.0, 0.5], 3.0]
self.vars[14] = [[8, 12, 1], 10]
self.vars[15] = [[30, 50, 5], 40]

# 매도 변수
self.vars[20] = [[2.5, 3.5, 0.25], 3.0]
self.vars[21] = [[-3.5, -2.0, 0.25], -2.5]
self.vars[22] = [[1.5, 2.5, 0.25], 2.0]
self.vars[23] = [[5, 15, 2.5], 10]
self.vars[24] = [[0.5, 0.7, 0.05], 0.6]
self.vars[25] = [[0.5, 0.8, 0.1], 0.7]
```

### GA 최적화 범위 - C_T_1300_1400_SS_GAR

```python
# 매수 변수
self.vars[0] = [[2000, 2500, 3000, 3500, 4000], 3000]
self.vars[1] = [[20000, 22500, 25000, 27500, 30000], 25000]
self.vars[2] = [[4.0, 4.5, 5.0, 5.5, 6.0], 5.0]
self.vars[3] = [[18.0, 19.0, 20.0, 21.0, 22.0], 20.0]
self.vars[4] = [[130, 140, 150, 160, 170], 150]
self.vars[5] = [[1.3, 1.4, 1.5, 1.6, 1.7], 1.5]
self.vars[6] = [[20, 25, 30, 35, 40], 30]
self.vars[7] = [[0.6, 0.65, 0.7, 0.75, 0.8], 0.7]
self.vars[8] = [[1.5, 1.65, 1.8, 1.95, 2.1], 1.8]
self.vars[9] = [[1.5, 1.75, 2.0, 2.25, 2.5], 2.0]
self.vars[10] = [[40, 45, 50, 55, 60], 50]
self.vars[11] = [[1500, 1750, 2000, 2250, 2500], 2000]
self.vars[12] = [[60, 70, 80, 90, 100], 80]
self.vars[13] = [[2.0, 2.5, 3.0, 3.5, 4.0], 3.0]
self.vars[14] = [[8, 9, 10, 11, 12], 10]
self.vars[15] = [[30, 35, 40, 45, 50], 40]

# 매도 변수
self.vars[20] = [[2.5, 2.75, 3.0, 3.25, 3.5], 3.0]
self.vars[21] = [[-3.5, -3.0, -2.5, -2.0], -2.5]
self.vars[22] = [[1.5, 1.75, 2.0, 2.25, 2.5], 2.0]
self.vars[23] = [[5, 7.5, 10, 12.5, 15], 10]
self.vars[24] = [[0.5, 0.55, 0.6, 0.65, 0.7], 0.6]
self.vars[25] = [[0.5, 0.6, 0.7, 0.8], 0.7]
```
