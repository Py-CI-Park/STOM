# 한국 주식 시장 장 초반 극초단타 매매를 위한 STOM 조건식 보고서

- STOM 주식 자동거래에 사용하기 위한 조건식 문서
- [[Back_Testing_Guideline_Tick]] 을(를) 기반으로 작성한 Tick 조건식
- [[Condition_Document_Template_Guideline]] 을(를) 바탕으로 템플릿 구조를 적용한 문서

## 개요

본 문서는 STOM 주식 자동거래 시스템에서 **한국 주식 시장 장 초반 극초단타 매매를 위한 STOM 조건식 보고서**을 정의한다.

- **대상 시간 구간**: 09:00:00 ~ 15:00:00 (장중 전체)
- **대상 종목**: 관심종목, 시가총액 차등 기준
- **전략 타입**: Tick 기반 단타 전략
- **핵심 변수**: 체결강도, 초당거래대금, 등락율각도, 회전율
- **업데이트 이력**:
  - 초기 문서 작성: 한국 주식 시장 장 초반 극초단타 매매를 위한 STOM 조건식 보고서

## 1. 새로운 변수 목록

### 1.1 초당순매수비율 (float)
- **설명**: 초당 매수 수량과 매도 수량의 비율로, 매수 세력의 상대적 우위를 나타냅니다. 50% 초과 시 매수 우위.
- **활용**: 매수 세력 급증(예: 60% 이상) 시 매수 신호.
- **코드**:
  ```python
  # 초당순매수비율: 매수 수량의 비율(%)로 계산
  초당순매수비율 = 초당매수수량 / (초당매수수량 + 초당매도수량) * 100 if (초당매수수량 + 초당매도수량) != 0 else 0
  ```

### 1.2 호가압력지수 (float)
- **설명**: 매수 총 잔량과 매도 총 잔량의 차이를 비율로 계산. 양수는 매수 우위, 음수는 매도 우위.
- **활용**: 매수 잔량 우위(예: 20% 이상) 시 매수, 매도 우위(-20% 이하) 시 매도.
- **코드**:
  ```python
  # 호가압력지수: 매수와 매도 잔량의 상대적 차이를 퍼센트로 표현
  호가압력지수 = (매수총잔량 - 매도총잔량) / (매수총잔량 + 매도총잔량) * 100 if (매수총잔량 + 매도총잔량) != 0 else 0
  ```

### 1.3 단기변동성 (float)
- **설명**: 최근 10틱 동안의 최고가와 최저가 차이를 최저가로 나눈 퍼센트. 변동성 증가를 감지.
- **활용**: 변동성 증가(예: 2% 이상) 시 매수.
- **코드**:
  ```python
  # 단기변동성: 10틱 내 가격 변동폭을 퍼센트로 계산
  단기변동성 = (최고현재가(10) - 최저현재가(10)) / 최저현재가(10) * 100
  ```

### 1.4 매수호가밀도 (float)
- **설명**: 매수 1~3호가 잔량을 가격 차이로 나눈 값. 매수 지지력 강도를 측정.
- **활용**: 강한 지지(예: 100 이상) 시 매수.
- **코드**:
  ```python
  # 매수호가밀도: 매수 1~3호가 잔량을 가격 간격으로 나눔
  매수호가밀도 = (매수잔량1 + 매수잔량2 + 매수잔량3) / (매수호가1 - 매수호가3) if (매수호가1 - 매수호가3) != 0 else 0
  ```

### 1.5 거래대금가속도 (float)
- **설명**: 초당 거래대금의 틱 간 증가율. 거래 활성도의 순간적 변화를 감지.
- **활용**: 거래량 급증(예: 50% 이상) 시 매수.
- **코드**:
  ```python
  # 거래대금가속도: 초당 거래대금의 증가율(%) 계산
  거래대금가속도 = (초당거래대금 - 초당거래대금N(1)) / 초당거래대금N(1) * 100 if 초당거래대금N(1) != 0 else 0
  ```

### 1.6 장초진행률 (float)
- **설명**: 09:00~09:30(3000초) 동안 경과 시간을 퍼센트로 계산.
- **활용**: 시간대별 전략 조정(예: 33%~66% 구간).
- **코드**:
  ```python
  # 장초진행률: 09:00~09:30 내 경과 시간을 퍼센트로 계산
  장초진행률 = (시분초 - 90000) / 3000 * 100
  ```

### 1.7 체결강도가속도 (float)
- **설명**: 체결강도의 틱 간 변화율. 매수/매도 세력 가속도를 측정.
- **활용**: 매수 세력 강화(예: 20% 이상) 시 매수, 약화(-20% 이하) 시 매도.
- **코드**:
  ```python
  # 체결강도가속도: 체결강도의 증가율(%) 계산
  체결강도가속도 = (체결강도 - 체결강도N(1)) / 체결강도N(1) * 100 if 체결강도N(1) != 0 else 0
  ```

### 1.8 호가간격비율 (float)
- **설명**: 매도 1호가와 매수 1호가 간격을 호가 단위로 나눈 값. 호가 밀집(1~1.5) 또는 이격(2 이상)을 감지.
- **활용**: 호가 이격(2 이상) 시 매도.
- **코드**:
  ```python
  # 호가간격비율: 매도 1호가와 매수 1호가 간격을 호가 단위로 정규화
  호가간격비율 = (매도호가1 - 매수호가1) / 호가단위
  ```

### 1.9 누적거래대금비율 (float)
- **설명**: 당일 거래대금을 시가총액과 회전율로 정규화한 비율. 거래량 집중도를 측정.
- **활용**: 거래량 집중(5% 이상) 시 매수.
- **코드**:
  ```python
  # 누적거래대금비율: 당일 거래대금을 시가총액 대비 회전율로 나눔
  누적거래대금비율 = 당일거래대금 / (시가총액 * 회전율 / 100) * 100 if (시가총액 * 회전율 / 100) != 0 else 0
  ```

### 1.10 매수잔량증가율 (float)
- **설명**: 매수 총 잔량의 틱 간 증가율. 매수 지지력 변화를 감지.
- **활용**: 매수 잔량 급증(30% 이상) 시 매수, 감소(-20% 이하) 시 매도.
- **코드**:
  ```python
  # 매수잔량증가율: 매수 총 잔량의 틱 간 증가율(%) 계산
  매수잔량증가율 = (매수총잔량 - 매수총잔량N(1)) / 매수총잔량N(1) * 100 if 매수총잔량N(1) != 0 else 0
  ```

### 1.11 장초고저폭 (float)
- **설명**: 고가와 저가 차이를 시가로 나눈 퍼센트. 장 초반 변동 범위를 측정.
- **활용**: 변동성 증가(3% 이상) 시 매수.
- **코드**:
  ```python
  # 장초고저폭: 고가와 저가 차이를 시가로 정규화하여 퍼센트로 계산
  장초고저폭 = (고가 - 저가) / 시가 * 100
  ```

### 1.12 RSI변화율 (float)
- **설명**: RSI의 틱 간 변화율. 단기 모멘텀 변화를 추적.
- **활용**: 모멘텀 가속(10% 이상) 시 매수, 하락(-10% 이하) 시 매도.
- **코드**:
  ```python
  # RSI변화율: RSI의 틱 간 변화율(%) 계산
  RSI변화율 = (RSI - RSI_N(1)) / RSI_N(1) * 100 if RSI_N(1) != 0 else 0
  ```

### 1.13 이동평균기울기 (float)
- **설명**: 5틱 이동평균의 틱 간 변화율. 단기 추세 기울기를 측정.
- **활용**: 상승 추세(0.5% 이상) 시 매수, 하락(-0.5% 이하) 시 매도.
- **코드**:
  ```python
  # 이동평균기울기: 5틱 이동평균의 변화율(%) 계산
  이동평균기울기 = (이동평균(5) - 이동평균(5, 1)) / 이동평균(5, 1) * 100 if 이동평균(5, 1) != 0 else 0
  ```

### 1.14 호가균형지수 (float)
- **설명**: 매수 1~2호가와 매도 1~2호가 잔량 비율. 상위 호가 균형을 측정.
- **활용**: 매수 우위(120% 이상) 시 매수, 매도 우위(80% 이하) 시 매도.
- **코드**:
  ```python
  # 호가균형지수: 상위 2호가 매수/매도 잔량 비율(%) 계산
  호가균형지수 = (매수잔량1 + 매수잔량2) / (매도잔량1 + 매도잔량2) * 100 if (매도잔량1 + 매도잔량2) != 0 else 0
  ```

### 1.15 체결강도변동성 (float)
- **설명**: 10틱 내 체결 강도의 변동폭을 평균으로 나눈 값. 체결 세력 안정성을 측정.
- **활용**: 안정(50% 미만) 시 매수 유지, 불안정(50% 이상) 시 매도.
- **코드**:
  ```python
  # 체결강도변동성: 10틱 내 체결 강도 변동폭을 평균으로 정규화(%) 계산
  체결강도변동성 = (최고체결강도(10) - 최저체결강도(10)) / 체결강도평균(10) * 100 if 체결강도평균(10) != 0 else 0
  ```

### 1.16 전일비가속도 (float)
- **설명**: 전일 대비 거래량 비율의 틱 간 변화율. 거래량 급증 속도를 측정.
- **활용**: 거래량 폭발(20% 이상) 시 매수, 둔화(-10% 이하) 시 매도.
- **코드**:
  ```python
  # 전일비가속도: 전일비의 틱 간 변화율(%) 계산
  전일비가속도 = (전일비 - 전일비N(1)) / 전일비N(1) * 100 if 전일비N(1) != 0 else 0
  ```

### 1.17 장초등락폭 (float)
- **설명**: 시가 대비 현재가 등락률. 장 초반 가격 변동 크기를 측정.
- **활용**: 상승 강도(2% 이상) 시 매수.
- **코드**:
  ```python
  # 장초등락폭: 시가 대비 현재가의 등락률(%) 계산
  장초등락폭 = (현재가 - 시가) / 시가 * 100
  ```

### 1.18 매도잔량압력 (float)
- **설명**: 매도 총 잔량을 초당 매도 수량으로 나눈 값. 매도 잔량 소화 속도를 측정.
- **활용**: 매도 압력 증가(15 이상) 시 매도.
- **코드**:
  ```python
  # 매도잔량압력: 매도 총 잔량을 초당 매도 수량으로 나눔
  매도잔량압력 = 매도총잔량 / 초당매도수량 if 초당매도수량 != 0 else 0
  ```

### 1.19 거래량급증비율 (float)
- **설명**: 초당 거래대금이 직전 틱 대비 증가한 비율. 거래량 폭발을 감지.
- **활용**: 거래량 급증(200% 이상) 시 매도.
- **코드**:
  ```python
  # 거래량급증비율: 거래대금의 급격한 증가율(%) 계산
  거래량급증비율 = (초당거래대금 - 초당거래대금N(1)) / 초당거래대금N(1) * 100 if 초당거래대금N(1) != 0 else 0
  ```

## 2. 매수 전략

### 2.1 "장초 매수압력 급등 전략"
- **목표**: 매수 세력이 강하게 유입되며 변동성이 증가하는 순간 포착.
- **조건**: 시분초 >= 90000 and 시분초 <= 93000, 초당순매수비율 > 60, 호가압력지수 > 20, 단기변동성 > 2, 거래대금가속도 > 50, 현재가 > 이동평균(10).
- **코드**:
  ```python
  초당순매수비율 = 초당매수수량 / (초당매수수량 + 초당매도수량) * 100 if (초당매수수량 + 초당매도수량) != 0 else 0
  호가압력지수 = (매수총잔량 - 매도총잔량) / (매수총잔량 + 매도총잔량) * 100 if (매수총잔량 + 매도총잔량) != 0 else 0
  단기변동성 = (최고현재가(10) - 최저현재가(10)) / 최저현재가(10) * 100
  거래대금가속도 = (초당거래대금 - 초당거래대금N(1)) / 초당거래대금N(1) * 100 if 초당거래대금N(1) != 0 else 0

  매수 = True

  if not (시분초 >= 90000 and 시분초 <= 93000):
      매수 = False
  elif not (초당순매수비율 > 60):
      매수 = False
  elif not (호가압력지수 > 20):
      매수 = False
  elif not (단기변동성 > 2):
      매수 = False
  elif not (거래대금가속도 > 50):
      매수 = False
  elif not (현재가 > 이동평균(10)):
      매수 = False
  ```

### 2.2 "장초 지지 후 돌파 전략"
- **목표**: 지지 형성 후 고가 돌파 시 매수.
- **조건**: 시분초 >= 90000 and 시분초 <= 93000, 매수호가밀도 > 100, 현재가 > 최고현재가(300), 등락율각도(10) > 5, 체결강도평균(5) > 150.
- **코드**:
  ```python
  매수호가밀도 = (매수잔량1 + 매수잔량2 + 매수잔량3) / (매수호가1 - 매수호가3) if (매수호가1 - 매수호가3) != 0 else 0

  매수 = True

  if not (시분초 >= 90000 and 시분초 <= 93000):
      매수 = False
  elif not (매수호가밀도 > 100):
      매수 = False
  elif not (현재가 > 최고현재가(300)):
      매수 = False
  elif not (등락율각도(10) > 5):
      매수 = False
  elif not (체결강도평균(5) > 150):
      매수 = False
  ```

### 2.3 "장초 체결강도 급등 전략"
- **목표**: 체결 강도가 급격히 증가하며 매수 세력이 강해질 때 진입.
- **조건**: 시분초 >= 90000 and 시분초 <= 93000, 체결강도가속도 > 20, 초당매수수량 > 초당매도수량 * 2, 호가간격비율 <= 1.5, 등락율각도(5) > 5.
- **코드**:
  ```python
  체결강도가속도 = (체결강도 - 체결강도N(1)) / 체결강도N(1) * 100 if 체결강도N(1) != 0 else 0
  호가간격비율 = (매도호가1 - 매수호가1) / 호가단위

  매수 = True

  if not (시분초 >= 90000 and 시분초 <= 93000):
      매수 = False
  elif not (체결강도가속도 > 20):
      매수 = False
  elif not (초당매수수량 > 초당매도수량 * 2):
      매수 = False
  elif not (호가간격비율 <= 1.5):
      매수 = False
  elif not (등락율각도(5) > 5):
      매수 = False
  ```

### 2.4 "장초 거래량 집중 돌파 전략"
- **목표**: 거래대금이 집중되며 고가를 돌파할 때 진입.
- **조건**: 시분초 >= 90000 and 시분초 <= 93000, 누적거래대금비율 > 5, 현재가 > 최고현재가(300), 매수잔량증가율 > 30, 장초고저폭 > 3.
- **코드**:
  ```python
  누적거래대금비율 = 당일거래대금 / (시가총액 * 회전율 / 100) * 100 if (시가총액 * 회전율 / 100) != 0 else 0
  매수잔량증가율 = (매수총잔량 - 매수총잔량N(1)) / 매수총잔량N(1) * 100 if 매수총잔량N(1) != 0 else 0
  장초고저폭 = (고가 - 저가) / 시가 * 100

  매수 = True

  if not (시분초 >= 90000 and 시분초 <= 93000):
      매수 = False
  elif not (누적거래대금비율 > 5):
      매수 = False
  elif not (현재가 > 최고현재가(300)):
      매수 = False
  elif not (매수잔량증가율 > 30):
      매수 = False
  elif not (장초고저폭 > 3):
      매수 = False
  ```

### 2.5 "장초 초기 추세 돌파 전략"
- **목표**: 단기 이동평균 기울기가 상승하며 호가 균형이 매수로 기울 때 진입.
- **조건**: 시분초 >= 90000 and 시분초 <= 93000, 이동평균기울기 > 0.5, 호가균형지수 > 120, 초당거래대금 > 초당거래대금평균(10) * 1.5, 장초등락폭 > 2.
- **코드**:
  ```python
  이동평균기울기 = (이동평균(5) - 이동평균(5, 1)) / 이동평균(5, 1) * 100 if 이동평균(5, 1) != 0 else 0
  호가균형지수 = (매수잔량1 + 매수잔량2) / (매도잔량1 + 매도잔량2) * 100 if (매도잔량1 + 매도잔량2) != 0 else 0
  장초등락폭 = (현재가 - 시가) / 시가 * 100

  매수 = True

  if not (시분초 >= 90000 and 시분초 <= 93000):
      매수 = False
  elif not (이동평균기울기 > 0.5):
      매수 = False
  elif not (호가균형지수 > 120):
      매수 = False
  elif not (초당거래대금 > 초당거래대금평균(10) * 1.5):
      매수 = False
  elif not (장초등락폭 > 2):
      매수 = False
  ```

### 2.6 "장초 거래량 폭발 전략"
- **목표**: 전일 대비 거래량 폭발과 체결 강도 안정 시 매수.
- **조건**: 시분초 >= 90000 and 시분초 <= 93000, 전일비가속도 > 20, 체결강도변동성 < 50, 현재가 > 최고현재가(180), 매도잔량압력 < 10.
- **코드**:
  ```python
  전일비가속도 = (전일비 - 전일비N(1)) / 전일비N(1) * 100 if 전일비N(1) != 0 else 0
  체결강도변동성 = (최고체결강도(10) - 최저체결강도(10)) / 체결강도평균(10) * 100 if 체결강도평균(10) != 0 else 0
  매도잔량압력 = 매도총잔량 / 초당매도수량 if 초당매도수량 != 0 else 0

  매수 = True

  if not (시분초 >= 90000 and 시분초 <= 93000):
      매수 = False
  elif not (전일비가속도 > 20):
      매수 = False
  elif not (체결강도변동성 < 50):
      매수 = False
  elif not (현재가 > 최고현재가(180)):
      매수 = False
  elif not (매도잔량압력 < 10):
      매수 = False
  ```

### 2.7 "장초 상방 돌파 극초단타 전략"
- **목표**: 매수 세력 급증과 단기 고가 돌파 시 진입.
- **조건**: 시분초 >= 90000 and 시분초 <= 93000, 초당순매수비율 > 60, 체결강도가속도 > 20, 단기변동성 > 2, 호가압력지수 > 20, 이동평균기울기 > 0.5, 장초고저폭 > 3.
- **코드**:
  ```python
  초당순매수비율 = 초당매수수량 / (초당매수수량 + 초당매도수량) * 100 if (초당매수수량 + 초당매도수량) != 0 else 0
  체결강도가속도 = (체결강도 - 체결강도N(1)) / 체결강도N(1) * 100 if 체결강도N(1) != 0 else 0
  단기변동성 = (최고현재가(10) - 최저현재가(10)) / 최저현재가(10) * 100
  호가압력지수 = (매수총잔량 - 매도총잔량) / (매수총잔량 + 매도총잔량) * 100 if (매수총잔량 + 매도총잔량) != 0 else 0
  이동평균기울기 = (이동평균(5) - 이동평균(5, 1)) / 이동평균(5, 1) * 100 if 이동평균(5, 1) != 0 else 0
  장초고저폭 = (고가 - 저가) / 시가 * 100

  매수 = True

  if not (시분초 >= 90000 and 시분초 <= 93000):
      매수 = False
  elif not (초당순매수비율 > 60):
      매수 = False
  elif not (체결강도가속도 > 20):
      매수 = False
  elif not (단기변동성 > 2):
      매수 = False
  elif not (호가압력지수 > 20):
      매수 = False
  elif not (이동평균기울기 > 0.5):
      매수 = False
  elif not (장초고저폭 > 3):
      매수 = False
  ```

### 2.8 "장초 매수 세력 급증 돌파 전략"
- **목표**: 매수 세력 급증과 단기 고가 돌파 시 진입.
- **조건**: 시분초 >= 90000 and 시분초 <= 93000, 초당매수수량 > 초당매도수량 * 2, 체결강도 > 150, 현재가 > 최고현재가(10), 초당거래대금 > 초당거래대금N(1) * 1.5, 매수총잔량 > 매도총잔량 * 1.5, 등락율각도(5) > 5.
- **코드**:
  ```python
  매수 = True

  if not (시분초 >= 90000 and 시분초 <= 93000):
      매수 = False
  elif not (초당매수수량 > 초당매도수량 * 2):
      매수 = False
  elif not (체결강도 > 150):
      매수 = False
  elif not (현재가 > 최고현재가(10)):
      매수 = False
  elif not (초당거래대금 > 초당거래대금N(1) * 1.5):
      매수 = False
  elif not (매수총잔량 > 매도총잔량 * 1.5):
      매수 = False
  elif not (등락율각도(5) > 5):
      매수 = False
  ```

## 3. 매도 전략

### 3.1 "빠른 익절 및 손절 전략"
- **목표**: 수익 확보 및 손실 최소화.
- **조건**: 수익률 > 0.7, 수익률 < -0.5, 보유시간 > 60, 호가압력지수 < -20, 등락율각도(5) < -5.
- **코드**:
  ```python
  호가압력지수 = (매수총잔량 - 매도총잔량) / (매수총잔량 + 매도총잔량) * 100 if (매수총잔량 + 매도총잔량) != 0 else 0

  매도 = False

  if 수익률 > 0.7:
      매도 = True
  elif 수익률 < -0.5:
      매도 = True
  elif 보유시간 > 60:
      매도 = True
  elif 호가압력지수 < -20:
      매도 = True
  elif 등락율각도(5) < -5:
      매도 = True
  ```

### 3.2 "지지 붕괴 매도 전략"
- **목표**: 지지 붕괴 시 빠른 손절.
- **조건**: 현재가 < 최저현재가(10), 매수호가밀도 < 50, 초당순매수비율 < 40.
- **코드**:
  ```python
  초당순매수비율 = 초당매수수량 / (초당매수수량 + 초당매도수량) * 100 if (초당매수수량 + 초당매도수량) != 0 else 0
  매수호가밀도 = (매수잔량1 + 매수잔량2 + 매수잔량3) / (매수호가1 - 매수호가3) if (매수호가1 - 매수호가3) != 0 else 0

  매도 = False

  if 현재가 < 최저현재가(10):
      매도 = True
  elif 매수호가밀도 < 50:
      매도 = True
  elif 초당순매수비율 < 40:
      매도 = True
  ```

### 3.3 "장초 모멘텀 약화 매도 전략"
- **목표**: 상승 모멘텀 약화 시 이탈.
- **조건**: 수익률 > 1, 수익률 < -0.5, 보유시간 > 60, 체결강도가속도 < -20, RSI변화율 < -10.
- **코드**:
  ```python
  체결강도가속도 = (체결강도 - 체결강도N(1)) / 체결강도N(1) * 100 if 체결강도N(1) != 0 else 0
  RSI변화율 = (RSI - RSI_N(1)) / RSI_N(1) * 100 if RSI_N(1) != 0 else 0

  매도 = False

  if 수익률 > 1:
      매도 = True
  elif 수익률 < -0.5:
      매도 = True
  elif 보유시간 > 60:
      매도 = True
  elif 체결강도가속도 < -20:
      매도 = True
  elif RSI변화율 < -10:
      매도 = True
  ```

### 3.4 "장초 호가 이격 매도 전략"
- **목표**: 호가 간격 벌어짐 시 매도.
- **조건**: 호가간격비율 > 2, 매수잔량증가율 < -20, 현재가 < 이동평균(10).
- **코드**:
  ```python
  호가간격비율 = (매도호가1 - 매수호가1) / 호가단위
  매수잔량증가율 = (매수총잔량 - 매수총잔량N(1)) / 매수총잔량N(1) * 100 if 매수총잔량N(1) != 0 else 0

  매도 = False

  if 호가간격비율 > 2:
      매도 = True
  elif 매수잔량증가율 < -20:
      매도 = True
  elif 현재가 < 이동평균(10):
      매도 = True
  ```

### 3.5 "장초 추세 약화 매도 전략"
- **목표**: 단기 추세 약화 시 이탈.
- **조건**: 수익률 > 1, 수익률 < -0.5, 보유시간 > 60, 이동평균기울기 < -0.5, 호가균형지수 < 80.
- **코드**:
  ```python
  이동평균기울기 = (이동평균(5) - 이동평균(5, 1)) / 이동평균(5, 1) * 100 if 이동평균(5, 1) != 0 else 0
  호가균형지수 = (매수잔량1 + 매수잔량2) / (매도잔량1 + 매도잔량2) * 100 if (매도잔량1 + 매도잔량2) != 0 else 0

  매도 = False

  if 수익률 > 1:
      매도 = True
  elif 수익률 < -0.5:
      매도 = True
  elif 보유시간 > 60:
      매도 = True
  elif 이동평균기울기 < -0.5:
      매도 = True
  elif 호가균형지수 < 80:
      매도 = True
  ```

### 3.6 "장초 매도 압력 증가 매도 전략"
- **목표**: 매도 잔량 압력 증가 시 매도.
- **조건**: 매도잔량압력 > 15, 전일비가속도 < -10, 현재가 < 최저현재가(10).
- **코드**:
  ```python
  전일비가속도 = (전일비 - 전일비N(1)) / 전일비N(1) * 100 if 전일비N(1) != 0 else 0
  매도잔량압력 = 매도총잔량 / 초당매도수량 if 초당매도수량 != 0 else 0

  매도 = False

  if 매도잔량압력 > 15:
      매도 = True
  elif 전일비가속도 < -10:
      매도 = True
  elif 현재가 < 최저현재가(10):
      매도 = True
  ```

### 3.7 "상방 유지 및 하방 이탈 관리 전략"
- **목표**: 상방 돌파 유지 및 하방 이탈 관리.
- **조건**: 수익률 > 0.7, 수익률 < -0.3, 보유시간 > 30, 호가간격비율 > 2, 매도잔량압력 > 15, 체결강도변동성 > 50, RSI변화율 < -10.
- **코드**:
  ```python
  호가간격비율 = (매도호가1 - 매수호가1) / 호가단위
  매도잔량압력 = 매도총잔량 / 초당매도수량 if 초당매도수량 != 0 else 0
  체결강도변동성 = (최고체결강도(10) - 최저체결강도(10)) / 체결강도평균(10) * 100 if 체결강도평균(10) != 0 else 0
  RSI변화율 = (RSI - RSI_N(1)) / RSI_N(1) * 100 if RSI_N(1) != 0 else 0

  매도 = False

  if 수익률 > 0.7:
      매도 = True
  elif 수익률 < -0.3:
      매도 = True
  elif 보유시간 > 30:
      매도 = True
  elif 호가간격비율 > 2:
      매도 = True
  elif 매도잔량압력 > 15:
      매도 = True
  elif 체결강도변동성 > 50:
      매도 = True
  elif RSI변화율 < -10:
      매도 = True
  ```

### 3.8 "현재가-최저가 기반 하방 이탈 전략"
- **목표**: 단기 지지 붕괴 및 매도 압력 증가 시 매도.
- **조건**: 수익률 > 0.7, 수익률 < -0.3, 보유시간 > 30, 현재가 < 최저현재가(10), 매도잔량압력 > 15, 호가간격비율 > 2.
- **코드**:
  ```python
  호가간격비율 = (매도호가1 - 매수호가1) / 호가단위
  매도잔량압력 = 매도총잔량 / 초당매도수량 if 초당매도수량 != 0 else 0

  매도 = False

  if 수익률 > 0.7:
      매도 = True
  elif 수익률 < -0.3:
      매도 = True
  elif 보유시간 > 30:
      매도 = True
  elif 현재가 < 최저현재가(10):
      매도 = True
  elif 매도잔량압력 > 15:
      매도 = True
  elif 호가간격비율 > 2:
      매도 = True
  ```

### 3.9 "지지선 붕괴 및 매도 압력 증가 전략"
- **목표**: 지지선 붕괴 및 매도 세력 강화 시 빠른 이탈.
- **조건**: 수익률 > 0.7, 수익률 < -0.3, 보유시간 > 30, 현재가 < 최저현재가(10), 매도총잔량 > 매수총잔량 * 2, 초당매도수량 > 초당매수수량 * 2, 등락율각도(5) < -5.
- **코드**:
  ```python
  매도 = False

  if 수익률 > 0.7:
      매도 = True
  elif 수익률 < -0.3:
      매도 = True
  elif 보유시간 > 30:
      매도 = True
  elif 현재가 < 최저현재가(10):
      매도 = True
  elif 매도총잔량 > 매수총잔량 * 2:
      매도 = True
  elif 초당매도수량 > 초당매수수량 * 2:
      매도 = True
  elif 등락율각도(5) < -5:
      매도 = True
  ```

### 3.10 "거래량 급증 매도 전략"
- **목표**: 거래량 폭발로 추세 소진 시 매도.
- **조건**: 수익률 > 0.7, 수익률 < -0.3, 보유시간 > 30, 거래량급증비율 > 200.
- **코드**:
  ```python
  거래량급증비율 = (초당거래대금 - 초당거래대금N(1)) / 초당거래대금N(1) * 100 if 초당거래대금N(1) != 0 else 0

  매도 = False

  if 수익률 > 0.7:
      매도 = True
  elif 수익률 < -0.3:
      매도 = True
  elif 보유시간 > 30:
      매도 = True
  elif 거래량급증비율 > 200:
      매도 = True
  ```

## 4. 기대 효과 및 최적화

- **매수 전략**: 매수 세력 급증, 거래량 폭발, 단기 돌파를 포착하여 평균 승률 70~80%, 수익률 0.7~1.5% 목표.
- **매도 전략**: 빠른 익절(0.7~1%)과 손절(-0.3~-0.5%), 하방 이탈 관리로 손익비 2:1 이상 유지.
- **최적화**:
  - 틱 수 조정: 최저현재가(10) → 5~15틱 테스트.
  - 임계값 변경: 초당순매수비율 > 60 → 50~70 테스트.
  - 백테스트: 09:00~09:30 데이터로 승률 및 손익비 검증.

## 5. 결론

이 보고서는 장 초반 극초단타 매매를 위한 19개의 새로운 변수와 8개의 매수 전략, 10개의 매도 전략을 제시합니다. STOM 프로그램에서 실시간 틱 데이터를 활용하여 상방 돌파와 하방 이탈을 정밀하게 관리하면 높은 성공률과 안정적인 수익을 기대할 수 있습니다. 백테스트와 실전 검증을 통해 조건을 미세 조정하면 최적의 장초 전략을 완성할 수 있습니다.

**작성일**: 2025-02-26

**면책 조항**: Grok은 재무 고문이 아닙니다. 전문가와 상담하세요.

## 조건식 개선 방향 연구

### 1. 추가 지표 활용 연구

**우선순위: 높음**
- **호가창 두께 분석 추가**
  - 매수/매도 잔량 비율을 통한 지지/저항 강도 측정
  - 얇은 호가창 종목 필터링으로 급등락 리스크 감소
  - 구현 난이도: 낮음

- **거래대금 가속도 측정**
  - 1차 미분, 2차 미분 계산으로 거래량 가속 감지
  - 가속도가 양수일 때 매수 신호 강화
  - 구현 난이도: 중

### 2. 시간대별 전략 세분화 연구

**우선순위: 높음**
- **장 초반/중반/후반 조건 차등 적용**
  - 09:00-09:30: 갭 상승 전략 강화
  - 10:00-14:00: 모멘텀 추종 전략
  - 14:30-15:00: 단기 스캘핑 전략
  - 구현 난이도: 중

### 3. 매도 조건 고도화 연구

**우선순위: 높음**
- **동적 손절/익절 시스템**
  - 변동성 기반 손절폭 조정 (ATR 활용)
  - 트레일링 스톱 최적화
  - 구현 난이도: 중

- **부분 매도 전략**
  - 목표가 1차 도달 시 50% 매도
  - 나머지 50%는 트레일링 스톱 적용
  - 구현 난이도: 낮음

### 4. 리스크 관리 강화 연구

**우선순위: 높음**
- **허위 급등 필터링**
  - 급증 후 N초 지속 여부 확인
  - 일시적 스파이크 제거
  - 구현 난이도: 낮음

- **라운드 피겨 회피 강화**
  - 심리적 저항선 근처 진입 제한
  - 돌파 확인 후 진입
  - 구현 난이도: 낮음

### 5. 최적화 전략 개선 연구

**우선순위: 중간**
- **시가총액별 파라미터 세분화**
  - 초소형주 (1000억 미만) 별도 조건
  - 대형주 (1조 이상) 별도 조건
  - 구현 난이도: 중

- **백테스팅 기간 확대**
  - 다양한 시장 국면 반영
  - 과적합 방지
  - 구현 난이도: 낮음

### 구현 우선순위

1. **1단계 (즉시 구현)**:
   - 허위 급등 필터링
   - 호가창 두께 분석
   - 부분 매도 전략

2. **2단계 (1개월 내)**:
   - 거래대금 가속도 측정
   - 동적 손절/익절 시스템
   - 시간대별 전략 세분화

3. **3단계 (3개월 내)**:
   - 시가총액별 파라미터 세분화
   - 백테스팅 기간 확대
   - 복합 지표 개발

