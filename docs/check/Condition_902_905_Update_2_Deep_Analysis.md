# Condition_Tick_902_905_Update_2 심층 분석 보고서

## 1. 현재 조건식 분석

### 1.1 전략 개요

**대상 시간**: 09:00:00 ~ 09:05:00 (장 시작 5분)
- 902 전략: 09:00:00 ~ 09:02:00
- 905 전략: 09:02:00 ~ 09:05:00

**핵심 변수**: 체결강도, 초당거래대금, 회전율, 당일거래대금각도

**Update 2 변경사항**:
- 체결강도 하한값: 100 → 50 완화
- 회전율 조건 명확화
- 당일거래대금각도 강화: 1 → 5

### 1.2 매수 조건 분석

#### 902 전략 (시가총액 < 3000억) 조건 개수: 13개

```python
# 1. 가격 범위: 1000 < 현재가 <= 50000
# 2. 등락율: 1.0 < 등락율 <= 8.0
# 3. 고저평균대비등락율 > 0
# 4. VI 조건: 현재가 < VI아래5호가
# 5. 라운드피겨 회피
# 6. 시가등락율: 2.0 <= 시가등락율 < 4.0
# 7. 시가대비등락율: 0.5 <= 시가대비등락율 < 6.0
# 8. 초당순매수금액: 1 < 초당순매수금액 < 1000
# 9. 고가대비위치: 현재가 > (고가 - (고가 - 저가) * 0.20)
# 10. 전일비 > 0 and 전일동시간비 > 0
# 11. 회전율 > 2
# 12. 당일거래대금 > 500 (5 * 100)
# 13. 당일거래대금각도(30): 5 < 각도 < 30
# 14. 초당거래대금 비율 > 3.0
# 15. 초당매수수량 > 매도총잔량 * 0.20
# 16. 매도/매수총잔량 비율 조건
# 17. 체결강도: 50 <= 체결강도 <= 300
```

**문제점**:
1. **조건이 너무 많음** (17개) → 진입 기회 극소
2. **범위가 너무 좁음** → 과적합 위험
3. **상충되는 조건** → 등락율각도 강화(1→5)가 오히려 기회 감소

#### 905 전략 (시가총액 < 3000억) 조건 개수: 14개

유사한 구조이나 더 강화된 조건:
- 등락율: 2.0 < 등락율 <= 15.0 (더 넓음)
- 시가대비등락율: 3.0 <= 시가대비등락율 < 8.0 (더 높음)
- 추가 조건: 누적초당매수/매도수량 비율

### 1.3 최적화 범위 분석

#### 문제점 1: 변수가 너무 많음 (24개)

```python
# 매수 변수: 24개
# 매도 변수: 7개
# 총 경우의 수: 74,649,600,000
# 예상 시간: 142,027년 (비현실적)
```

#### 문제점 2: 범위가 일부 너무 좁음

```python
# 예시: 체결강도 하한
self.vars[10] = [[40, 60, 10], 50]  # 3개 값만 (40, 50, 60)
# → 너무 적음, 30~70으로 확대 필요

# 예시: 회전율
self.vars[6] = [[1.5, 3.0, 0.5], 2.0]  # 4개 값
# → 1.0~4.0으로 확대 필요
```

#### 문제점 3: 간격이 일정하지 않음

일부 변수는 0.5 간격, 일부는 2.0 간격 → 일관성 부족

### 1.4 진단 요약

**성과가 좋지 않은 이유**:

1. **과도한 필터링**: 17개 조건을 모두 만족하는 종목 거의 없음
2. **과적합**: 범위가 너무 좁아 특정 시장 상황에만 작동
3. **상충 조건**: 일부 조건이 서로 모순 (예: 등락율각도 강화 vs 진입 기회 확대)
4. **유연성 부족**: 시장 변동성에 따른 적응력 없음

---

## 2. 변수별 심층 연구

### 2.1 체결강도 (Execution Strength)

#### 특성
- **정의**: (매수수량 / 매도수량) × 100
- **범위**: 0 ~ 500 (일반적으로 50 ~ 200 사용)
- **의미**:
  - < 100: 매도세 우위
  - 100: 균형
  - \> 100: 매수세 우위
  - \> 150: 강한 매수세

#### 사용 방법

**기본 사용**:
```python
if 체결강도 >= 120:  # 매수세 우위 확인
    매수 = True
```

**구간 평균과 조합**:
```python
if 체결강도 >= 100 and 체결강도평균(30) > 110:
    매수 = True  # 지속적인 매수세
```

**변화율 감지**:
```python
if 체결강도 > 체결강도N(1) * 1.2:
    매수 = True  # 체결강도 급증 (20%)
```

#### 범위별 의미

| 체결강도 | 의미 | 전략 |
|---------|------|------|
| < 50 | 강한 매도세 | 진입 금지 |
| 50-80 | 약한 매도세 | 신중한 진입 |
| 80-120 | 중립~약한 매수세 | 조건부 진입 |
| 120-180 | 강한 매수세 | 적극 진입 |
| 180-300 | 매우 강한 매수세 | 최적 진입 |
| > 300 | 과열 위험 | 진입 제한 |

#### 최적화 범위 권장

```python
# 현재 (너무 좁음)
self.vars[10] = [[40, 60, 10], 50]  # 3개 값: [40, 50, 60]

# 권장 (탐색적)
self.vars[10] = [[30, 70, 10], 50]  # 5개 값: [30, 40, 50, 60, 70]
# 또는
self.vars[10] = [[50, 150, 20], 100]  # 6개 값: [50, 70, 90, 110, 130, 150]

# 정밀 최적화 (2단계)
self.vars[10] = [[80, 120, 10], 100]  # 1단계 결과가 100 근처라면
```

#### 조합 전략

**패턴 1: 체결강도 + 체결강도평균**
```python
if 체결강도 >= 120 and 체결강도평균(30) > 110:
    매수 = True  # 지속적인 강세
```

**패턴 2: 체결강도 + 초당매수수량**
```python
if 체결강도 >= 130 and 초당매수수량 > 매도총잔량 * 0.3:
    매수 = True  # 강한 매수세 + 호가 돌파력
```

**패턴 3: 체결강도 급증 포착**
```python
if 체결강도 > 최고체결강도(30, 1) * 0.8 and 체결강도 > 체결강도N(1) * 1.15:
    매수 = True  # 최근 고점 근처 + 급증
```

### 2.2 초당거래대금 (Per-Second Trading Value)

#### 특성
- **정의**: 1초 동안의 거래대금 누적
- **단위**: 백만원
- **의미**: 거래 활성도 및 유동성 지표

#### 범위별 의미

| 초당거래대금 | 종목 특성 | 전략 |
|------------|----------|------|
| < 10 | 저유동성 | 진입 위험 |
| 10-50 | 일반 유동성 | 조건부 진입 |
| 50-100 | 높은 유동성 | 좋은 환경 |
| 100-500 | 매우 높음 | 최적 환경 |
| > 500 | 과열 가능성 | 신중 진입 |

#### 사용 방법

**기본 비율 비교**:
```python
# 현재 조건 (너무 엄격)
if 초당거래대금 / 초당거래대금평균(30) > 3.0:
    매수 = True

# 권장 (완화)
if 초당거래대금 / 초당거래대금평균(30) > 2.0:
    매수 = True
```

**절대값 + 비율 조합**:
```python
# 최소 절대값 확보 + 평균 대비 증가
if 초당거래대금 > 50 and 초당거래대금 / 초당거래대금평균(30) > 1.5:
    매수 = True
```

**가속도 측정** (고급):
```python
# 1차 미분: 변화율
거래대금변화율 = (초당거래대금 - 초당거래대금N(1)) / 초당거래대금N(1) * 100

if 거래대금변화율 > 20:  # 20% 이상 증가
    매수 = True
```

#### 최적화 범위 권장

```python
# 현재 (비율만 사용)
self.vars[8] = [[2.5, 4.0, 0.5], 3.0]  # 비율: [2.5, 3.0, 3.5, 4.0]

# 권장 1: 범위 확대
self.vars[8] = [[1.5, 4.0, 0.5], 2.5]  # 비율: [1.5, 2.0, 2.5, 3.0, 3.5, 4.0]

# 권장 2: 절대값 범위 추가 (별도 변수)
self.vars[32] = [[30, 100, 10], 50]  # 절대값: [30, 40, 50, 60, 70, 80, 90, 100]
```

### 2.3 회전율 (Turnover Ratio)

#### 특성
- **정의**: (당일거래량 / 상장주식수) × 100
- **의미**: 주식 유통 활발도

#### 범위별 의미

| 회전율 | 의미 | 트레이딩 환경 |
|--------|------|--------------|
| < 1.0 | 매우 낮음 | 부적합 (유동성 부족) |
| 1.0-2.0 | 낮음 | 조건부 진입 |
| 2.0-5.0 | 적정 | 좋은 환경 |
| 5.0-10.0 | 높음 | 최적 환경 |
| > 10.0 | 매우 높음 | 과열 주의 |

#### 사용 방법

**기본 필터**:
```python
# 현재 (너무 엄격)
if 회전율 > 2.0:  # 902 전략
    매수 = True

# 권장 (완화)
if 회전율 > 1.5 or (회전율 > 1.0 and 전일비 > 150):
    매수 = True  # 회전율 또는 전일비로 보완
```

**시가총액별 차등**:
```python
if 시가총액 < 1000:  # 초소형주
    if 회전율 > 3.0:  # 높은 회전율 요구
        매수 = True
elif 시가총액 < 3000:  # 소형주
    if 회전율 > 2.0:
        매수 = True
else:  # 중대형주
    if 회전율 > 1.0:  # 낮은 회전율로 진입 가능
        매수 = True
```

#### 최적화 범위 권장

```python
# 현재 (너무 좁음)
self.vars[6] = [[1.5, 3.0, 0.5], 2.0]  # [1.5, 2.0, 2.5, 3.0]

# 권장 (확대)
self.vars[6] = [[1.0, 4.0, 0.5], 2.0]  # [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]

# 또는 더 넓게
self.vars[6] = [[0.5, 5.0, 0.5], 2.0]  # [0.5, 1.0, ..., 5.0] → 10개 값
```

### 2.4 당일거래대금각도 (Intraday Trading Value Angle)

#### 특성
- **정의**: `atan((당일거래대금 - 당일거래대금N(구간)) / 구간) × 180 / π`
- **범위**: 0 ~ 90도
- **의미**: 거래대금 증가 추세의 가파름

#### 범위별 의미

| 각도 | 의미 | 추세 |
|------|------|------|
| 0-3 | 완만한 상승 | 약한 추세 |
| 3-10 | 보통 상승 | 적정 추세 |
| 10-20 | 가파른 상승 | 강한 추세 |
| 20-45 | 매우 가파른 상승 | 매우 강한 추세 |
| > 45 | 급등 | 과열 위험 |

#### 사용 방법

**현재 조건 (너무 엄격)**:
```python
# 902 전략
if 당일거래대금각도(30) > 5 and 당일거래대금각도(30) < 30:
    매수 = True

# 문제: 5도 미만은 모두 제외 → 기회 손실
```

**권장 (완화)**:
```python
# 방법 1: 하한 완화
if 당일거래대금각도(30) > 3 and 당일거래대금각도(30) < 40:
    매수 = True

# 방법 2: 조건 분리
if 당일거래대금각도(30) > 8:  # 상한 조건만
    매수 = True

# 방법 3: 등락율각도와 조합
if (당일거래대금각도(30) > 3 or 등락율각도(30) > 5):
    매수 = True  # OR 조건으로 기회 확대
```

#### 최적화 범위 권장

```python
# 현재 (너무 좁음)
self.vars[7] = [[3, 7, 2], 5]  # [3, 5, 7] → 3개 값

# 권장 (확대)
self.vars[7] = [[1, 15, 2], 5]  # [1, 3, 5, 7, 9, 11, 13, 15] → 8개 값

# 또는 더 세밀하게
self.vars[7] = [[2, 12, 1], 5]  # [2, 3, 4, ..., 12] → 11개 값
```

#### 조합 전략

**패턴 1: 각도 + 절대값**
```python
if 당일거래대금각도(30) > 5 and 당일거래대금 > 1000:
    매수 = True  # 가파른 상승 + 충분한 거래대금
```

**패턴 2: 단기 + 장기 각도**
```python
if 당일거래대금각도(10) > 10 and 당일거래대금각도(30) > 5:
    매수 = True  # 단기 급등 + 중기 상승 추세
```

### 2.5 누적초당매수/매도수량

#### 특성
- **정의**: 구간 동안의 초당매수/매도수량 합계
- **의미**: 매수/매도 세력의 누적 강도

#### 사용 방법

**현재 조건 (905 전략)**:
```python
if 누적초당매수수량(30) * 0.5 < 누적초당매도수량(30) and \
   누적초당매도수량(30) < 누적초당매수수량(30):
    매수 = True
# 즉: 누적초당매수수량 * 0.5 < 누적초당매도수량 < 누적초당매수수량
# → 매수수량이 매도수량의 1~2배
```

**권장 (단순화)**:
```python
# 방법 1: 비율만 확인
if 누적초당매수수량(30) > 누적초당매도수량(30) * 1.2:
    매수 = True  # 매수가 매도보다 20% 많음

# 방법 2: 절대 차이
if 누적초당매수수량(30) - 누적초당매도수량(30) > 100000:
    매수 = True  # 순매수량이 10만주 이상
```

#### 최적화 범위 권장

```python
# 현재 (복잡)
self.vars[22] = [[0.4, 0.6, 0.1], 0.5]  # 하한 비율
self.vars[23] = [[0.8, 1.2, 0.2], 1.0]  # 상한 비율

# 권장 (단순화)
self.vars[22] = [[1.1, 2.0, 0.1], 1.3]  # 매수/매도 비율
# → [1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0] → 10개 값
```

### 2.6 등락율각도

#### 특성
- **정의**: `atan((등락율 - 등락율N(구간)) / 구간) × 180 / π`
- **범위**: -90 ~ 90도
- **의미**: 가격 상승/하락 추세의 가파름

#### 사용 방법

**매수 조건 (상승 각도)**:
```python
if 등락율각도(30) > 5:
    매수 = True  # 상승 추세
```

**매도 조건 (하락 각도)**:
```python
if 등락율각도(30) < -5:
    매도 = True  # 하락 전환
```

**구간별 차등**:
```python
if 시가총액 < 3000:
    if 등락율각도(30) > 5:  # 소형주는 가파른 상승 요구
        매수 = True
else:
    if 등락율각도(30) > 8:  # 대형주는 더 가파른 상승 요구
        매수 = True
```

### 2.7 시가등락율 / 시가대비등락율

#### 시가등락율 (Gap Ratio)
- **정의**: ((시가 - 전일종가) / 전일종가) × 100
- **의미**: 갭 상승/하락 정도

#### 시가대비등락율 (Intraday Change)
- **정의**: ((현재가 - 시가) / 시가) × 100
- **의미**: 시가 대비 추가 상승/하락

#### 조합 전략

**패턴 1: 갭 상승 + 추가 상승**
```python
# 902 전략 (현재 - 너무 엄격)
if 2.0 <= 시가등락율 < 4.0 and 0.5 <= 시가대비등락율 < 6.0:
    매수 = True

# 권장 (완화)
if 시가등락율 > 1.0 and 시가대비등락율 > 0.3:
    매수 = True  # 상한 조건 제거
```

**패턴 2: 갭 하락 + 반등**
```python
if 시가등락율 < -2.0 and 시가대비등락율 > 3.0:
    매수 = True  # 갭 하락 후 강한 반등
```

### 2.8 전일비 / 전일동시간비

#### 전일비
- **정의**: (당일거래량 / 전일거래량) × 100
- **의미**: 전일 대비 거래량 증가율

#### 전일동시간비
- **정의**: (당일 동시간 거래량 / 전일 동시간 거래량) × 100
- **의미**: 같은 시간대 비교 거래량

#### 사용 방법

**현재 조건 (너무 엄격)**:
```python
# 902 전략
if 전일비 > 0 and 전일동시간비 > 0:
    매수 = True  # 단순 증가만 확인

# 905 전략
if 전일비 > 5 and 전일동시간비 > 0:
    매수 = True
```

**권장 (의미 있는 증가)**:
```python
# 방법 1: 유의미한 증가
if 전일비 > 120 and 전일동시간비 > 150:
    매수 = True  # 20%, 50% 이상 증가

# 방법 2: 둘 중 하나만
if 전일비 > 200 or 전일동시간비 > 250:
    매수 = True  # OR 조건으로 기회 확대
```

---

## 3. 최적화 범위 설정 전략

### 3.1 현재 범위의 문제점

#### 문제 1: 변수가 너무 많음 (24개 매수 + 7개 매도)

**영향**:
- 총 경우의 수: 74,649,600,000
- 예상 시간: 142,027년 (비현실적)
- 과적합 위험

**해결 방안**:
1. **핵심 변수만 선택** (10개 이하)
2. **단계별 최적화**:
   - 1단계: 상위 5개 변수
   - 2단계: 나머지 5개 변수
   - 3단계: 전체 통합 검증

#### 문제 2: 범위가 너무 좁음

```python
# 예시 1: 체결강도 하한
self.vars[10] = [[40, 60, 10], 50]  # 3개 값: [40, 50, 60]
# → 너무 적음, 변화 감지 어려움

# 예시 2: 당일거래대금각도
self.vars[7] = [[3, 7, 2], 5]  # 3개 값: [3, 5, 7]
# → 1~15 범위로 확대 필요
```

#### 문제 3: 고정값이 많음

```python
# 고정값 예시
self.vars[4] = [[1, 1, 1], 1]  # 고정값 1
# → 최적화 의미 없음, 제거 가능
```

### 3.2 넓은 범위 설정 방법

#### 방법 1: 범위를 극단적으로 넓히기

**원리**: 특정 조건의 영향을 최소화하여 다른 변수의 효과 파악

```python
# 예시: 체결강도 영향 최소화
# 현재 (영향 큼)
self.vars[10] = [[40, 60, 10], 50]  # 40~60 범위

# 넓은 범위 (영향 최소화)
self.vars[10] = [[10, 500, 50], 50]  # 10~500 범위
# → [10, 60, 110, 160, 210, 260, 310, 360, 410, 460] → 10개 값
# → 거의 모든 경우를 포함하므로 필터링 효과 약화
```

**적용 예시**:
```python
# 902 전략 매수 조건 최적화 범위 (넓은 버전)

# 핵심 변수만 선택 (10개)
self.vars[0] = [[30], 30]  # 평균 틱수 (고정)

# 1. 등락율 (넓게)
self.vars[1] = [[1.0, 15.0, 2.0], 8.0]  # [1, 3, 5, 7, 9, 11, 13, 15] → 8개

# 2. 시가등락율 하한 (넓게)
self.vars[2] = [[0.5, 5.0, 0.5], 2.0]  # [0.5, 1.0, ..., 5.0] → 10개

# 3. 시가대비등락율 하한 (넓게)
self.vars[3] = [[0.0, 3.0, 0.5], 0.5]  # [0.0, 0.5, ..., 3.0] → 7개

# 4. 회전율 (넓게)
self.vars[4] = [[0.5, 5.0, 0.5], 2.0]  # [0.5, 1.0, ..., 5.0] → 10개

# 5. 당일거래대금각도 하한 (넓게)
self.vars[5] = [[1, 15, 2], 5]  # [1, 3, 5, 7, 9, 11, 13, 15] → 8개

# 6. 초당거래대금 비율 (넓게)
self.vars[6] = [[1.5, 5.0, 0.5], 3.0]  # [1.5, 2.0, ..., 5.0] → 8개

# 7. 초당매수수량 비율 (넓게)
self.vars[7] = [[0.1, 0.5, 0.05], 0.20]  # [0.1, 0.15, ..., 0.5] → 9개

# 8. 체결강도 하한 (넓게)
self.vars[8] = [[30, 150, 20], 50]  # [30, 50, 70, 90, 110, 130, 150] → 7개

# 9. 전일비 (넓게)
self.vars[9] = [[0, 300, 50], 50]  # [0, 50, 100, 150, 200, 250, 300] → 7개

# 10. 전일동시간비 (넓게)
self.vars[10] = [[0, 300, 50], 50]  # [0, 50, 100, 150, 200, 250, 300] → 7개

# 총 경우의 수: 8 × 10 × 7 × 10 × 8 × 8 × 9 × 7 × 7 × 7
#              = 약 3,520,512,000 (여전히 많지만 이전보다 훨씬 적음)
```

#### 방법 2: 조건을 생략하는 방법

**원리**: 특정 조건을 아예 제거하여 영향 파악

```python
# 예시: 라운드피겨 조건 무시
# 기존 코드
elif 라운드피겨위5호가이내:
    매수 = False

# 생략 (주석 처리)
# elif 라운드피겨위5호가이내:
#     매수 = False
```

**단계적 생략 전략**:
```python
# 1단계: 불필요한 조건 제거
# - 라운드피겨위5호가이내 (주석 처리)
# - 고저평균대비등락율 > 0 (거의 항상 참, 의미 없음)

# 2단계: 상한 조건 제거 (하한만 유지)
# 예시: 시가대비등락율 상한 제거
# 기존
if not (0.5 <= 시가대비등락율 < 6.0):
    매수 = False
# 수정
if not (시가대비등락율 >= 0.5):
    매수 = False

# 3단계: AND 조건을 OR로 변경
# 기존
if not (전일비 > 0 and 전일동시간비 > 0):
    매수 = False
# 수정
if not (전일비 > 50 or 전일동시간비 > 50):
    매수 = False  # 둘 중 하나만 만족해도 진입
```

#### 방법 3: 범위를 단계적으로 확장

**1단계: 넓은 범위로 탐색**
```python
# 체결강도 하한 (넓은 탐색)
self.vars[10] = [[20, 200, 20], 100]  # [20, 40, 60, ..., 200] → 10개
```

**2단계: 좁은 범위로 정밀 탐색** (1단계 결과가 80이라면)
```python
# 체결강도 하한 (정밀 탐색)
self.vars[10] = [[60, 100, 5], 80]  # [60, 65, 70, 75, 80, 85, 90, 95, 100] → 9개
```

**3단계: 최종 검증**
```python
# 체결강도 하한 (최종 검증)
self.vars[10] = [[75, 85, 2], 80]  # [75, 77, 79, 81, 83, 85] → 6개
```

### 3.3 단계별 최적화 전략

#### 단계 1: 탐색적 최적화 (Exploratory Optimization)

**목표**: 변수의 영향력 파악 및 대략적인 최적 범위 발견

**방법**:
1. **핵심 변수만 선택** (5~10개)
2. **넓은 범위 설정**
3. **간격을 크게** (빠른 탐색)

**예시 코드**:
```python
# 1단계: 핵심 5개 변수만 최적화
self.vars[0] = [[30], 30]  # 고정

# 1. 등락율
self.vars[1] = [[2.0, 15.0, 2.0], 8.0]  # [2, 4, 6, 8, 10, 12, 14] → 7개

# 2. 회전율
self.vars[2] = [[0.5, 4.0, 0.5], 2.0]  # [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0] → 8개

# 3. 당일거래대금각도
self.vars[3] = [[1, 15, 2], 5]  # [1, 3, 5, 7, 9, 11, 13, 15] → 8개

# 4. 초당거래대금 비율
self.vars[4] = [[1.5, 4.5, 0.5], 3.0]  # [1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5] → 7개

# 5. 체결강도 하한
self.vars[5] = [[30, 150, 20], 50]  # [30, 50, 70, 90, 110, 130, 150] → 7개

# 총 경우의 수: 7 × 8 × 8 × 7 × 7 = 21,952
# 예상 시간: 약 15일 (1경우/분 가정)
```

#### 단계 2: 정밀 최적화 (Refinement Optimization)

**목표**: 1단계 결과를 바탕으로 최적값 정밀 탐색

**방법**:
1. **1단계 결과의 ±20% 범위**
2. **간격을 작게** (정밀 탐색)
3. **추가 변수 포함** (5~10개 더)

**예시 코드**:
```python
# 가정: 1단계 결과
# - 등락율: 6.0
# - 회전율: 2.5
# - 당일거래대금각도: 7
# - 초당거래대금 비율: 2.5
# - 체결강도: 70

# 2단계: 정밀 탐색
self.vars[1] = [[5.0, 8.0, 0.5], 6.0]  # [5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0] → 7개
self.vars[2] = [[2.0, 3.0, 0.2], 2.5]  # [2.0, 2.2, 2.4, 2.6, 2.8, 3.0] → 6개
self.vars[3] = [[5, 9, 1], 7]  # [5, 6, 7, 8, 9] → 5개
self.vars[4] = [[2.0, 3.0, 0.2], 2.5]  # [2.0, 2.2, 2.4, 2.6, 2.8, 3.0] → 6개
self.vars[5] = [[60, 90, 5], 70]  # [60, 65, 70, 75, 80, 85, 90] → 7개

# 추가 변수 5개 (넓은 범위)
self.vars[6] = [[0.5, 5.0, 0.5], 2.0]  # 시가등락율 하한
self.vars[7] = [[0.0, 3.0, 0.5], 0.5]  # 시가대비등락율 하한
self.vars[8] = [[0.1, 0.3, 0.05], 0.20]  # 초당매수수량 비율
self.vars[9] = [[0, 200, 50], 50]  # 전일비
self.vars[10] = [[0, 200, 50], 50]  # 전일동시간비

# 총 경우의 수: 7 × 6 × 5 × 6 × 7 × 10 × 7 × 5 × 5 × 5 = 약 15,435,000
```

#### 단계 3: 검증 및 실전 적용 (Validation & Deployment)

**목표**: 과적합 방지 및 안정성 확인

**방법**:
1. **워크포워드 테스팅** (Out-of-Sample Test)
2. **다양한 시장 국면 검증**
3. **민감도 분석** (변수 ±10% 변화 시 성과 변화)
4. **실전 데이터 검증** (가장 최근 1개월 데이터)

**검증 체크리스트**:
```python
# 1. 과적합 체크
# - 백테스트 기간: 최소 1년 이상
# - Out-of-Sample 성과가 In-Sample의 80% 이상

# 2. 안정성 체크
# - 주요 변수 ±10% 변화 시 성과 변화 < 20%
# - 예시: 체결강도 70 → 63~77 범위에서 성과 유사

# 3. 시장 국면 체크
# - 상승장, 하락장, 횡보장 모두 검증
# - 최소 2개 이상 국면에서 양호한 성과

# 4. 리스크 지표 체크
# - 최대 낙폭 (MDD) < 15%
# - 승률 > 50%
# - 샤프 비율 > 1.0
```

### 3.4 조건 생략을 통한 범위 확대 전략

#### 전략 1: 선택적 조건 제거

**제거 우선순위**:
1. **항상 참인 조건** (의미 없음)
2. **너무 엄격한 조건** (진입 기회 과도하게 제한)
3. **중복 조건** (비슷한 의미의 다른 조건 존재)

**예시**:
```python
# 제거 후보 1: 고저평균대비등락율 > 0
# 이유: 상승 시 거의 항상 참
elif not (고저평균대비등락율 > 0):
    매수 = False
# → 주석 처리 또는 삭제

# 제거 후보 2: 라운드피겨위5호가이내
# 이유: 너무 엄격, 기회 손실
elif 라운드피겨위5호가이내:
    매수 = False
# → 주석 처리

# 제거 후보 3: 초당순매수금액 범위
# 이유: 초당매수수량 조건과 중복
elif not (1 < 초당순매수금액 < 1000):
    매수 = False
# → 주석 처리 (초당매수수량 조건 유지)
```

#### 전략 2: 상한 조건 제거 (하한만 유지)

**원리**: 상한 제거로 진입 기회 확대

```python
# 기존 (상한 있음)
if not (2.0 <= 시가등락율 < 4.0):
    매수 = False

# 수정 (상한 제거)
if not (시가등락율 >= 2.0):
    매수 = False

# 또는 최적화 변수로
if not (시가등락율 >= self.vars[2]):
    매수 = False
# self.vars[2] = [[1.0, 3.0, 0.5], 2.0]  # 하한만 최적화
```

**적용 대상**:
- 등락율 상한
- 시가등락율 상한
- 시가대비등락율 상한
- 당일거래대금각도 상한 (30도 → 제거)

#### 전략 3: AND를 OR로 변경

**원리**: 조건 완화로 진입 기회 확대

```python
# 기존 (AND - 엄격)
if not (전일비 > 0 and 전일동시간비 > 0):
    매수 = False

# 수정 (OR - 완화)
if not (전일비 > 50 or 전일동시간비 > 50):
    매수 = False  # 둘 중 하나만 만족해도 진입
```

**적용 예시**:
```python
# 패턴 1: 거래량 조건 완화
# 기존
if not (전일비 > 100 and 전일동시간비 > 150):
    매수 = False

# 수정
if not (전일비 > 100 or 전일동시간비 > 150):
    매수 = True

# 패턴 2: 각도 조건 완화
# 기존
if not (등락율각도(30) > 5 and 당일거래대금각도(30) > 5):
    매수 = False

# 수정
if not (등락율각도(30) > 5 or 당일거래대금각도(30) > 5):
    매수 = True
```

---

## 4. 조건식 조합 및 개선 방안

### 4.1 성공적인 조건식의 공통 패턴

#### 패턴 1: 핵심 변수에 집중

**분석한 성공 조건식**:
- `Condition_Tick_Opening_Momentum`: 9개 핵심 변수
- `Condition_Tick_Volume_Surge`: 8개 핵심 변수
- `Condition_Study_By_GPT_o1`: 6개 핵심 변수

**현재 902_905 전략**: 17개 변수 → **너무 많음**

**권장**: 10개 이하로 축소

#### 패턴 2: 시간대별 전략 분리

**성공 사례**:
```python
# Opening_Momentum: 09:00~09:20만 거래
if not (90000 <= 시분초 < 92000):
    매수 = False

# 장점: 특정 시간대 특성에 최적화
```

**현재 902_905**: 09:00~09:05를 902/905로 나눔 → **좋은 접근**

**추가 제안**: 더 세분화
- 09:00:00~09:01:00 (초반 1분)
- 09:01:00~09:02:00 (초반 2분)
- 09:02:00~09:05:00 (초반 5분)

#### 패턴 3: 시가총액별 차등 적용

**성공 사례 (Opening_Momentum)**:
```python
if 시가총액 < 3500:
    # 소형주 조건
    if 체결강도 > 145:
        매수 = True
else:
    # 중대형주 조건
    if 체결강도 > 135:
        매수 = True
```

**현재 902_905**: 3000억 기준 2단계 → **좋은 접근**

**추가 제안**: 3단계 세분화
- 초소형주 (< 1000억)
- 소형주 (1000~3000억)
- 중대형주 (> 3000억)

#### 패턴 4: 유연한 범위 설정

**성공 사례 (Volume_Surge)**:
```python
# 회전율 범위가 넓음
self.vars[2] = [[0.5, 5.0, 0.5], 2.0]  # 10개 값

# 체결강도 범위가 넓음
self.vars[8] = [[30, 150, 20], 50]  # 7개 값
```

**현재 902_905**: 범위가 좁음

### 4.2 변수 조합 전략

#### 조합 전략 1: 체결강도 + 거래대금

**원리**: 매수세 확인 + 거래량 확인

```python
# 기본 조합
if 체결강도 >= 120 and 초당거래대금 / 초당거래대금평균(30) > 2.0:
    매수 = True

# 고급 조합 (구간 평균 추가)
if 체결강도 >= 120 and 체결강도평균(30) > 110 and \
   초당거래대금 / 초당거래대금평균(30) > 2.0:
    매수 = True
```

#### 조합 전략 2: 각도 + 비율

**원리**: 추세 확인 + 강도 확인

```python
# 등락율각도 + 당일거래대금각도
if 등락율각도(30) > 5 and 당일거래대금각도(30) > 5:
    매수 = True  # 가격 상승 + 거래량 증가

# 각도 + 회전율
if 등락율각도(30) > 8 and 회전율 > 2.0:
    매수 = True  # 가파른 상승 + 높은 회전율
```

#### 조합 전략 3: 갭 + 모멘텀

**원리**: 갭 상승 확인 + 추가 상승 확인

```python
# 시가등락율 + 시가대비등락율
if 시가등락율 > 2.0 and 시가대비등락율 > 1.0:
    매수 = True  # 갭 상승 + 추가 상승

# 갭 + 체결강도
if 시가등락율 > 2.0 and 체결강도 >= 130:
    매수 = True  # 갭 상승 + 강한 매수세
```

#### 조합 전략 4: 호가창 + 체결

**원리**: 호가 상태 확인 + 체결 강도 확인

```python
# 초당매수수량 + 매도총잔량
if 초당매수수량 > 매도총잔량 * 0.3 and 체결강도 >= 120:
    매수 = True  # 호가 돌파력 + 강한 매수세

# 누적 매수/매도 + 체결강도
if 누적초당매수수량(30) > 누적초당매도수량(30) * 1.3 and \
   체결강도평균(30) > 110:
    매수 = True  # 지속적인 매수세
```

### 4.3 시가총액별 차등 적용 전략

#### 3단계 세분화 제안

```python
# 초소형주 (< 1000억)
if 시가총액 < 1000:
    # 특성: 높은 변동성, 낮은 유동성
    # 전략: 엄격한 조건 (리스크 관리)
    if 체결강도 >= 150 and 회전율 > 3.0 and \
       초당거래대금 / 초당거래대금평균(30) > 3.0:
        매수 = True

# 소형주 (1000~3000억)
elif 시가총액 < 3000:
    # 특성: 적정 변동성, 중간 유동성
    # 전략: 균형잡힌 조건
    if 체결강도 >= 120 and 회전율 > 2.0 and \
       초당거래대금 / 초당거래대금평균(30) > 2.0:
        매수 = True

# 중대형주 (>= 3000억)
else:
    # 특성: 낮은 변동성, 높은 유동성
    # 전략: 완화된 조건
    if 체결강도 >= 100 and 회전율 > 1.5 and \
       초당거래대금 / 초당거래대금평균(30) > 1.5:
        매수 = True
```

### 4.4 시간대별 전략

#### 세분화 제안

```python
# 초반 1분 (09:00:00~09:01:00) - 갭 상승 포착
if 90000 <= 시분초 < 90100:
    if 시가등락율 > 2.0 and 시가대비등락율 > 1.5:
        매수 = True  # 강한 갭 상승만

# 초반 2분 (09:01:00~09:02:00) - 추가 상승 확인
elif 90100 <= 시분초 < 90200:
    if 등락율각도(30) > 8 and 체결강도 >= 120:
        매수 = True  # 가파른 상승 + 강한 매수세

# 초반 5분 (09:02:00~09:05:00) - 모멘텀 지속 확인
elif 90200 <= 시분초 < 90500:
    if 회전율 > 2.0 and 당일거래대금각도(30) > 10:
        매수 = True  # 높은 회전율 + 지속적인 거래대금 증가
```

### 4.5 리스크 관리 강화

#### 매도 조건 개선

**현재 문제점**:
- 손절: -2% (고정)
- 익절: +5% (고정)
- 변동성 미고려

**개선 제안**:
```python
# 1. 변동성 기반 손절
ATR = (고가 - 저가) / 현재가 * 100  # 간단한 ATR 대용
if 수익률 <= -1.5 - ATR * 0.5:
    매도 = True  # 변동성이 크면 손절폭 확대

# 2. 시간 기반 손절
if 보유시간 > 60 and 수익률 <= -1.0:
    매도 = True  # 1분 이상 보유 시 손절폭 완화

# 3. 트레일링 스톱 (현재 있음, 개선)
if 최고수익률 > 3.0 and 수익률 < 최고수익률 * 0.7:
    매도 = True
# 개선
if 최고수익률 > 3.0:
    if 수익률 < 최고수익률 * (0.7 + ATR * 0.05):
        매도 = True  # 변동성 반영
```

---

## 5. 구체적인 개선 제안

### 5.1 즉시 적용 가능한 개선

#### 개선 1: 조건 개수 축소 (17개 → 10개)

**제거할 조건**:
1. `고저평균대비등락율 > 0` - 항상 참
2. `라운드피겨위5호가이내` - 너무 엄격
3. `초당순매수금액 범위` - 초당매수수량과 중복
4. `전일비 > 0` - 의미 없음 (0 초과가 아닌 유의미한 증가 필요)
5. `전일동시간비 > 0` - 의미 없음
6. `당일거래대금 > 500` - 회전율과 중복
7. `매도/매수총잔량 비율 범위` - 복잡하고 효과 미미

**유지할 핵심 10개 조건**:
1. 가격 범위
2. 등락율 범위
3. VI 조건
4. 시가등락율 하한
5. 시가대비등락율 하한
6. 고가대비위치
7. 회전율
8. 당일거래대금각도
9. 초당거래대금 비율
10. 체결강도

#### 개선 2: 범위 확대

```python
# 기존 (좁음)
self.vars[6] = [[1.5, 3.0, 0.5], 2.0]  # 회전율

# 개선 (확대)
self.vars[6] = [[1.0, 4.0, 0.5], 2.0]  # [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]
```

#### 개선 3: 상한 조건 제거

```python
# 기존 (상한 있음)
if not (1.0 < 등락율 <= 8.0):
    매수 = False

# 개선 (상한 제거)
if not (등락율 > 1.0):
    매수 = False
```

### 5.2 단기 개선 (1개월 내)

#### 개선 1: 시간대 세분화

**현재**: 902 (09:00~09:02), 905 (09:02~09:05)

**제안**: 3단계 세분화
- 초반 1분 (09:00~09:01) - 갭 상승 전략
- 초반 2분 (09:01~09:02) - 추가 상승 확인
- 초반 5분 (09:02~09:05) - 모멘텀 지속

#### 개선 2: 시가총액 3단계 세분화

**현재**: < 3000억, >= 3000억

**제안**: < 1000억, 1000~3000억, >= 3000억

#### 개선 3: 동적 손절/익절

**변동성 기반 손절**:
```python
ATR_proxy = (고가 - 저가) / 현재가 * 100
손절선 = -1.5 - ATR_proxy * 0.5

if 수익률 <= 손절선:
    매도 = True
```

### 5.3 중장기 개선 (3개월 내)

#### 개선 1: 복합 지표 개발

**매수세 강도 지수**:
```python
매수세강도 = (
    체결강도 / 200 * 0.3 +
    (초당매수수량 / 매도총잔량 if 매도총잔량 > 0 else 0) * 0.3 +
    (초당거래대금 / 초당거래대금평균(30) if 초당거래대금평균(30) > 0 else 1) * 0.2 +
    회전율 / 5 * 0.2
)

if 매수세강도 > 0.7:
    매수 = True
```

#### 개선 2: 머신러닝 기반 변수 선택

**방법**:
1. **특성 중요도 분석** (Feature Importance)
2. **상관관계 분석** (중복 변수 제거)
3. **주성분 분석** (PCA)

#### 개선 3: 포트폴리오 접근

**단일 전략 의존 탈피**:
- 902 전략
- 905 전략
- 중반 모멘텀 전략 (09:30~10:00)
- 마감 전략 (14:30~15:00)

**각 전략 독립 최적화 → 포트폴리오 조합**

---

## 6. 최적화 실험 계획

### 6.1 실험 1: 조건 완화를 통한 진입 기회 확대

#### 목표
현재 너무 엄격한 조건으로 진입 기회가 거의 없는 문제 해결

#### 방법

**Step 1: 조건 개수 축소**
- 17개 → 10개 (섹션 5.1 개선 1 참조)

**Step 2: 상한 조건 제거**
```python
# 기존
if not (1.0 < 등락율 <= 8.0):
    매수 = False
if not (2.0 <= 시가등락율 < 4.0):
    매수 = False

# 실험
if not (등락율 > 1.0):
    매수 = False
if not (시가등락율 >= 1.5):
    매수 = False
```

**Step 3: AND를 OR로 변경**
```python
# 기존
if not (전일비 > 0 and 전일동시간비 > 0):
    매수 = False

# 실험
if not (전일비 > 100 or 전일동시간비 > 150):
    매수 = False
```

#### 예상 결과
- 진입 횟수 증가
- 승률 소폭 하락 가능
- 전체 수익 증가 기대

#### 검증 방법
- 최근 3개월 백테스트
- 진입 횟수, 승률, 평균 수익률, MDD 비교

### 6.2 실험 2: 핵심 변수만 사용한 단순화

#### 목표
과적합 방지 및 일반화 성능 향상

#### 방법

**핵심 5개 변수만 선택**:
1. 등락율 (가격 모멘텀)
2. 체결강도 (매수세 강도)
3. 회전율 (거래 활발도)
4. 당일거래대금각도 (거래대금 추세)
5. 시가등락율 (갭 상승)

**최적화 범위 (넓게 설정)**:
```python
self.vars[0] = [[30], 30]  # 고정
self.vars[1] = [[2.0, 15.0, 2.0], 8.0]  # 등락율: [2, 4, 6, ..., 14] → 7개
self.vars[2] = [[50, 150, 20], 100]  # 체결강도: [50, 70, 90, 110, 130, 150] → 6개
self.vars[3] = [[1.0, 4.0, 0.5], 2.0]  # 회전율: [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0] → 7개
self.vars[4] = [[1, 15, 2], 5]  # 당일거래대금각도: [1, 3, 5, ..., 15] → 8개
self.vars[5] = [[1.0, 4.0, 0.5], 2.0]  # 시가등락율: [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0] → 7개

# 총 경우의 수: 7 × 6 × 7 × 8 × 7 = 16,464
# 예상 시간: 약 11일 (1경우/분 가정)
```

**매수 조건 (단순화)**:
```python
매수 = True

# 시간 필터
if not (90000 <= 시분초 < 90200):
    매수 = False

# 가격 필터
elif not (1000 < 현재가 <= 50000):
    매수 = False

# 시가총액 필터
elif 시가총액 < 3000:
    # 핵심 5개 조건만
    if not (등락율 > self.vars[1]):
        매수 = False
    elif not (체결강도 >= self.vars[2]):
        매수 = False
    elif not (회전율 > self.vars[3]):
        매수 = False
    elif not (당일거래대금각도(30) > self.vars[4]):
        매수 = False
    elif not (시가등락율 >= self.vars[5]):
        매수 = False
else:
    매수 = False

if 매수:
    self.Buy(...)
```

#### 예상 결과
- 과적합 감소
- Out-of-Sample 성과 향상
- 안정적인 수익

### 6.3 실험 3: 시간대별 전략 분리

#### 목표
시간대별 특성에 최적화된 전략 개발

#### 방법

**3개 시간대 분리**:

**시간대 1: 초반 1분 (09:00~09:01)**
- 특성: 갭 상승, 고변동성
- 전략: 강한 갭 상승만 포착
```python
if 90000 <= 시분초 < 90100:
    if 시가등락율 > self.vars[1] and \
       시가대비등락율 > self.vars[2] and \
       체결강도 >= self.vars[3]:
        매수 = True
```

**시간대 2: 초반 2분 (09:01~09:02)**
- 특성: 추가 상승 확인
- 전략: 등락율각도 + 체결강도
```python
elif 90100 <= 시분초 < 90200:
    if 등락율각도(30) > self.vars[4] and \
       체결강도평균(30) > self.vars[5] and \
       회전율 > self.vars[6]:
        매수 = True
```

**시간대 3: 초반 5분 (09:02~09:05)**
- 특성: 모멘텀 지속 확인
- 전략: 회전율 + 거래대금각도
```python
elif 90200 <= 시분초 < 90500:
    if 회전율 > self.vars[7] and \
       당일거래대금각도(30) > self.vars[8] and \
       초당거래대금 / 초당거래대금평균(30) > self.vars[9]:
        매수 = True
```

#### 최적화 변수 (각 시간대별)

**시간대 1 (3개 변수)**:
```python
self.vars[1] = [[1.5, 4.0, 0.5], 2.5]  # 시가등락율
self.vars[2] = [[1.0, 3.0, 0.5], 1.5]  # 시가대비등락율
self.vars[3] = [[100, 180, 20], 140]  # 체결강도
```

**시간대 2 (3개 변수)**:
```python
self.vars[4] = [[5, 15, 2], 8]  # 등락율각도
self.vars[5] = [[100, 140, 10], 120]  # 체결강도평균
self.vars[6] = [[1.5, 3.0, 0.5], 2.0]  # 회전율
```

**시간대 3 (3개 변수)**:
```python
self.vars[7] = [[1.5, 3.5, 0.5], 2.0]  # 회전율
self.vars[8] = [[5, 15, 2], 10]  # 당일거래대금각도
self.vars[9] = [[1.5, 3.0, 0.5], 2.0]  # 초당거래대금 비율
```

#### 예상 결과
- 시간대별 특성 반영으로 성과 향상
- 각 시간대 독립 최적화로 유연성 증가

---

## 7. 결론 및 권장사항

### 7.1 핵심 문제점 요약

1. **조건이 너무 많음** (17개)
   - 진입 기회 극소
   - 과적합 위험

2. **범위가 너무 좁음**
   - 특정 시장 상황에만 작동
   - 일반화 성능 낮음

3. **상충되는 조건**
   - 등락율각도 강화가 오히려 기회 감소
   - 일부 조건이 서로 모순

4. **유연성 부족**
   - 시장 변동성 미반영
   - 동적 조정 불가

### 7.2 즉시 적용 권장사항

#### 우선순위 1: 조건 개수 축소 (17개 → 10개)

**제거할 조건**:
- 고저평균대비등락율 > 0
- 라운드피겨위5호가이내
- 초당순매수금액 범위
- 전일비 > 0
- 전일동시간비 > 0
- 당일거래대금 > 500
- 매도/매수총잔량 비율 범위

#### 우선순위 2: 핵심 변수 범위 확대

```python
# 회전율
self.vars[6] = [[1.0, 4.0, 0.5], 2.0]  # 기존 [1.5, 3.0]에서 확대

# 당일거래대금각도
self.vars[7] = [[1, 15, 2], 5]  # 기존 [3, 7]에서 확대

# 체결강도 하한
self.vars[10] = [[30, 150, 20], 50]  # 기존 [40, 60]에서 확대
```

#### 우선순위 3: 상한 조건 제거

```python
# 등락율 상한 제거
if not (등락율 > 1.0):  # 기존: 1.0 < 등락율 <= 8.0
    매수 = False

# 시가등락율 상한 제거
if not (시가등락율 >= 1.5):  # 기존: 2.0 <= 시가등락율 < 4.0
    매수 = False
```

### 7.3 단계별 실행 계획

#### 1단계 (1주일): 조건 단순화
- 17개 → 10개 조건 축소
- 상한 조건 제거
- 백테스트 실행 및 결과 비교

#### 2단계 (2주일): 범위 확대 최적화
- 핵심 5개 변수만 최적화
- 넓은 범위로 탐색
- 최적값 발견

#### 3단계 (3주일): 정밀 최적화
- 1~2단계 결과 바탕으로 정밀 탐색
- 추가 5개 변수 포함
- 최종 최적값 도출

#### 4단계 (4주일): 검증 및 배포
- Out-of-Sample 테스트
- 민감도 분석
- 실전 배포 준비

### 7.4 최종 권장 조건식 (단순화 버전)

#### 매수 조건식 (10개 조건)

```python
# 계산 변수
전일종가 = 현재가 / (1 + (등락율 / 100))
시가등락율 = ((시가 - 전일종가) / 전일종가) * 100
시가대비등락율 = ((현재가 - 시가) / 시가) * 100

매수 = True

# 1. 시간 제한
if not (90000 <= 시분초 < 90200):
    매수 = False

# 2. 가격 범위
elif not (1000 < 현재가 <= 50000):
    매수 = False

# 3. VI 조건
elif not (현재가 < VI아래5호가):
    매수 = False

# 4. 시가총액별 조건
elif 시가총액 < 3000:
    # 5. 등락율 하한
    if not (등락율 > self.vars[1]):
        매수 = False
    # 6. 시가등락율 하한
    elif not (시가등락율 >= self.vars[2]):
        매수 = False
    # 7. 시가대비등락율 하한
    elif not (시가대비등락율 >= self.vars[3]):
        매수 = False
    # 8. 고가대비위치
    elif not (현재가 > 고가 - (고가 - 저가) * 0.20):
        매수 = False
    # 9. 회전율
    elif not (회전율 > self.vars[4]):
        매수 = False
    # 10. 당일거래대금각도
    elif not (당일거래대금각도(30) > self.vars[5]):
        매수 = False
    # 11. 초당거래대금 비율
    elif not (초당거래대금 / 초당거래대금평균(30) > self.vars[6]):
        매수 = False
    # 12. 체결강도 하한
    elif not (체결강도 >= self.vars[7]):
        매수 = False
else:
    매수 = False

if 매수:
    self.Buy(종목코드, 종목명, 매수수량, 현재가, 매도호가1, 매수호가1, 데이터길이)
```

#### 최적화 범위 (넓은 탐색)

```python
self.vars[0] = [[30], 30]  # 평균 틱수 (고정)

# 핵심 7개 변수 (902 전략)
self.vars[1] = [[2.0, 12.0, 2.0], 6.0]  # 등락율 하한: [2, 4, 6, 8, 10, 12] → 6개
self.vars[2] = [[1.0, 4.0, 0.5], 2.0]  # 시가등락율 하한: [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0] → 7개
self.vars[3] = [[0.3, 2.0, 0.5], 0.5]  # 시가대비등락율 하한: [0.3, 0.8, 1.3, 1.8] → 4개
self.vars[4] = [[1.0, 4.0, 0.5], 2.0]  # 회전율: [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0] → 7개
self.vars[5] = [[1, 15, 2], 5]  # 당일거래대금각도 하한: [1, 3, 5, 7, 9, 11, 13, 15] → 8개
self.vars[6] = [[1.5, 4.0, 0.5], 2.5]  # 초당거래대금 비율: [1.5, 2.0, 2.5, 3.0, 3.5, 4.0] → 6개
self.vars[7] = [[50, 150, 20], 100]  # 체결강도 하한: [50, 70, 90, 110, 130, 150] → 6개

# 매도 변수 (5개)
self.vars[8] = [[28.0, 30.0, 0.5], 29.5]  # 등락율 상한가: [28.0, 28.5, 29.0, 29.5, 30.0] → 5개
self.vars[9] = [[-3.0, -1.0, 0.5], -2.0]  # 손실 수익률: [-3.0, -2.5, -2.0, -1.5, -1.0] → 5개
self.vars[10] = [[4.0, 6.0, 0.5], 5.0]  # 수익률 상한: [4.0, 4.5, 5.0, 5.5, 6.0] → 5개
self.vars[11] = [[-6.0, -4.0, 0.5], -5.0]  # 수익률 하한: [-6.0, -5.5, -5.0, -4.5, -4.0] → 5개
self.vars[12] = [[5.0, 7.0, 0.5], 6.0]  # 최고수익률 기준값: [5.0, 5.5, 6.0, 6.5, 7.0] → 5개

# 총 경우의 수 (매수): 6 × 7 × 4 × 7 × 8 × 6 × 6 = 338,688
# 총 경우의 수 (매도): 5 × 5 × 5 × 5 × 5 = 3,125
# 전체 경우의 수: 338,688 × 3,125 = 1,058,400,000

# → 여전히 많으므로 단계별 최적화 필요
# 1단계: 매수 변수만 (338,688경우, 약 235일)
# 2단계: 매도 변수만 (3,125경우, 약 2일)
```

### 7.5 기대 효과

#### 정량적 효과
- 진입 기회: 10배 이상 증가
- 과적합 감소: Out-of-Sample 성과 80% 이상 유지
- 최적화 시간: 142,027년 → 235일 (약 600배 단축)

#### 정성적 효과
- 전략 이해도 향상 (단순화)
- 유지보수 용이성 증가
- 시장 변화 대응력 향상

---

**작성자**: Claude (Anthropic Sonnet 4.5)
**작성일**: 2025-11-29
**버전**: 1.0
