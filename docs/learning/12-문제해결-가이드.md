# 12. ë¬¸ì œí•´ê²° ê°€ì´ë“œ

> STOM ì‚¬ìš© ì¤‘ ë°œìƒí•˜ëŠ” ë¬¸ì œ ì§„ë‹¨ ë° í•´ê²° ë°©ë²•

## ëª©ì°¨

- [ì¼ë°˜ì ì¸ ì˜¤ë¥˜](#ì¼ë°˜ì ì¸-ì˜¤ë¥˜)
- [í‚¤ì›€ API ê´€ë ¨](#í‚¤ì›€-api-ê´€ë ¨)
- [ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜](#ë°ì´í„°ë² ì´ìŠ¤-ì˜¤ë¥˜)
- [ì„±ëŠ¥ ë¬¸ì œ](#ì„±ëŠ¥-ë¬¸ì œ)
- [ë””ë²„ê¹… ë°©ë²•](#ë””ë²„ê¹…-ë°©ë²•)
- [FAQ](#faq)

---

## ì¼ë°˜ì ì¸ ì˜¤ë¥˜

### 1. "ê´€ë¦¬ìž ê¶Œí•œ í•„ìš”" ì˜¤ë¥˜

**ì¦ìƒ:** ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰ ì‹œ ê¶Œí•œ ì˜¤ë¥˜

**ì›ì¸:** Windows UAC (ì‚¬ìš©ìž ê³„ì • ì»¨íŠ¸ë¡¤)

**í•´ê²°:**
```bash
# ë°°ì¹˜ íŒŒì¼ì„ ìš°í´ë¦­ â†’ "ê´€ë¦¬ìž ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰"

# ë˜ëŠ” Python ì§ì ‘ ì‹¤í–‰ (ê´€ë¦¬ìž cmd)
python stom.py
```

### 2. "ëª¨ë“ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" ì˜¤ë¥˜

**ì¦ìƒ:** `ModuleNotFoundError: No module named 'PyQt5'`

**ì›ì¸:** íŒ¨í‚¤ì§€ ë¯¸ì„¤ì¹˜

**í•´ê²°:**
```bash
# íŒ¨í‚¤ì§€ ìž¬ì„¤ì¹˜
pip_install_64.bat

# ë˜ëŠ” ìˆ˜ë™ ì„¤ì¹˜
pip install PyQt5 numpy pandas
```

### 3. Python ë²„ì „ ì˜¤ë¥˜

**ì¦ìƒ:** `SyntaxError: invalid syntax`

**ì›ì¸:** Python 3.9 ë¯¸ë§Œ ì‚¬ìš©

**í•´ê²°:**
```bash
# Python ë²„ì „ í™•ì¸
python --version

# 3.9 ì´ìƒìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ
# https://www.python.org/downloads/
```

### 4. TA-Lib ì„¤ì¹˜ ì‹¤íŒ¨

**ì¦ìƒ:** `error: Microsoft Visual C++ 14.0 is required`

**í•´ê²°:**
```bash
# ë°©ë²• 1: í”„ë¦¬ì»´íŒŒì¼ íœ  ì‚¬ìš© (ê¶Œìž¥)
cd utility
pip install TA_Lib-0.4.24-cp39-cp39-win_amd64.whl

# ë°©ë²• 2: Visual Studio Build Tools ì„¤ì¹˜
# https://visualstudio.microsoft.com/downloads/
# "C++ ë¹Œë“œ ë„êµ¬" ì„¤ì¹˜
```

---

## í‚¤ì›€ API ê´€ë ¨

### 1. "í‚¤ì›€ OpenAPIë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"

**ì¦ìƒ:** í‚¤ì›€ API ì´ˆê¸°í™” ì‹¤íŒ¨

**ì›ì¸:** OpenAPI ë¯¸ì„¤ì¹˜ ë˜ëŠ” ê²½ë¡œ ì˜¤ë¥˜

**í•´ê²°:**
```python
# 1. KOA Studio ì„¤ì¹˜ í™•ì¸
# C:/OpenAPI/ í´ë” ì¡´ìž¬ í™•ì¸

# 2. ê²½ë¡œ ìˆ˜ì • (utility/setting.py)
OPENAPI_PATH = 'C:/OpenAPI/'  # ì‹¤ì œ ì„¤ì¹˜ ê²½ë¡œë¡œ ë³€ê²½
```

### 2. ë¡œê·¸ì¸ ì‹¤íŒ¨

**ì¦ìƒ:** í‚¤ì›€ ë¡œê·¸ì¸ ì°½ì´ ë‚˜íƒ€ë‚˜ì§€ ì•Šê±°ë‚˜ ë¡œê·¸ì¸ ì‹¤íŒ¨

**í•´ê²°:**
```python
# 1. 32ë¹„íŠ¸ Python ì‚¬ìš© í™•ì¸
python --version
# Python 3.9.x (32-bit) í™•ì¸

# 2. ì¸ì¦ì„œ í™•ì¸
# í‚¤ì›€ HTSì—ì„œ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸

# 3. ë°©í™”ë²½ í™•ì¸
# Windows ë°©í™”ë²½ì—ì„œ Python í—ˆìš©

# 4. ê´€ë¦¬ìž ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰
```

### 3. "ì¡°íšŒ ê³¼ë¶€í•˜" ì˜¤ë¥˜

**ì¦ìƒ:** `OP_ERR_OVER_REQUEST_PER_SECOND`

**ì›ì¸:** ì´ˆë‹¹ ì¡°íšŒ íšŸìˆ˜ ì œí•œ (5íšŒ/ì´ˆ)

**í•´ê²°:**
```python
# stock/kiwoom_receiver_tick.py
import time

# TR ìš”ì²­ ì „ ëŒ€ê¸°
time.sleep(0.2)  # 200ms ëŒ€ê¸° (ì´ˆë‹¹ 5íšŒ ì œí•œ)
```

### 4. ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì‹  ì•ˆ ë¨

**ì¦ìƒ:** ë¦¬ì‹œë²„ ì‹œìž‘í–ˆì§€ë§Œ ë°ì´í„° ì—†ìŒ

**í•´ê²°:**
```python
# 1. êµ¬ë… í™•ì¸
# kiwoom_receiver_tick.pyì˜ SetRealReg í˜¸ì¶œ í™•ì¸

# 2. ì¢…ëª©ì½”ë“œ í™•ì¸
# ì˜¬ë°”ë¥¸ 6ìžë¦¬ ì½”ë“œ ì‚¬ìš© (ì˜ˆ: '005930')

# 3. ìž¥ ì‹œê°„ í™•ì¸
# 09:00~15:30 (ì£¼ì‹ ê±°ëž˜ ì‹œê°„)

# 4. ë¡œê·¸ í™•ì¸
# GUI í•˜ë‹¨ ë¡œê·¸ ì°½ì—ì„œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸
```

---

## ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜

### 1. "database is locked" ì˜¤ë¥˜

**ì¦ìƒ:** SQLite ìž ê¸ˆ ì˜¤ë¥˜

**ì›ì¸:** ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— DB ì ‘ê·¼

**í•´ê²°:**
```python
# 1. Query í”„ë¡œì„¸ìŠ¤ ì‚¬ìš© (ê¶Œìž¥)
self.queryQ.put(['ì¿¼ë¦¬', ë°ì´í„°])

# 2. íƒ€ìž„ì•„ì›ƒ ì„¤ì •
conn = sqlite3.connect('db.db', timeout=30)

# 3. WAL ëª¨ë“œ í™œì„±í™”
conn.execute('PRAGMA journal_mode=WAL')
```

### 2. í…Œì´ë¸” ë˜ëŠ” ì»¬ëŸ¼ ì—†ìŒ

**ì¦ìƒ:** `no such table: ...` ë˜ëŠ” `no such column: ...`

**í•´ê²°:**
```bash
# ë°ì´í„°ë² ì´ìŠ¤ ìž¬ìƒì„±
python utility/database_check.py

# ë˜ëŠ” ìˆ˜ë™ ìƒì„±
python
>>> import sqlite3
>>> conn = sqlite3.connect('_database/setting.db')
>>> # CREATE TABLE ...
```

### 3. ë°ì´í„° ì¤‘ë³µ

**ì¦ìƒ:** ê°™ì€ ë°ì´í„°ê°€ ì—¬ëŸ¬ ë²ˆ ì €ìž¥ë¨

**í•´ê²°:**
```bash
# ì¤‘ë³µ ì œê±° ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
python utility/db_distinct.py

# ë˜ëŠ” SQLë¡œ ì œê±°
DELETE FROM table_name
WHERE rowid NOT IN (
    SELECT MIN(rowid)
    FROM table_name
    GROUP BY ì¢…ëª©ì½”ë“œ, ì²´ê²°ì‹œê°„
);
```

### 4. ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ ì†ìƒ

**ì¦ìƒ:** `database disk image is malformed`

**í•´ê²°:**
```bash
# SQLite ë¬´ê²°ì„± ê²€ì‚¬
sqlite3 _database/setting.db "PRAGMA integrity_check;"

# ë³µêµ¬ ì‹œë„
sqlite3 _database/setting.db ".recover" | sqlite3 new.db

# ë°±ì—…ì—ì„œ ë³µì›
# _database/backup/ í´ë” í™•ì¸
```

---

## ì„±ëŠ¥ ë¬¸ì œ

### 1. ì‹œìŠ¤í…œ ëŠë¦¼

**ì¦ìƒ:** UI ë°˜ì‘ì´ ëŠë¦¬ê±°ë‚˜ ë©ˆì¶¤

**ì›ì¸:** CPU/ë©”ëª¨ë¦¬ ë¶€ì¡±

**í•´ê²°:**
```python
# 1. ì „ëžµ í”„ë¡œì„¸ìŠ¤ ê°œìˆ˜ ê°ì†Œ
# ui/ui_mainwindow.py
STRATEGY_PROCESS_COUNT = 3  # 5 â†’ 3

# 2. ê´€ì‹¬ì¢…ëª© ê°œìˆ˜ ì œí•œ
# ì„¤ì • â†’ ìµœëŒ€ë§¤ìˆ˜ì¢…ëª©ìˆ˜ ê°ì†Œ

# 3. ë¡œê·¸ ë ˆë²¨ ë³€ê²½
# utility/setting.py
LOG_LEVEL = 'WARNING'  # 'INFO' â†’ 'WARNING'

# 4. ì°¨íŠ¸ ì—…ë°ì´íŠ¸ ì£¼ê¸° ì¦ê°€
# ui/ui_draw_realchart.py
CHART_UPDATE_INTERVAL = 1000  # 500ms â†’ 1000ms
```

### 2. ë©”ëª¨ë¦¬ ë¶€ì¡±

**ì¦ìƒ:** `MemoryError` ë˜ëŠ” ì‹œìŠ¤í…œ ë©ˆì¶¤

**í•´ê²°:**
```python
# 1. ë°ì´í„° ë³´ê´€ ê¸°ê°„ ë‹¨ì¶•
# utility/query.py
DELETE_AFTER_DAYS = 7  # 30 â†’ 7 (7ì¼ í›„ ì‚­ì œ)

# 2. ë°°ì—´ í¬ê¸° ì œí•œ
# strategy íŒŒì¼
MAX_ARRAY_SIZE = 1000  # í‹± ë°ì´í„° ìµœëŒ€ 1000ê°œ

# 3. 64ë¹„íŠ¸ Python ì‚¬ìš©
python --version  # 64-bit í™•ì¸
```

### 3. ë°±í…ŒìŠ¤íŠ¸ ë„ˆë¬´ ëŠë¦¼

**ì¦ìƒ:** ë°±í…ŒìŠ¤íŠ¸ 1ì‹œê°„ ì´ìƒ ì†Œìš”

**í•´ê²°:**
```python
# 1. ë°±í…ŒìŠ¤íŠ¸ ê¸°ê°„ ë‹¨ì¶•
ë°±í…ŒìŠ¤íŠ¸ ê¸°ê°„: 3ê°œì›” â†’ 1ê°œì›”

# 2. ë°±í…ŒìŠ¤íŠ¸ ì—”ì§„ ê°œìˆ˜ ì¦ê°€
# backtester/backtest.py
ENGINE_COUNT = 10  # 5 â†’ 10 (ê³ ì„±ëŠ¥ PC)

# 3. Numba ìµœì í™” í™œì„±í™”
# utility/static.py
@jit(nopython=True, cache=True)  # cache=True ì¶”ê°€

# 4. ë°ì´í„° ìƒ˜í”Œë§
# í‹± ë°ì´í„° â†’ ë¶„ ë°ì´í„°ë¡œ ë³€ê²½
```

---

## ë””ë²„ê¹… ë°©ë²•

### 1. ë¡œê·¸ í™•ì¸

#### GUI ë¡œê·¸ ì°½

- í•˜ë‹¨ ë¡œê·¸ ì°½ì—ì„œ ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸
- `[ERROR]`, `[WARNING]` ë©”ì‹œì§€ ì£¼ëª©

#### íŒŒì¼ ë¡œê·¸

```bash
# ë¡œê·¸ íŒŒì¼ í™•ì¸
cat log/YYYYMMDD.log

# ì—ëŸ¬ë§Œ í•„í„°ë§
grep "\[ERROR\]" log/YYYYMMDD.log

# íŠ¹ì • í”„ë¡œì„¸ìŠ¤ ë¡œê·¸
grep "Receiver" log/YYYYMMDD.log
```

### 2. í”„ë¦°íŠ¸ ë””ë²„ê¹…

```python
# ì „ëžµ íŒŒì¼ì— print ì¶”ê°€
print(f'í˜„ìž¬ê°€: {c}, MA5: {ma5}, RSI: {rsi}')

# ë§¤ìˆ˜ ì‹ í˜¸ í™•ì¸
if buy_condition:
    print(f'ë§¤ìˆ˜ ì‹ í˜¸ ë°œìƒ: {ì¢…ëª©ì½”ë“œ}')
```

### 3. í”„ë¡œíŒŒì¼ë§

```python
# ì„±ëŠ¥ ë³‘ëª© ì°¾ê¸°
import cProfile

cProfile.run('ì „ëžµ_ì‹¤í–‰()')

# ê²°ê³¼
#   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
#      100    0.050    0.001    0.100    0.001 strategy.py:50(calculate_ma)
```

### 4. ë‹¨ê³„ë³„ ë””ë²„ê¹…

```python
# 1. ë°ì´í„° ìˆ˜ì‹  í™•ì¸
print('Receiver ë°ì´í„°:', data)

# 2. ì§€í‘œ ê³„ì‚° í™•ì¸
print('MA5:', ma5, 'MA20:', ma20)

# 3. ì¡°ê±´ í™•ì¸
print('ë§¤ìˆ˜ ì¡°ê±´ 1:', c > ma5)
print('ë§¤ìˆ˜ ì¡°ê±´ 2:', c > ma20)
print('ë§¤ìˆ˜ ì¡°ê±´ 3:', rsi < 30)

# 4. ì£¼ë¬¸ í™•ì¸
if buy_signal:
    print('ì£¼ë¬¸ ì „ì†¡:', ì¢…ëª©ì½”ë“œ, ìˆ˜ëŸ‰, ê°€ê²©)
```

### 5. ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸

```python
import sqlite3

conn = sqlite3.connect('_database/tradelist.db')
cursor = conn.cursor()

# ì²´ê²° ë‚´ì—­ í™•ì¸
cursor.execute('SELECT * FROM s_chegeollist ORDER BY ì²´ê²°ì‹œê°„ DESC LIMIT 10')
for row in cursor.fetchall():
    print(row)

conn.close()
```

---

## FAQ

### Q1: ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ì™€ ì‹¤ì „ ê²°ê³¼ê°€ ë‹¤ë¥¸ ì´ìœ ëŠ”?

**A:** ì—¬ëŸ¬ ì›ì¸ì´ ìžˆìŠµë‹ˆë‹¤:

1. **ìŠ¬ë¦¬í”¼ì§€ (Slippage)**: ì‹¤ì „ì—ì„œëŠ” ì£¼ë¬¸ê°€ì™€ ì²´ê²°ê°€ê°€ ë‹¤ë¥¼ ìˆ˜ ìžˆìŒ
2. **ì²´ê²° ì§€ì—°**: ì£¼ë¬¸ ì „ì†¡ í›„ ì²´ê²°ê¹Œì§€ ì‹œê°„ ì†Œìš”
3. **í˜¸ê°€ ì°¨ì´**: ë°±í…ŒìŠ¤íŠ¸ëŠ” ì²´ê²°ê°€, ì‹¤ì „ì€ í˜¸ê°€ë‹¨ìœ„
4. **ê³¼ìµœì í™”**: ê³¼ê±° ë°ì´í„°ì—ë§Œ ìµœì í™”ë¨

**í•´ê²°:**
- Walk-Forward Test ìˆ˜í–‰
- ëª¨ì˜íˆ¬ìžë¡œ ì¶©ë¶„ížˆ ê²€ì¦
- ìŠ¬ë¦¬í”¼ì§€ ê³ ë ¤í•œ ë°±í…ŒìŠ¤íŠ¸

### Q2: ì „ëžµì´ ìžë™ìœ¼ë¡œ ì‹œìž‘ë˜ì§€ ì•ŠëŠ” ì´ìœ ëŠ”?

**A:** ì²´í¬ í¬ì¸íŠ¸:

1. ì „ëžµ ì €ìž¥ í™•ì¸
2. ë¦¬ì‹œë²„ ì‹œìž‘ í™•ì¸
3. ì „ëžµ í”„ë¡œì„¸ìŠ¤ ì‹œìž‘ ë²„íŠ¼ í´ë¦­
4. ë¡œê·¸ì—ì„œ ì—ëŸ¬ í™•ì¸

### Q3: ì†ì ˆì´ ì•ˆ ë˜ëŠ” ì´ìœ ëŠ”?

**A:** í™•ì¸ ì‚¬í•­:

```python
# ë§¤ë„ ì¡°ê±´ì— ì†ì ˆ í¬í•¨ í™•ì¸
if ìˆ˜ìµë¥  < stop_loss:
    sell_signal = True

# ì†ì ˆ ìˆ˜ìµë¥  ì„¤ì • í™•ì¸ (ìŒìˆ˜)
stop_loss = -1.5  # -1.5%

# í˜¸ê°€ ë‹¨ìœ„ í™•ì¸ (VI ë°œë™ ë°©ì§€)
ë§¤ë„ê°€ = í˜„ìž¬ê°€ - (í˜¸ê°€ë‹¨ìœ„ * 2)
```

### Q4: í…”ë ˆê·¸ëž¨ ì•Œë¦¼ì´ ì•ˆ ì˜¤ëŠ” ì´ìœ ëŠ”?

**A:** í™•ì¸:

1. ë´‡ í† í° ì •í™•í•œì§€ í™•ì¸
2. Chat ID ì •í™•í•œì§€ í™•ì¸
3. ë´‡ì—ê²Œ ë¨¼ì € ë©”ì‹œì§€ ì „ì†¡í–ˆëŠ”ì§€ í™•ì¸
4. ë°©í™”ë²½ì—ì„œ Python í—ˆìš©

### Q5: ì½”ì¸ ê±°ëž˜ì†Œ API ì˜¤ë¥˜

**A:** ì—…ë¹„íŠ¸/ë°”ì´ë‚¸ìŠ¤ë³„ í™•ì¸:

**ì—…ë¹„íŠ¸:**
```python
# API í‚¤ ê¶Œí•œ í™•ì¸
# - ìžì‚° ì¡°íšŒ
# - ì£¼ë¬¸ ì¡°íšŒ
# - ì£¼ë¬¸í•˜ê¸°

# IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì„¤ì • (ì„ íƒ)
```

**ë°”ì´ë‚¸ìŠ¤:**
```python
# API í‚¤ ê¶Œí•œ í™•ì¸
# - Enable Spot & Margin Trading
# - Enable Futures

# IP ì œí•œ í•´ì œ
```

---

## ì¶”ê°€ ì§€ì›

### ì»¤ë®¤ë‹ˆí‹°

- **GitHub Issues**: ë²„ê·¸ ë¦¬í¬íŠ¸ ë° ì§ˆë¬¸
- **Discussions**: ì „ëžµ ê³µìœ  ë° í† ë¡ 

### ë¬¸ì„œ

- [CLAUDE.md](../../CLAUDE.md): ì‹œìŠ¤í…œ ê°œìš”
- [í•™ìŠµ ê°€ì´ë“œ](./README.md): ì „ì²´ í•™ìŠµ ë¡œë“œë§µ

### ë””ë²„ê¹… ì²´í¬ë¦¬ìŠ¤íŠ¸

ë¬¸ì œ ë°œìƒ ì‹œ ìˆœì„œëŒ€ë¡œ í™•ì¸:

- [ ] ë¡œê·¸ íŒŒì¼ í™•ì¸
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ë¬´ê²°ì„± í™•ì¸
- [ ] í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ ìƒíƒœ í™•ì¸
- [ ] ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
- [ ] API í‚¤ ë° ê¶Œí•œ í™•ì¸
- [ ] ìž¥ ì‹œê°„ í™•ì¸ (ì£¼ì‹ 09:00~15:30)
- [ ] ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ í™•ì¸ (CPU/ë©”ëª¨ë¦¬)

---

**ì¶•í•˜í•©ë‹ˆë‹¤! STOM í•™ìŠµ ê°€ì´ë“œë¥¼ ëª¨ë‘ ì™„ë£Œí•˜ì…¨ìŠµë‹ˆë‹¤!** ðŸŽ‰

ì´ì œ ìžì‹ ë§Œì˜ íŠ¸ë ˆì´ë”© ì „ëžµì„ ê°œë°œí•˜ê³  ì‹¤ì „ì— ë„ì „í•´ë³´ì„¸ìš”!

**í–‰ìš´ì„ ë¹•ë‹ˆë‹¤! ðŸ“ˆ**
