# 01. 시작하기

> STOM 시스템의 설치부터 첫 실행까지

## 목차

- [시스템 요구사항](#시스템-요구사항)
- [설치 가이드](#설치-가이드)
- [초기 설정](#초기-설정)
- [첫 실행](#첫-실행)
- [기본 용어](#기본-용어)

---

## 시스템 요구사항

### 하드웨어

| 구분 | 최소 사양 | 권장 사양 |
|------|----------|-----------|
| **CPU** | 4코어 이상 | 8코어 이상 (멀티프로세스 활용) |
| **RAM** | 8GB | 16GB 이상 |
| **저장공간** | 10GB | 50GB 이상 (백테스트 데이터) |
| **모니터** | 1개 | 2개 이상 (트레이딩 모니터링) |

### 소프트웨어

| 구분 | 요구사항 | 비고 |
|------|----------|------|
| **OS** | Windows 10/11 | 키움 API는 Windows 전용 |
| **Python** | 64비트 Python 3.9+ | 메인 시스템 |
| **Python** | 32비트 Python 3.9+ | 키움 API용 (선택) |
| **관리자 권한** | 필수 | 배치 파일 실행 시 |

### 필수 계정

- **키움증권 계좌** (주식 거래 시)
  - OpenAPI 신청: [키움증권 홈페이지](https://www.kiwoom.com/)
  - KOA Studio 설치 필요
- **업비트 계좌** (암호화폐 거래 시)
  - API 키 발급: 업비트 앱/웹 → 고객센터 → Open API 관리
- **바이낸스 계좌** (선물 거래 시)
  - API 키 발급: Binance → API Management

---

## 설치 가이드

### Step 1: 저장소 클론

```bash
git clone https://github.com/Py-CI-Park/STOM.git
cd STOM
```

### Step 2: Python 설치

#### 64비트 Python (필수)

1. [Python 공식 사이트](https://www.python.org/downloads/)에서 다운로드
2. 설치 시 **"Add Python to PATH"** 체크
3. 설치 확인:
   ```bash
   python --version
   # Python 3.9.x 이상
   ```

#### 32비트 Python (키움 API 사용 시)

키움 OpenAPI는 32비트만 지원하므로, 주식 거래 시 필요합니다.

1. [Python 3.9.x 32비트 다운로드](https://www.python.org/downloads/)
2. 다른 경로에 설치 (예: `C:\Python39-32\`)
3. `utility/setting.py`에서 경로 수정:
   ```python
   PYTHON_32BIT = 'C:/Python39-32/python.exe'
   ```

### Step 3: 키움 OpenAPI 설치 (주식 거래 시)

1. 키움증권 홈페이지 → 로그인
2. Open API+ → 다운로드
3. KOA Studio 설치
4. `C:/OpenAPI/` 경로에 설치 확인

### Step 4: 패키지 설치

#### 64비트 패키지 설치

```bash
# 배치 파일 실행 (권장)
pip_install_64.bat

# 또는 수동 설치
pip install -r requirements.txt
```

**주요 패키지:**
- PyQt5 (GUI)
- numpy==1.26.4, pandas==2.0.3 (데이터 처리)
- pyupbit, python-binance (거래소 API)
- websockets, pyzmq (통신)
- optuna (최적화)
- TA-Lib (기술적 지표)

#### TA-Lib 설치

TA-Lib는 C 라이브러리이므로 별도 설치가 필요합니다.

**방법 1: 프리컴파일 휠 사용 (권장)**

```bash
# utility/ 폴더의 휠 파일 사용
cd utility
pip install TA_Lib-0.4.24-cp39-cp39-win_amd64.whl
```

**방법 2: 직접 설치**

1. [TA-Lib 다운로드](https://www.ta-lib.org/)
2. Visual Studio Build Tools 설치
3. `pip install TA-Lib`

### Step 5: 데이터베이스 초기화

첫 실행 시 자동으로 데이터베이스가 생성됩니다.

```bash
python64 utility/database_check.py
```

출력 예시:
```
Setting DB 체크 완료
Stock Tick DB 생성 완료
Stock Min DB 생성 완료
Coin Tick DB 생성 완료
Coin Min DB 생성 완료
Tradelist DB 생성 완료
Strategy DB 생성 완료
Backtest DB 생성 완료
```

---

## 초기 설정

### 1. API 키 등록

#### 키움증권 (주식)

GUI에서 설정:
1. STOM 실행
2. `설정` 탭
3. `주식 계정 설정`
   - 아이디: 키움 로그인 ID
   - 비밀번호: 로그인 비밀번호
   - 인증서 비밀번호: 공동인증서 비밀번호
   - 계좌번호: 8자리 계좌번호
   - 모의투자: 체크 (실계좌 사용 시 해제)

**암호화 저장**: Fernet 암호화로 안전하게 저장됩니다.

#### 업비트 (암호화폐)

1. 업비트 앱/웹 → 고객센터 → Open API 관리
2. API 키 발급 (권한: 자산 조회, 주문 조회, 주문하기)
3. STOM에서 설정:
   - Access Key: API 액세스 키
   - Secret Key: API 시크릿 키

#### 바이낸스 (선물)

1. Binance → API Management → Create API
2. STOM에서 설정:
   - Access Key: API 키
   - Secret Key: Secret 키

### 2. 텔레그램 알림 설정 (선택)

거래 알림을 텔레그램으로 받을 수 있습니다.

1. 텔레그램 봇 생성:
   - [@BotFather](https://t.me/botfather)와 대화
   - `/newbot` 명령어로 봇 생성
   - Bot Token 저장

2. Chat ID 확인:
   - 봇에게 메시지 전송
   - 브라우저에서 `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
   - `chat.id` 값 복사

3. STOM에서 설정:
   - 텔레그램 봇 토큰
   - 텔레그램 Chat ID

### 3. 거래 설정

기본 설정을 확인하고 조정하세요.

**주식 거래 설정:**
- 투자금: 1,000,000원 (기본)
- 최대 종목수: 5개
- 손절 수익률: -2%
- 익절 수익률: 2%

**코인 거래 설정:**
- 투자금: 100,000원 (기본)
- 최대 종목수: 3개
- 손절 수익률: -3%
- 익절 수익률: 3%

---

## 첫 실행

### 방법 1: 배치 파일 실행 (권장)

#### 주식 모드

```bash
stom_stock.bat
```

#### 코인 모드

```bash
stom_coin.bat
```

#### 통합 모드

```bash
stom.bat
# 실행 후 GUI에서 주식/코인 선택
```

### 방법 2: Python 직접 실행

```bash
# 주식 모드
python64 stom.py stock

# 코인 모드
python64 stom.py coin

# 인자 없이 실행 (GUI에서 선택)
python64 stom.py
```

### 첫 실행 시 확인사항

#### 1. 로그 확인

GUI 하단 로그 창에서 시스템 초기화를 확인하세요:

```
[INFO] STOM V1 시작
[INFO] 데이터베이스 연결 완료
[INFO] Query 프로세스 시작
[INFO] Chart 프로세스 시작
[INFO] Sound 프로세스 시작
[INFO] Telegram 프로세스 시작
```

#### 2. 키움 로그인 (주식 모드)

키움 OpenAPI 로그인 창이 자동으로 나타납니다:
1. 아이디/비밀번호 입력
2. 인증서 비밀번호 입력
3. 로그인 완료 확인

#### 3. 리시버 시작

- **주식**: `주식 리시버 시작` 버튼 클릭
- **코인**: `코인 리시버 시작` 버튼 클릭

실시간 데이터 수신이 시작됩니다.

#### 4. 전략 시작

1. `전략 관리` 탭
2. 전략 선택
3. `전략 시작` 버튼 클릭

---

## 기본 용어

### 프로세스 관련

- **Receiver (리시버)**: 실시간 시장 데이터 수집 프로세스
- **Strategy (전략)**: 매매 신호 생성 프로세스
- **Trader (트레이더)**: 주문 실행 프로세스
- **Query**: 데이터베이스 쿼리 전담 프로세스

### 거래 관련

- **틱 (Tick)**: 체결될 때마다 발생하는 데이터
- **분봉 (Min)**: 1분 단위로 집계된 OHLCV 데이터
- **체결강도**: 매수 체결량 / 매도 체결량
- **VI (Volatility Interruption)**: 변동성완화장치 (주식)

### 백테스팅 관련

- **백테스트 (Backtest)**: 과거 데이터로 전략 성능 테스트
- **최적화 (Optimization)**: 파라미터 자동 조정
- **전진분석 (Walk-Forward)**: 시간 구간별로 나눠서 테스트
- **MDD (Max DrawDown)**: 최대 낙폭률
- **Sharpe Ratio**: 샤프 지수 (위험 대비 수익률)

### 전략 관련

- **매수조건 (Buy Condition)**: 진입 조건
- **매도조건 (Sell Condition)**: 청산 조건
- **지표 (Indicator)**: 기술적 분석 지표 (이동평균, RSI 등)
- **변수 (Variable)**: 전략 파라미터 (예: 이동평균 기간)

---

## 다음 단계

설치가 완료되었다면:

1. **[02-아키텍처-개요](./02-아키텍처-개요.md)**: STOM의 전체 구조 이해
2. **[03-주식거래-시스템](./03-주식거래-시스템.md)**: 주식 거래 시스템 상세
3. **[04-암호화폐-시스템](./04-암호화폐-시스템.md)**: 코인 거래 시스템 상세

---

## 문제 해결

### 설치 실패

**문제**: `pip install` 실패
- **해결**: 관리자 권한으로 실행
- **해결**: Python 버전 확인 (3.9 이상)

**문제**: TA-Lib 설치 실패
- **해결**: `utility/` 폴더의 프리컴파일 휠 사용
- **해결**: Visual Studio Build Tools 설치

### 실행 오류

**문제**: "관리자 권한 필요"
- **해결**: 배치 파일을 관리자 권한으로 실행

**문제**: "키움 OpenAPI를 찾을 수 없습니다"
- **해결**: `C:/OpenAPI/` 경로 확인
- **해결**: KOA Studio 재설치

**문제**: "데이터베이스 오류"
- **해결**: `utility/database_check.py` 실행
- **해결**: `_database/` 폴더 권한 확인

더 자세한 문제 해결은 **[12-문제해결-가이드](./12-문제해결-가이드.md)**를 참고하세요.

---

**다음:** [02-아키텍처-개요](./02-아키텍처-개요.md)
